{"version":3,"sources":["webpack:///src/components/apiConfig/apiChart.vue","webpack:///./src/components/apiConfig/apiChart.vue?d56a","webpack:///./src/components/apiConfig/apiChart.vue"],"names":["apiChart","emitter","pienodata","queryPanel","logRebuild","logTables","_ref","defineProperty_default","_this2","this","getCustomHeadData","resize","handleTime","getAllchart","isQuery","domainName","urlArr","isFalg","drawBusinessLine","getRequestNum","attackSum","drawUrlVisitCtBar","drawRegionSunburst","drawOrgIpLine","drawOrgIpPie","drawDomainLine","drawDomainPie","drawFingerPie","drawAutoToolPie","checkDomain","checkUrl","filterObj","starttime","endtime","sttime","edtime","dateTimeLong","Date","fromTime","endTime","value","access","businessDom","then","res2","j2","doc_count","dataJV2","key","b","push","valData2","timeinterval","valData","seriesData","getTime","adTstart","adTend","res","name","str","topArrays","labelOption","sdata","getOnepieceFromPie","isRegionPieOrg","ikeyname","ikeycount","latNum","lonNum","filterGeo","logDialogTitle","getRegionSunburstData","orgIpDom","isLineOrg","i","j","dataJV","legendData","xaxisData","lineTimerFn","isOrgIpPieOrg","sort","a","searchIp","result","getOrgIpPieData","domainDom","fingerPieLegendShow","series","legendRlt","seriesData1","seriesData2","xAxisData","requestFullscreen","replace","myCharArray","err","pageNum","must","item","pageSize","clientQueryObj","hits","logResArr","requeryObj","obj","n","d","apiConfig_apiChart","render","_vm","_h","$createElement","_c","_self","staticClass","directives","rawName","expression","attrs","isApi","on","getAllQuerychart","_v","gutter","span","staticStyle","padding-left","element-loading-spinner","element-loading-background","mystyle","_e","id","_s","$t","wholeCtMax","wholeCtMin","normalCtMax","normalCtMin","totalNum","attackSumNum","title","visible","logDialogVisible","width","before-close","logDialogClose","update:visible","$event","tableKeyArr","tableKeyArrApi","dynamicTag","chartLogsHeadData","refilterColBy","refilterColByAccess","requeryRowBy","requeryRowByAccess","chartLogsTotalNum","ref","tabheadData","tabodyData","chartLogsBodyData","isLogLoding","getChangeLogData","src","alt","click","fullScreen","downLoadPdf","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/34.22cc4c55fe26389a8254.js","sourcesContent":["<!--API状态-->\r\n<template>\r\n  <div class=\"apiChart-wrapper\">\r\n    <query-panel @getAllQuerychart=\"getAllchart\" :isApi=\"true\" v-show=\"isShowQueryPanel\"></query-panel><!-- 查询面板 -->\r\n    <div class=\"apiChartContent\">\r\n      <el-row :gutter=\"20\" class=\"chartRow chartRowBusi\">\r\n        <el-col :span=\"18\" class=\"busiChartBox\">\r\n          <el-col :span=\"20\" style=\"padding-left:0px\">\r\n            <div class=\"chart-content\"\r\n                v-loading=\"businessLineLoading\"\r\n                element-loading-spinner=\"el-icon-loading\"\r\n                element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n              <pienodata mystyle=\"linenodata\" v-if=\"businessNodata\"></pienodata>\r\n              <div id=\"businessContainer\"></div>\r\n            </div>\r\n          </el-col>\r\n          <el-col :span=\"4\" class=\"busiNumBox\">\r\n            <ul class=\"totalList\">\r\n              <li class=\"listTitle\">{{$t('lg.totalrequests')}}：</li>\r\n              <li>\r\n                <i class=\"liLable\">MAX:</i>\r\n                <p class=\"liValue\">{{wholeCtMax}}</p>\r\n              </li>\r\n              <li>\r\n                <i class=\"liLable\">MIN:</i>\r\n                <p class=\"liValue\">{{wholeCtMin}}</p>\r\n              </li>\r\n            </ul>\r\n            <ul class=\"someList\">\r\n              <li class=\"listTitle\">{{$t('lg.normalaccess')}}：</li>\r\n              <li>\r\n                <i class=\"liLable\">MAX:</i>\r\n                <p class=\"liValue\">{{normalCtMax}}</p>\r\n              </li>\r\n              <li>\r\n                <i class=\"liLable\">MIN:</i>\r\n                <p class=\"liValue\">{{normalCtMin}}</p>\r\n              </li>\r\n            </ul>\r\n          </el-col>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n          <div class=\"chart-content numBox txtOverflow\">\r\n            <!-- <p class=\"text-center numBoxTitle\"><span v-if=\"checkDomain\">-{{checkDomain}}</span> <span v-else>总数据量</span> <span v-if=\"checkUrl\">-{{checkUrl}}</span></p> -->\r\n            <p class=\"text-center numBoxTitle\">{{$t('lg.totaldatav')}}</p>\r\n            <div class=\"totalBox\">\r\n              <p class='numTitle'>{{$t('lg.totalrquestammount')}}</p>\r\n              <p class=\"totalNum\">{{totalNum}}<span class=\"uTxt\">次</span></p>\r\n            </div>\r\n            <div class=\"abnormalBox\">\r\n              <p class='numTitle'>{{$t('lg.totalnormalaccess')}}</p>\r\n              <p class=\"abnormalNum\">{{attackSumNum}}<span class=\"uTxt\">{{$t('lg.count')}}</span></p>\r\n            </div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      \r\n      <el-row :gutter=\"10\" class=\"chartRow\">\r\n        <el-col :span=\"14\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"urlVisitCtLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <pienodata mystyle=\"linenodata\" v-if=\"urlVisitCtBarNodata\"></pienodata>\r\n            <div id=\"urlVisitCtBarContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n\r\n        <el-col :span=\"10\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"regionSunburstLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"regionSunburstNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>{{$t('lg.nodata')}}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"regionSunburstContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row :gutter=\"10\" class=\"chartRow\">\r\n        <el-col :span=\"16\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"orgIpLineLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <pienodata  mystyle=\"linenodata\" v-if=\"orgIpLineNodata\"></pienodata>\r\n            <div id=\"orgIpLineContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"orgIpPieLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"orgIpPieNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>{{$t('lg.nodata')}}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"orgIpPieContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row :gutter=\"10\" class=\"chartRow\">\r\n        <el-col :span=\"16\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"domainLineLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <pienodata  mystyle=\"linenodata\" v-if=\"domainLineNodata\"></pienodata>\r\n            <div id=\"domainLineContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"domainPieLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"domainPieNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>{{$t('lg.nodata')}}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"domainPieContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row :gutter=\"10\" class=\"chartRow\">\r\n        <el-col :span=\"14\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"fingerPieLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle fingerPie-circle\" v-if=\"fingerPieNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>{{$t('lg.nodata')}}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"fingerPieContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"10\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"autoToolPieLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"autoToolPieNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>{{$t('lg.nodata')}}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"autoToolPieContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      \r\n      <!-- API响应时间/Top10 -->\r\n      <!-- <el-row :gutter=\"10\" class=\"chartRow\">\r\n        <el-col :span=\"14\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"apiRespTimeBarLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <pienodata mystyle=\"linenodata\" v-if=\"apiRespTimeBarNodata\"></pienodata>\r\n            <div id=\"apiRespTimeBarContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"10\">\r\n        </el-col>\r\n      </el-row> -->\r\n    </div>\r\n\r\n    <!-- 日志弹框 -->\r\n    <el-dialog :title=\"logDialogTitle\" :visible.sync=\"logDialogVisible\" width=\"80%\" :before-close=\"logDialogClose\">\r\n      <log-rebuild :tableKeyArr='tableKeyArrApi' :dynamicTag='chartLogsHeadData' @refilterColBy='refilterColByAccess' @requeryRowBy='requeryRowByAccess'></log-rebuild>\r\n      <div v-if=\"chartLogsTotalNum==0\" class=\"nodata-box\">{{$t('lg.nodata')}}</div>\r\n      <div v-if=\"chartLogsTotalNum>0\" class=\"logTableHeight\">\r\n        <log-tables ref=\"log_tables\" :tabheadData=\"chartLogsHeadData\" :tabodyData=\"chartLogsBodyData\" :totalNum=\"chartLogsTotalNum\" @getChangeLogData=\"getChangeLogData\" :isLogLoding=\"false\"></log-tables>\r\n      </div>\r\n    </el-dialog>\r\n   \r\n    <!-- <div :title=\"$t('lg.exportdatachart')\" class=\"downBtn\">\r\n      <a href=\"javascript:;\" @click=\"downLoadPdf\"><i class=\"fa fa-cloud-download font-green\"></i> {{$t('lg.exportchart')}}</a>\r\n    </div> -->\r\n\r\n    <!-- 右侧操作列表 -->\r\n    <ul class=\"operationBtnUl\"\r\n        v-show=\"isShowGridMenu\">\r\n      <li>\r\n        <img src=\"static/icon/fullScreen.png\"\r\n             alt=\"大屏展示\"\r\n             title=\"大屏展示\"\r\n             @click=\"fullScreen\">\r\n      </li>\r\n      \r\n      <li>\r\n        <img src=\"static/icon/downpdfChart.png\"\r\n             alt=\"导出pdf\"\r\n             title=\"导出pdf\"\r\n             @click=\"downLoadPdf\">\r\n      </li>\r\n    </ul>\r\n     \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport {SERVER_API_URL} from '@/conf/constvar';\r\nimport client from \"@/components/es/connection\";\r\nimport * as types from '@/store/types';\r\nimport pienodata from '@/basecomponents/pienodata';\r\nimport toISO8601 from '@/assets/js/iso8601';\r\nimport echarts from 'echarts';\r\nimport queryPanel from '@/components/home/queryPanel';\r\nimport {logskeys} from '@/assets/js/logskeys';\r\nimport logRebuild from \"@/components/logs/logRebuild\";\r\nimport logTables from '@/components/logs/logTables';\r\nimport Emitter from 'element-ui/src/mixins/emitter';\r\nimport {handleAccesslogData} from '@/assets/js/tool';\r\nexport default {\r\n  mixins: [Emitter],\r\n  components:{\r\n    pienodata,\r\n    queryPanel,\r\n    logRebuild,\r\n    logTables,\r\n  },\r\n  data(){\r\n    return{\r\n      fromTime:0,\r\n      endTime:0,\r\n      timeinterval:'',\r\n\r\n      //顶部查询面板\r\n      isFalg:false,\r\n      checkDomain:'',\r\n      checkUrl:'',\r\n      filterObj:{\"match_all\": {}},\r\n\r\n      //max min \r\n      wholeCtMax:0,\r\n      wholeCtMin:0,\r\n      normalCtMax:0,\r\n      normalCtMin:0,\r\n\r\n      businessLineLoading:false,\r\n      urlVisitCtLoading:false,\r\n      regionSunburstLoading:false,\r\n      orgIpLineLoading:false,\r\n      orgIpPieLoading:false,\r\n      domainLineLoading:false,\r\n      domainPieLoading:false,\r\n      fingerPieLoading:false,\r\n      autoToolPieLoading:false,\r\n      apiRespTimeBarLoading:false,\r\n\r\n      businessLineChart:null,\r\n      urlVisitCtBarChart:null,\r\n      regionSunburstChart:null,\r\n      orgIpLineChart:null,\r\n      orgIpPieChart:null,\r\n      domainLineChart:null,\r\n      domainPieChart:null,\r\n      fingerPieChart:null,\r\n      autoToolPieChart:null,\r\n      // apiRespTimeBarChart:null,//Api响应时间表，域名下api的响应时间,查询面板中至少要选择了域名才有数据\r\n      \r\n      businessNodata:false,\r\n      urlVisitCtBarNodata:false,\r\n      regionSunburstNodata:false,\r\n      orgIpLineNodata:false,\r\n      orgIpPieNodata:false,\r\n      domainLineNodata:false,\r\n      domainPieNodata:false,\r\n      fingerPieNodata:false,\r\n      autoToolPieNodata:false,\r\n      apiRespTimeBarNodata:false,\r\n      \r\n      totalNum:0,\r\n      attackSumNum:0,\r\n\r\n      isRegionPieOrg:false,\r\n      isLineOrg:false,\r\n      isOrgIpPieOrg:false,\r\n\r\n      fingerPieLegendShow:false,\r\n\r\n      //日志弹框参数\r\n      popQueryObj:{\"bool\":{\"must\":[]}},\r\n      logDialogVisible:false,\r\n      logDialogTitle:'',\r\n      tableKeyArrApi:[...logskeys.access],  //access.log总共（默认）显示的字段\r\n      chartLogsHeadData:[],//access.log用户自定义显示的字段\r\n      chartLogsBodyData:[],//传入logTables.vue子组件的表体数据\r\n      chartLogsTotalNum:0,\r\n      fromPage:0,\r\n      pageSize:10,\r\n      chartLogsTotalNum:0,\r\n      requeryObj:null,//日志弹框里面的requery子组件的查询条件\r\n      \r\n      // 地域信息切换源IP、代理IP\r\n      searchGeoip:'params._source.shadow.access.geoip',\r\n      searchGeoip2:'shadow.access.geoip',\r\n      mapScript:'geoip',\r\n\r\n      searchIp:'',\r\n\r\n      //大屏展示\r\n      isShowQueryPanel:true,//上方查询面板大屏展示时要隐藏\r\n      isShowGridMenu:true,//右下角菜单大屏展示时要隐藏\r\n    }\r\n  },\r\n  created(){\r\n    // this.$store.state.isShowTimerate = true;//采样频率选择\r\n    // this.$store.state.mydatedata.interval = '5m';\r\n    // this.$store.state.timerateValue='采样频率';\r\n    \r\n    this.getCustomHeadData();\r\n    // resize\r\n    window.addEventListener(\"resize\", () => {\r\n      this.businessLineChart.resize();\r\n      this.urlVisitCtBarChart.resize();\r\n      this.regionSunburstChart.resize();\r\n      this.orgIpLineChart.resize();\r\n      this.orgIpPieChart.resize();\r\n      this.domainLineChart.resize();\r\n      this.domainPieChart.resize();\r\n      this.fingerPieChart.resize();\r\n      this.autoToolPieChart.resize();\r\n      // this.apiRespTimeBarChart.resize();\r\n    });\r\n  },\r\n  watch:{\r\n    '$store.state.mydatedata.timestampnow':function(){\r\n      this.handleTime();\r\n      this.getAllchart();\r\n    },\r\n    '$store.state.isMenuShow':function(){\r\n      this.businessLineChart.resize();\r\n      this.urlVisitCtBarChart.resize();\r\n      this.regionSunburstChart.resize();\r\n      this.orgIpLineChart.resize();\r\n      this.orgIpPieChart.resize();\r\n      this.domainLineChart.resize();\r\n      this.domainPieChart.resize();\r\n      this.fingerPieChart.resize();\r\n      this.autoToolPieChart.resize();\r\n      // this.apiRespTimeBarChart.resize();\r\n    }\r\n  },\r\n  mounted(){\r\n    this.handleTime();\r\n    this.getAllchart();\r\n  },\r\n  methods:{\r\n    //创建即执行\r\n    getAllchart(querOobj){\r\n      if(querOobj){\r\n        this.isFalg=querOobj.isQuery;\r\n        this.checkDomain=querOobj.domainName;\r\n        this.checkUrl=querOobj.urlArr;\r\n\r\n        this.filterObj=this.getFilterObj(this.isFalg);\r\n      }\r\n      this.drawBusinessLine();\r\n      this.getRequestNum();\r\n      this.attackSum();\r\n      this.drawUrlVisitCtBar();\r\n      this.drawRegionSunburst();\r\n      this.drawOrgIpLine();\r\n      this.drawOrgIpPie();\r\n      this.drawDomainLine();\r\n      this.drawDomainPie();\r\n      this.drawFingerPie();\r\n      this.drawAutoToolPie();\r\n      // this.drawApiRespTimeBar();\r\n    },\r\n    getFilterObj(flag){//输入条件后手动查询，不输入查询条件则查询所有数据\r\n      var _this=this;\r\n      var filterObj ={\"match_all\": {}};\r\n      if(flag){\r\n        var domainVariable = _this.checkDomain;\r\n        var urlVariable = _this.checkUrl;\r\n        filterObj = {\r\n          \"bool\": {\r\n              \"must\":[\r\n                {\"query_string\": {\r\n                  \"query\": \"shadow.access.domain:\"+'\\\"'+domainVariable+'\\\"'\r\n                }}\r\n              ]\r\n            }\r\n          }\r\n          if(urlVariable){\r\n            var regxpUrl=/(\\/)+/g;\r\n            var regUrlVariable =urlVariable.replace(regxpUrl,'\\\\$1');\r\n            filterObj.bool.must.push({\"query_string\": {\r\n              \"query\": \"shadow.access.org_url:\"+'\\\"'+regUrlVariable+'\\\"'\r\n            }})\r\n          }\r\n      }else{\r\n        filterObj ={\"match_all\": {}};\r\n      }\r\n      return filterObj;\r\n    },\r\n    handleTime(){\r\n      var _this=this;\r\n      var sttime=_this.$store.state.mydatedata.starttime,\r\n          edtime=_this.$store.state.mydatedata.endtime;\r\n      var fromTime2=toISO8601(sttime),\r\n          endTime2=toISO8601(edtime);\r\n      var fromTime=fromTime2 || toISO8601(new Date(Date.now()-_this.$store.state.dateTimeLong)),\r\n          endTime=endTime2 || toISO8601(new Date()); \r\n      _this.fromTime=fromTime;\r\n      _this.endTime=endTime;\r\n      _this.timeinterval=_this.$store.state.mydatedata.interval || '5m';\r\n    },\r\n    getCustomHeadData(){ // 获取恶意访问日志弹框access.log表头（用户自定义的表头）\r\n      var url = SERVER_API_URL + '/pe/shadow/kv/apiChartAccess';\r\n      axios.get(url).then(res =>{\r\n        if(!res.data.data){\r\n          this.chartLogsHeadData = [...logskeys.access]\r\n        }else{\r\n          this.chartLogsHeadData = res.data.data.value;\r\n        }\r\n      })\r\n    },\r\n\r\n    //图表\r\n    drawBusinessLine(){\r\n      var _this=this;\r\n      _this.businessLineLoading=true;\r\n      var businessDom=document.getElementById('businessContainer');\r\n      _this.businessLineChart = echarts.init(businessDom);\r\n\r\n      _this.businessLineChart.off('brushSelected');//一定要清除brush事件\r\n      var brushFalg = false;//设置一个阀值，鼠标弹起时才触发\r\n      businessDom.addEventListener(\"mousedown\", () => {\r\n        brushFalg=false;\r\n      });\r\n      businessDom.addEventListener(\"mouseup\", () => {\r\n        brushFalg=true;\r\n      });\r\n      \r\n      var options = {\r\n            color:['#27727b','#7eb00a'],\r\n            title: {\r\n              text: _this.$t('lg.normalaccesstobuspro'),\r\n              x:'left',\r\n              textStyle: {\r\n                fontSize: '16',\r\n                fontWeight: 'normal'\r\n              }\r\n            },\r\n            tooltip : {\r\n              trigger: 'axis',\r\n              axisPointer: {\r\n                type: 'shadow',\r\n                label: {\r\n                  show: true\r\n                }\r\n              }\r\n            },\r\n            legend: {\r\n              top:'20px',\r\n              data:[_this.$t('lg.totalrequests'),_this.$t('lg.normalaccess')],\r\n              itemGap: 5\r\n            },\r\n            grid: {\r\n              left: '5%',\r\n              right: '4%',\r\n              bottom:'4%',\r\n              top:'20%',\r\n              containLabel: true\r\n            },\r\n            brush: {\r\n              toolbox: ['lineX'],\r\n              xAxisIndex: \"all\",\r\n              transformable:false,\r\n              throttleType:'debounce',\r\n              throttleDelay: 1000,\r\n              brushStyle:{\r\n                borderWidth: 0,\r\n              }\r\n            },\r\n            toolbox: {\r\n              right:'20',\r\n              top:'10',\r\n            },\r\n            xAxis: {\r\n              show:false,\r\n              data : []\r\n            },\r\n            yAxis: {\r\n              show:false,\r\n              name:_this.$t('lg.counts'),\r\n            },\r\n            series : []\r\n          };\r\n      function lineTimerFn(){\r\n        // lineTimer().then((nodes)=>{\r\n        //   var nodeArr=[];\r\n        //   for(var n=0;n<nodes.aggregations.langs.buckets.length;n++){\r\n        //     nodeArr.push(\r\n        //       nodes.aggregations.langs.buckets[n].key\r\n        //     )\r\n        //   }\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body:  {\r\n            \"size\":0,\r\n            \"query\": {\r\n            \"bool\": {\r\n              \"filter\": _this.filterObj,\r\n              \"must\": [{\r\n                \"term\": {\r\n                  \"log.file.path\": \"/usr/local/shadow/logs/access.log\"\r\n                }\r\n              },{\r\n              \"exists\": {\r\n                \"field\": \"shadow.access.method\"\r\n              }\r\n            },  {\r\n                \"range\": {\r\n                  \"@timestamp\": {\r\n                    \"from\": _this.fromTime,\r\n                    \"to\": _this.endTime,\r\n                    \"include_lower\": true,\r\n                    \"include_upper\": true\r\n                  }\r\n                }\r\n              }]\r\n            }\r\n          },\r\n          \"aggs\":{\"time_histo\":{\"date_histogram\":{\"field\":\"@timestamp\",\"interval\":_this.timeinterval,\"extended_bounds\":{\"min\":_this.fromTime,\"max\":_this.endTime}}}}\r\n          }\r\n        }).then((res2)=>{\r\n          var tarResult2=res2.aggregations?res2.aggregations.time_histo.buckets:[];\r\n          var valData2=[],xaxisData2=[];\r\n          var legendData=[],seriesData=[];\r\n\r\n          var wholeCtArr=[];//wholeCtNumSum=0,wholeCtTimesSum=0,wholeCtAvg=0\r\n          \r\n          for(var j2=0;j2<tarResult2.length;j2++){\r\n            var dataJ2=tarResult2[j2];\r\n            var dataJV2=dataJ2.doc_count;\r\n\r\n            if(dataJV2!=0){\r\n              wholeCtArr.push(dataJV2);\r\n              // wholeCtNumSum+=dataJV2;\r\n            }\r\n\r\n            if(!dataJV2){\r\n              dataJV2=0\r\n            }\r\n            valData2.push(dataJV2);\r\n            xaxisData2.push(_this.transformMyDate(dataJ2.key));\r\n          }\r\n\r\n          // wholeCtTimesSum=wholeCtArr.length;\r\n          // wholeCtAvg=(wholeCtNumSum/wholeCtTimesSum).toFixed(2) || 0;\r\n          wholeCtArr.sort(function(a,b){//最小值\r\n            return a-b;\r\n          });\r\n          _this.wholeCtMin=wholeCtArr[0]||0;\r\n          _this.wholeCtMax=wholeCtArr[wholeCtArr.length-1]||0;\r\n\r\n          seriesData.push(\r\n            {\r\n              name:_this.$t('lg.totalrequests'),\r\n              type:'bar',\r\n              data:valData2,\r\n              barMaxWidth: 10,\r\n              large: true,\r\n              // markLine: {} //平均数计算待讨论，先隐藏平均数显示\r\n            }\r\n          );\r\n\r\n          // if(_this.checkUrl){\r\n          //   seriesData[0].markLine={\r\n          //     silent: true,\r\n          //       data: [\r\n          //         {\r\n          //           yAxis: wholeCtAvg,\r\n          //           name: _this.$t('lg.avgvalue'),\r\n          //           label: {\r\n          //             normal: {\r\n          //               position: 'end',\r\n          //               formatter: wholeCtAvg\r\n          //             }\r\n          //           }\r\n          //         }\r\n          //       ]\r\n          //   }\r\n          // }else{\r\n          //   seriesData[0].markLine={}\r\n          // }\r\n\r\n          client.search({////////2\r\n            index: \"shadow-filebeat-*\",\r\n            body:  {\r\n              \"size\":0,\r\n              \"query\":{\r\n                \"bool\":{\r\n                  \"filter\": _this.filterObj,\r\n                  \"must\": [\r\n                    {\r\n                      \"query_string\": {\r\n                        \"query\": \"shadow.access.response_code:200\"\r\n                      }\r\n                    },\r\n                    {\r\n                      \"query_string\": {\r\n                        \"query\": \"shadow.access.error_code:0\"\r\n                      }\r\n                    },\r\n                    {\r\n                      \"query_string\": {\r\n                        \"query\": \"shadow.access.decrypted:1\"\r\n                      }\r\n                    },\r\n                    {\r\n                      \"range\": {\r\n                        \"@timestamp\": {\r\n                          \"gte\": _this.fromTime,\r\n                          \"lte\": _this.endTime\r\n                        }\r\n                      }\r\n                    }\r\n                  ]\r\n                }\r\n              },\r\n              \"aggs\":{\r\n                \"time_histo\":{\r\n                  \"date_histogram\":{\r\n                    \"field\":\"@timestamp\",\r\n                    \"interval\":_this.timeinterval,\r\n                    \"extended_bounds\":{\r\n                      \"min\":_this.fromTime,\r\n                      \"max\":_this.endTime\r\n                    }\r\n                }}}\r\n              }\r\n            }).then((res)=>{\r\n              // console.log(res);\r\n              var tarResult=res.aggregations?res.aggregations.time_histo.buckets:[];\r\n              var valData=[],normalCtArr=[];//normalCtNumSum=0,normalCtTimesSum=0,normalCtAvg=0\r\n\r\n              if(tarResult.length==0){\r\n                options.xAxis.show=false;\r\n                options.yAxis.show=false;\r\n                _this.businessNodata=true;\r\n              }else{\r\n                options.xAxis.show=true;\r\n                options.yAxis.show=true;\r\n                _this.businessNodata=false;\r\n              }\r\n\r\n              for(var j2=0;j2<tarResult.length;j2++){\r\n                var dataJ2=tarResult[j2];\r\n                var dataJV2=dataJ2.doc_count;\r\n\r\n                if(dataJV2!=0){\r\n                  normalCtArr.push(dataJV2);\r\n                  // normalCtNumSum+=dataJV2;\r\n                }\r\n\r\n                if(!dataJV2){\r\n                  dataJV2=0\r\n                }\r\n                valData.push(dataJV2);\r\n              }\r\n              \r\n              // normalCtTimesSum=normalCtArr.length;\r\n              // normalCtAvg=(normalCtNumSum/normalCtTimesSum).toFixed(2) ||0;\r\n              normalCtArr.sort(function(a,b){//最小值\r\n                return a-b;\r\n              });\r\n              _this.normalCtMin=normalCtArr[0]||0;\r\n              _this.normalCtMax=normalCtArr[normalCtArr.length-1]||0;\r\n\r\n              // console.log(normalCtTimesSum)\r\n              // console.log(normalCtNumSum)\r\n              // console.log(normalCtAvg)\r\n\r\n              seriesData.push(\r\n                {\r\n                  name:_this.$t('lg.normalaccess'),\r\n                  type:'bar',\r\n                  data:valData,\r\n                  large: true,\r\n                  barMaxWidth: 10,\r\n                  // markLine: {}\r\n                }\r\n              );\r\n\r\n              // if(_this.checkUrl){\r\n              //   seriesData[1].markLine={\r\n              //     silent: true,\r\n              //       data: [\r\n              //         {\r\n              //           yAxis: normalCtAvg,\r\n              //           name: _this.$t('lg.avgvalue'),\r\n              //           label: {\r\n              //             normal: {\r\n              //               position: 'end',\r\n              //               formatter: normalCtAvg\r\n              //             }\r\n              //           }\r\n              //         }\r\n              //       ]\r\n              //   }\r\n              // }else{\r\n              //   seriesData[1].markLine={}\r\n              // }\r\n\r\n              // options.legend.data=legendData;\r\n              options.xAxis.data=xaxisData2;//x轴\r\n              options.series=seriesData;\r\n              _this.businessLineChart.setOption(options,true);\r\n              _this.businessLineLoading=false;\r\n              \r\n              //brush 操作\r\n              _this.businessLineChart.on('brushSelected', function (params) {\r\n                // console.log(params)\r\n                if(brushFalg){\r\n                  if(params.batch && params.batch[0].areas[0]){\r\n                    // console.log(params.batch[0])\r\n                    var startIndex=params.batch[0].areas[0].coordRange[0]=='-0'||params.batch[0].areas[0].coordRange[0]<0?0:params.batch[0].areas[0].coordRange[0];\r\n                    var endIndex=params.batch[0].areas[0].coordRange[1];\r\n                    var tstart=xaxisData2[startIndex],tend=xaxisData2[endIndex]?xaxisData2[endIndex]:xaxisData2[endIndex-1];\r\n                    \r\n                    if(tstart==tend){ //采样频率稍大时（为'5m'时很容易出现这个问题）,如果用户选定的范围只在一个采样点内（只拉动一个阴影格），会导致起始查询时间和截止查询时间一致，这时在这个时间点上可能没有数据（但看起来应该有数据，采样频率导致的），因此遇到这种情况就把起始时间的范围以及截止时间的范围都各自扩大一个采样点，这样保证了用户只选取一个阴影格的时候也会有数据。\r\n                      // console.log(tstart,tend,'相等');\r\n                      var adTstart=new Date(tstart).getTime(),adTend=new Date(tend).getTime();\r\n                      if(_this.$store.state.mydatedata.interval=='5m'){//此时interval=='1d' 或者 '1h'的可能性很小，因此没写了\r\n                        adTstart-=5*60*1000;\r\n                        adTend+=5*60*1000;\r\n                      }else if(_this.$store.state.mydatedata.interval=='10s'){\r\n                        adTstart-=10*1000;\r\n                        adTend+=10*1000;\r\n                      }else if(_this.$store.state.mydatedata.interval=='1s'){ //interval=='1s' 采样频率精确到1s，在往下拉也会一直有数据，因此也没写了\r\n                        // adTstart-=1*1000\r\n                        // adTend+=1*1000\r\n                      }\r\n                      tstart = _this.transformMyDate(adTstart);\r\n                      tend = _this.transformMyDate(adTend);\r\n                    }\r\n                    // console.log(tstart,tend);\r\n\r\n                    _this.$store.state.nowTimeVal=[new Date(tstart),new Date(tend)];//这五行是右上角时间跟他对应上\r\n                    clearTimeout(_this.$store.state.refreshTimeout)//图表轮询定时器 清除按时刷新数据的定时器\r\n                    _this.$store.state.refreshAble=true;//禁用自动刷新\r\n                    setTimeout(()=>{\r\n                      _this.$store.commit(types.MYDATEPICKER);\r\n                    },0)\r\n                  }\r\n                }\r\n              });\r\n            });\r\n          });\r\n        // })\r\n      }\r\n      lineTimerFn();\r\n    },\r\n    getRequestNum(){//请求总量\r\n      var _this=this;\r\n      client.search({\r\n        index:\"shadow-filebeat-*\",\r\n        body:{\r\n          \"track_total_hits\": true, \r\n          \"sort\": {\r\n            \"@timestamp\": \"desc\"\r\n          },\r\n          \"query\": {\r\n            \"bool\": {\r\n              \"filter\": _this.filterObj,\r\n              \"must\": [{\r\n                \"term\": {\r\n                  \"log.file.path\": \"/usr/local/shadow/logs/access.log\"\r\n                }\r\n              }, {\r\n              \"exists\": {\r\n                \"field\": \"shadow.access.method\"\r\n              }\r\n            }, {\r\n                \"range\": {\r\n                  \"@timestamp\": {\r\n                    \"from\": _this.fromTime,\r\n                    \"to\": _this.endTime,\r\n                    \"include_lower\": true,\r\n                    \"include_upper\": true\r\n                  }\r\n                }\r\n              }]\r\n            }\r\n          }\r\n        }\r\n      }).then((res)=>{\r\n        _this.totalNum=res.hits.total.value;\r\n        // console.log(_this.fromTime,_this.endTime)\r\n      })\r\n    },\r\n    attackSum(){//正常访问总量\r\n      var _this=this;\r\n      client.search({\r\n        index:\"shadow-filebeat-*\",\r\n        body:{\r\n          \"size\": 0,\r\n          \"query\": {\r\n            \"bool\": {\r\n              \"filter\": _this.filterObj,\r\n              \"must\": [\r\n                {\r\n                  \"query_string\": {\r\n                    \"query\": \"shadow.access.response_code:200\"\r\n                  }\r\n                },\r\n                {\r\n                  \"query_string\": {\r\n                    \"query\": \"shadow.access.error_code:0\"\r\n                  }\r\n                },\r\n                {\r\n                  \"query_string\": {\r\n                    \"query\": \"shadow.access.decrypted:1\"\r\n                  }\r\n                },\r\n                {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      }).then((res)=>{\r\n        _this.attackSumNum=res.hits.total.value;\r\n      })\r\n    },\r\n    drawUrlVisitCtBar(){\r\n      var _this=this;\r\n      _this.urlVisitCtLoading=true;\r\n      _this.urlVisitCtBarChart = echarts.init(document.getElementById('urlVisitCtBarContainer'));\r\n    \r\n      //设置‘基于错误码统计的正常访问次数/Top10’图的显示文字\r\n      var labelOption = {\r\n          normal: {\r\n          show: true,\r\n          rotate: 0,\r\n          align: 'left',\r\n          verticalAlign: 'middle',\r\n          position: 'insideLeft',\r\n          distance: 10,\r\n          // color:'#000',\r\n          formatter:function(params){\r\n            // console.log(params)\r\n            const str = params.data.name;               \r\n            return str;\r\n          },\r\n          fontSize: 12,\r\n        }\r\n      };\r\n      var option = {\r\n          // color:['#d95850'],\r\n          color:['#4ea397'],\r\n          title: {\r\n            text: _this.$t('lg.urltop10'),\r\n            x:'center',\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip: {\r\n            show:true,\r\n            trigger: 'axis',\r\n            confine:true,\r\n            axisPointer: {\r\n              type: 'shadow'\r\n          },\r\n          // extraCssText:'white-space:pre-wrap',\r\n          extraCssText:'white-space:normal;word-break: break-all',\r\n          formatter: function (params, ticket, callback){\r\n            var str = '';\r\n            params.forEach(item=>{\r\n              str = item.data.name+'被正常访问的次数为:'+item.data.value+'次'\r\n            })\r\n            return str;\r\n          }\r\n        },\r\n        // legend: {\r\n        //   data: [],\r\n        //   top:'30px',\r\n        // },\r\n        grid: {\r\n          top:'12%',\r\n          left: '0',\r\n          right: '50',\r\n          bottom: '2%',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          show:false,\r\n          type: 'value',\r\n          name:_this.$t('lg.counts'),\r\n          boundaryGap: [0,0.01],\r\n          position:'top',\r\n          splitLine:{\r\n            show:false\r\n          },\r\n          minInterval: 1//保持x轴刻度只为整数\r\n        },\r\n        yAxis: { \r\n          show:false,\r\n          type: 'category',\r\n          data: [],\r\n          inverse: true,//是否是反向坐标轴 （这里反向后数据降序排列）\r\n        },\r\n        series: []\r\n      };\r\n\r\n      function getUrlVisitCtData(type){\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body: {\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": [\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.response_code:200\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.error_code:0\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.decrypted:1\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"range\": {\r\n                      \"@timestamp\": {\r\n                        \"gte\": _this.fromTime,\r\n                        \"lte\": _this.endTime\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"filterUrl\": {\r\n                \"terms\": {\r\n                  \"field\": \"shadow.access.org_url\",//shadow_url\r\n                  \"size\": 10\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }).then((res)=>{\r\n          // console.log(res);\r\n          var resResult=res.aggregations?res.aggregations.filterUrl.buckets:[];\r\n          // resResult=[\r\n          //   {key: \"/search.aspx\", doc_count: 10},\r\n          //   {key: \"/MkWZsG4-RgQLRlzZ3Dy8BxHhXAqPUdGh1QnNkB0ysA1DTv-4BTqUZXdmrkxEQ57Hia9m3-WfLSnW9xO-Sj-79DNu_SkE4N8QlLCHSwfy2INcvhsnS_DD4LlF4cdbdDCI3uC109XvVVfIDkgGTFFImFnXOUl8f7wDSVRzN_-5SWQ=CBWsK9LAXW4FIBgGop8vhMKAVibSrQqdH8sgsA_NXeNJHBXCfVKMkXy8Wn1JtUivejq-SOeRIVmdRbNY3gS5eq9p-b5OTyL6XofOC7IpEa0qdgPL_A9GYaGmMkz0_NWD75-i2irEKyv_qQR-50r_YzfuNKaCarPZt_rKmXlyPyehGFujkufmdPFkbMvqvK2M0zwgMzm6Mn0=/924220@\", doc_count: 3},\r\n          //   {key: \"/arch.aspx\", doc_count: 2},\r\n          //   {key: \"/rch.aspx\", doc_count: 5},\r\n          //   {key: \"/ch.aspx\", doc_count: 8},\r\n          // ]\r\n\r\n          let topArrays=[];              //存 ['top5','top4','top3','top2','top1']\r\n          let topArray=resResult.length;               //取前面10位  top10\r\n          for(var i=0;i<topArray;i++){   //遍历出top 数组\r\n            topArrays.push(`top${i+1}`);\r\n          } \r\n          // topArrays.reverse();//反序\r\n          option.yAxis.data=topArrays;\r\n\r\n          var sdata=[];\r\n          for(var i=0; i<topArrays.length;i++){\r\n            if(resResult[i]){\r\n              sdata.push({\r\n                value:resResult[i].doc_count,\r\n                name:resResult[i].key,\r\n              });\r\n            }else{\r\n              sdata.push({\r\n                name:\"-\",\r\n                value:\"-\"\r\n              });\r\n            }\r\n          }\r\n          // sdata.sort(function(a,b){return b.value-a.value});\r\n          // sdata.reverse();//反序\r\n          option.series=[{          \r\n            type: 'bar',\r\n            label: labelOption,\r\n            data:sdata,\r\n            barMaxWidth:30,\r\n          }]\r\n          // console.log(option.series)\r\n          if(resResult.length==0){\r\n            option.xAxis.show=false;\r\n            option.yAxis.show=false;\r\n            option.tooltip.show=false;\r\n            _this.urlVisitCtBarNodata=true;\r\n          }else{\r\n            option.xAxis.show=true;\r\n            option.yAxis.show=true;\r\n            option.tooltip.show=true;\r\n            _this.urlVisitCtBarNodata=false;\r\n          }\r\n          _this.urlVisitCtBarChart.setOption(option,true);\r\n          _this.urlVisitCtLoading=false;\r\n        });\r\n\r\n        _this.urlVisitCtBarChart.off(\"click\");\r\n        _this.urlVisitCtBarChart.on(\"click\",(params)=>{\r\n          // console.log(params)\r\n          _this.logDialogVisible=true;\r\n          _this.logDialogTitle=params.name;\r\n          _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n          _this.popQueryObj.bool.must.push({\r\n            \"query_string\": {\r\n              \"query\":\"shadow.access.response_code:200\"\r\n            }\r\n          });\r\n          _this.popQueryObj.bool.must.push({\r\n            \"query_string\": {\r\n              \"query\": \"shadow.access.error_code:0\"\r\n            }\r\n          });\r\n          _this.popQueryObj.bool.must.push({\r\n            \"query_string\": {\r\n              \"query\": \"shadow.access.decrypted:1\"\r\n            }\r\n          });\r\n          _this.popQueryObj.bool.must.push({\r\n            \"query_string\": {\r\n              \"query\":\"shadow.access.org_url:\"+_this.logDialogTitle.replace(/\\//g,'\\\\/')\r\n            } \r\n          });\r\n          // console.log(_this.popQueryObj)\r\n          _this.getOnepieceFromPie();\r\n        });\r\n      }\r\n      getUrlVisitCtData();\r\n    },\r\n    drawRegionSunburst(){//地域信息\r\n      var _this=this;\r\n      _this.regionSunburstLoading=true;\r\n      _this.regionSunburstChart = echarts.init(document.getElementById('regionSunburstContainer'));\r\n      var options = {\r\n          color:['#3fb1e3','#6be6c1','#626c91','#a0a7e6','#91ca8c','#96dee8','#4ea397','#22c3aa','#97b552','#9a7fd1'],\r\n          title: {\r\n            text: _this.$t('lg.geographicinfosourceip'),\r\n            x:'center',\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip: {\r\n            trigger: 'item',\r\n            formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n          },\r\n          toolbox: {\r\n            right:'10',\r\n            top:'10',\r\n            feature: {\r\n              myTool1: {\r\n                show: true,\r\n                title: _this.$t('lg.agentip'),\r\n                icon: 'image://static/icon/switch.png',\r\n                onclick: function (){\r\n                  getRegionSunburstData(_this.isRegionPieOrg)\r\n                }\r\n              }\r\n            }\r\n          },\r\n          series: {\r\n            type:'pie',\r\n            radius:['25%','35%'],\r\n            data: [].sort(function (a, b) { return a.value - b.value; }),\r\n            label: {\r\n              position:'outside',\r\n              normal: {\r\n                textStyle: {\r\n                  fontSize: '12',  \r\n                },\r\n                formatter: \"{b}: {c}\"\r\n              },\r\n              emphasis: {\r\n                show: true,\r\n                textStyle: {\r\n                  fontSize: '14',\r\n                  fontWeight: 'normal'\r\n                }\r\n              }\r\n            },\r\n            labelLine: {\r\n              normal: {\r\n                smooth: 0,\r\n                length: 10,\r\n                length2: 20,\r\n              },\r\n            },\r\n            animationType: 'scale',\r\n            animationEasing: 'elasticOut',\r\n            animationDelay: function (idx) {\r\n              return Math.random() * 200;\r\n            }\r\n          }\r\n        };\r\n\r\n      function getRegionSunburstData(type){\r\n        if(type){\r\n          _this.isRegionPieOrg=false;\r\n          _this.searchGeoip=\"params._source.shadow.access.org_geoip\";\r\n          _this.mapScript='org_geoip';\r\n          options.title.text=_this.$t('lg.geographicinfoproxyip');\r\n          options.toolbox.feature.myTool1.title=_this.$t('lg.sourceip');\r\n        }else{\r\n          _this.isRegionPieOrg=true;\r\n          _this.searchGeoip=\"params._source.shadow.access.geoip\";\r\n          _this.mapScript='geoip';\r\n          options.title.text=_this.$t('lg.geographicinfosourceip');\r\n          options.toolbox.feature.myTool1.title=_this.$t('lg.agentip');\r\n        }\r\n        client.search({\r\n           index: \"shadow-filebeat-*\",\r\n           body:{\r\n             \"track_total_hits\": true, \r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": [{\r\n                  \"query_string\": {\r\n                    \"query\": \"shadow.access.response_code:200\"\r\n                  }\r\n                }, {\r\n                  \"query_string\": {\r\n                    \"query\": \"shadow.access.error_code:0\"\r\n                  }\r\n                },{\r\n                  \"query_string\": {\r\n                    \"query\": \"shadow.access.decrypted:1\"\r\n                  }\r\n                }, {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n                \"GroupByGeo\": {\r\n                  \"terms\": {\r\n                    \"script\": {\r\n                      \"lang\": \"painless\",\r\n                    //\"source\": \"params._source.shadow.access.geoip.city_name+';'+params._source.shadow.access.geoip.location.lon+', '+params._source.shadow.access.geoip.location.lat\"\r\n                      \"source\": _this.searchGeoip+\".city_name+';'+\"+_this.searchGeoip+\".location.lon+', '+\"+_this.searchGeoip+\".location.lat\"\r\n                    }, \r\n                    \"field\": _this.searchGeoip2+\".city_name\",\r\n                    \"size\": 10\r\n                  }//,\r\n                  // \"aggs\": {\r\n                  //   \"GroupByIp\": {\r\n                  //     \"terms\": {\r\n                  //       \"field\": _this.searchIp,\r\n                  //       \"size\": 10\r\n                  //     }\r\n                  //   }\r\n                  // }\r\n                }\r\n              }\r\n          }\r\n\r\n        }).then((res)=>{\r\n          var buckets=res.aggregations?res.aggregations.GroupByGeo.buckets:[];\r\n          var seriesData=[];\r\n          buckets.forEach(element=>{//过滤掉没返回city_name的数据\r\n              var ikeynamearr=element.key.split(\";\");\r\n              var ikeyname=ikeynamearr[0];\r\n              var ikey=ikeynamearr[1].split(\",\").map(keyitem=>{return parseInt(keyitem,10)});\r\n              var ikeycount=element.doc_count;\r\n             // var ikey=element.key.match(/-*\\d+(\\.\\d+)*/g).map(keyitem=>{return parseInt(keyitem,10)});\r\n              seriesData.push({\r\n               // \"name\":JSON.stringify(ikey),\r\n                \"name\":ikeyname,\r\n                \"value\":ikeycount\r\n              });\r\n             \r\n            });\r\n          if(seriesData.length==0){\r\n            _this.regionSunburstNodata=true;\r\n          }else{\r\n            _this.regionSunburstNodata=false;\r\n          }\r\n\r\n          options.series.data=seriesData;\r\n          _this.regionSunburstChart.setOption(options,true);\r\n          _this.regionSunburstLoading=false;\r\n\r\n          _this.regionSunburstChart.off(\"click\");\r\n          _this.regionSunburstChart.on(\"click\",(params)=>{\r\n            // console.log(params);\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                      \"query\":\"shadow.access.error_code:0\"  \r\n                    }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                      \"query\":\"shadow.access.response_code:200\"\r\n                    }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                      \"query\": \"shadow.access.decrypted:1\"\r\n                    }\r\n            });\r\n\r\n            // console.log(_this.logDialogTitle)\r\n            if(/^\\[.+\\]$/.test(params.name)){//没有city_name 就用经纬度查\r\n              var locationArr = JSON.parse(params.name)\r\n              var lonNum = locationArr[0],latNum = locationArr[1];\r\n              var mapScriptStr = \"shadow.access.\"+_this.mapScript+\".location\";\r\n\r\n              var filterGeo ={};\r\n              filterGeo.distance=\"1mm\";\r\n              filterGeo[mapScriptStr]={\r\n                \"lat\" : latNum,\r\n                \"lon\" : lonNum\r\n              }\r\n\r\n              if(!_this.popQueryObj.bool.filter.bool){//如果没有查询面板的过滤条件\r\n                _this.popQueryObj.bool.filter={\"bool\":{\"must\":[]}}\r\n                _this.popQueryObj.bool.filter.bool.must.push({\r\n                  \"geo_distance\" : filterGeo\r\n                });\r\n              }else{\r\n                _this.popQueryObj.bool.filter.bool.must.push({\r\n                  \"geo_distance\" : filterGeo\r\n                });\r\n              }\r\n            }else{\r\n              _this.popQueryObj.bool.must.push({//有city_name 就用city_name查\r\n              \"query_string\": {\r\n                  \"query\":\"shadow.access.\"+_this.mapScript+\".city_name:\"+_this.logDialogTitle\r\n                }\r\n              });\r\n            }\r\n            _this.getOnepieceFromPie();\r\n          })\r\n\r\n        });\r\n      }\r\n      getRegionSunburstData();\r\n\r\n    },\r\n    drawOrgIpLine(){\r\n      var _this=this;\r\n      _this.orgIpLineLoading=true;\r\n      var orgIpDom=document.getElementById('orgIpLineContainer');\r\n      _this.orgIpLineChart = echarts.init(orgIpDom);\r\n\r\n      _this.orgIpLineChart.off('brushSelected');//一定要清除brush事件\r\n      var brushFalg = false;//设置一个阀值，鼠标弹起时才触发\r\n      orgIpDom.addEventListener(\"mousedown\", () => {\r\n        brushFalg=false;\r\n      });\r\n      orgIpDom.addEventListener(\"mouseup\", () => {\r\n        brushFalg=true;\r\n      });\r\n\r\n      var options = {\r\n          color:['#4ea397','#22c3aa','#7bd9a5','#d0648a','#f58db2'],\r\n          title: {\r\n            text: _this.$t('lg.numaccesstop5'),\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip: {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n              type: 'shadow',\r\n              label: {\r\n                show: true\r\n              }\r\n            }\r\n          },\r\n          legend: {\r\n            top:'20px',\r\n            data:[],\r\n          },\r\n          grid: {\r\n            left: '5%',\r\n            right: '3%',\r\n            bottom:'4%',\r\n            top:'25%',\r\n            containLabel: true\r\n          },\r\n          brush: {\r\n            toolbox: ['switchOrg'],\r\n            xAxisIndex: \"all\",\r\n            transformable:false,\r\n            throttleType:'debounce',\r\n            throttleDelay: 1000,\r\n            brushStyle:{\r\n              borderWidth: 0,\r\n            }\r\n          },\r\n          toolbox: {\r\n            right:'10',\r\n            top:'10',\r\n            feature: {\r\n              myTool1: {\r\n                name:'switchOrg',\r\n                show: true,\r\n                title: _this.$t('lg.agentip'),\r\n                icon: 'image://static/icon/switch.png',\r\n                onclick: function (){\r\n                  lineTimerFn(_this.isLineOrg)\r\n                }\r\n              }\r\n            }\r\n          },\r\n          xAxis: {\r\n            show:false,\r\n            type: 'category',\r\n            //data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\r\n            data: [],\r\n          },\r\n          yAxis: {\r\n            show:false,\r\n            type: 'value',\r\n            name:_this.$t('lg.counts'),\r\n            minInterval: 1//保持y轴刻度只为整数\r\n          },\r\n          series: [\r\n            // {\r\n            //     name:'Step Start',\r\n            //     type:'line',\r\n            //     step: 'start',\r\n            //     data:[120, 132, 101, 134, 90, 230, 210]\r\n            // },\r\n            // {\r\n            //     name:'Step Middle',\r\n            //     type:'line',\r\n            //     step: 'middle',\r\n            //     data:[220, 282, 201, 234, 290, 430, 410]\r\n            // },\r\n          ]\r\n        };\r\n\r\n      function lineTimerFn(type){\r\n        let searchIp = '';\r\n        if(type){\r\n          _this.isLineOrg=false;\r\n          searchIp=\"shadow.access.org_remote_ip\";\r\n          options.title.text=_this.$t('lg.numaccessproxytop5');\r\n          options.toolbox.feature.myTool1.title=_this.$t('lg.sourceip');\r\n        }else{\r\n          _this.isLineOrg=true;\r\n          searchIp=\"shadow.access.remote_ip\";\r\n          options.title.text=_this.$t('lg.numaccesstop5');\r\n          options.toolbox.feature.myTool1.title=_this.$t('lg.agentip');\r\n        }\r\n        // lineTimer().then((nodes)=>{\r\n        //   var nodeArr=[];\r\n        //   for(var n=0;n<nodes.aggregations.langs.buckets.length;n++){\r\n        //     nodeArr.push(\r\n        //       nodes.aggregations.langs.buckets[n].key\r\n        //     )\r\n        //   }\r\n          client.search({\r\n            index: \"shadow-filebeat-*\",\r\n            body: {\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": [\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.response_code:200\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.error_code:0\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.decrypted:1\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"range\": {\r\n                      \"@timestamp\": {\r\n                        \"gte\": _this.fromTime,\r\n                        \"lte\": _this.endTime\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"ip\": {\r\n                \"terms\": {\r\n                  \"field\": searchIp,//shadow.access.org_remote_ip\r\n                  \"size\": 5\r\n                },\r\n                \"aggs\": {\r\n                  \"time_histo\": {                  \r\n                    \"date_histogram\": {\r\n                      \"field\": \"@timestamp\",\r\n                      \"interval\": _this.timeinterval,\r\n                      \"extended_bounds\": {\r\n                        \"min\": _this.fromTime,\r\n                        \"max\": _this.endTime\r\n                      }\r\n                    }\r\n                  }        \r\n                }\r\n              }\r\n            }\r\n          }\r\n          }).then((res)=>{\r\n            // console.log(res)\r\n            var tarResult=res.aggregations?res.aggregations.ip.buckets:[];\r\n            var legendData=[],seriesData=[];\r\n            if(tarResult.length==0){\r\n              options.xAxis.show=false;\r\n              options.yAxis.show=false;\r\n              options.brush.toolbox=['switchOrg'];\r\n              _this.orgIpLineNodata=true;\r\n            }else{\r\n              options.xAxis.show=true;\r\n              options.yAxis.show=true;\r\n              options.brush.toolbox=['lineX','switchOrg'];\r\n              _this.orgIpLineNodata=false;\r\n            }\r\n            for(var i=0;i<tarResult.length;i++){\r\n              var xaxisData=[],valData=[];\r\n              var dataI=tarResult[i];\r\n              legendData.push(dataI.key);\r\n              for(var j=0;j<dataI.time_histo.buckets.length;j++){\r\n                var dataJ=dataI.time_histo.buckets[j];\r\n                var dataJV=dataJ.doc_count;\r\n                if(!dataJV){\r\n                  dataJV=0\r\n                }\r\n                xaxisData.push(_this.transformMyDate(dataJ.key));\r\n                valData.push(dataJV);\r\n              }\r\n              seriesData.push(\r\n                {\r\n                  name:dataI.key,\r\n                  type:'line',\r\n                  data:valData\r\n                }\r\n              );\r\n            }\r\n            options.legend.data=legendData;\r\n            options.xAxis.data=xaxisData;\r\n            options.series=seriesData;\r\n            _this.orgIpLineChart.setOption(options,true);\r\n            _this.orgIpLineLoading=false;\r\n\r\n            //brush 操作\r\n            _this.orgIpLineChart.on('brushSelected', function (params) {\r\n              // console.log(params)\r\n              if(brushFalg){\r\n                if(params.batch && params.batch[0].areas[0]){\r\n                  // console.log(params.batch[0])\r\n                  var startIndex=params.batch[0].areas[0].coordRange[0]=='-0'||params.batch[0].areas[0].coordRange[0]<0?0:params.batch[0].areas[0].coordRange[0];\r\n                  var endIndex=params.batch[0].areas[0].coordRange[1];\r\n                  var tstart=xaxisData[startIndex],tend=xaxisData[endIndex]?xaxisData[endIndex]:xaxisData[endIndex-1];\r\n\r\n                  if(tstart==tend){ //采样频率稍大时（为'5m'时很容易出现这个问题）,如果用户选定的范围只在一个采样点内（只拉动一个阴影格），会导致起始查询时间和截止查询时间一致，这时在这个时间点上可能没有数据（但看起来应该有数据，采样频率导致的），因此遇到这种情况就把起始时间的范围以及截止时间的范围都各自扩大一个采样点，这样保证了用户只选取一个阴影格的时候也会有数据。\r\n                    // console.log(tstart,tend,'相等');\r\n                    var adTstart=new Date(tstart).getTime(),adTend=new Date(tend).getTime();\r\n                    if(_this.$store.state.mydatedata.interval=='5m'){//此时interval=='1d' 或者 '1h'的可能性很小，因此没写了\r\n                      adTstart-=5*60*1000;\r\n                      adTend+=5*60*1000;\r\n                    }else if(_this.$store.state.mydatedata.interval=='10s'){\r\n                      adTstart-=10*1000;\r\n                      adTend+=10*1000;\r\n                    }else if(_this.$store.state.mydatedata.interval=='1s'){ //interval=='1s' 采样频率精确到1s，在往下拉也会一直有数据，因此也没写了\r\n                      // adTstart-=1*1000\r\n                      // adTend+=1*1000\r\n                    }\r\n                    tstart = _this.transformMyDate(adTstart);\r\n                    tend = _this.transformMyDate(adTend);\r\n                  }\r\n                  // console.log(tstart,tend);\r\n\r\n                  _this.$store.state.nowTimeVal=[new Date(tstart),new Date(tend)];//改变右上角时间（跟拉到的时间保持一致）\r\n                  clearTimeout(_this.$store.state.refreshTimeout)//图表轮询定时器 清除按时刷新数据的定时器\r\n                  _this.$store.state.refreshAble=true;//禁用自动刷新\r\n                  setTimeout(()=>{\r\n                    _this.$store.commit(types.MYDATEPICKER);\r\n                  },0)\r\n                }\r\n              }\r\n            });\r\n          });\r\n        // })\r\n      }\r\n      lineTimerFn();\r\n    },\r\n    drawOrgIpPie(){\r\n      var _this=this;\r\n      _this.orgIpPieLoading=true;\r\n      _this.orgIpPieChart = echarts.init(document.getElementById('orgIpPieContainer'));\r\n      var options={\r\n          color:['#2ec7c9','#b6a2de','#5ab1ef','#ffb980','#d87a80','#8d98b3','#e5cf0d','#97b552','#95706d','#f58db2'],\r\n          title : {\r\n            text:_this.$t('lg.numaccessiptop10'),\r\n            x:'center',\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip: {\r\n            trigger: 'item',\r\n            formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n          },\r\n          toolbox: {\r\n            right:'10',\r\n            top:'10',\r\n            feature: {\r\n              myTool1: {\r\n                show: true,\r\n                title: _this.$t('lg.agentip'),\r\n                icon: 'image://static/icon/switch.png',\r\n                onclick: function (){\r\n                  getOrgIpPieData(_this.isOrgIpPieOrg)\r\n                  // console.log(_this.isOrgIpPieOrg)\r\n                }\r\n              }\r\n            }\r\n          },\r\n          series: [\r\n            {\r\n              name:_this.$t('lg.accesssource')+':',\r\n              type:'pie',\r\n              radius:['25%','35%'],\r\n              // radius: '40%',\r\n              // center: ['50%', '50%'],\r\n              data:[\r\n                // {value:335, name:'直接访问'},\r\n                // {value:310, name:'邮件营销'},\r\n              ].sort(function (a, b) { return a.value - b.value; }),\r\n              // roseType: 'radius',//area radius\r\n              label: {\r\n                position:'outside',\r\n                normal: {\r\n                  textStyle: {\r\n                    fontSize: '12',  \r\n                  },\r\n                  formatter: \"{b}: {c}\"\r\n                },\r\n                emphasis: {\r\n                  show: true,\r\n                  textStyle: {\r\n                    fontSize: '14',\r\n                    fontWeight: 'normal',\r\n                  },\r\n                }\r\n              },\r\n              labelLine: {\r\n                normal: {\r\n                  smooth: 0,\r\n                  length: 10,\r\n                  length2: 20,\r\n                },\r\n              },\r\n              animationType: 'scale',\r\n              animationEasing: 'elasticOut',\r\n              animationDelay: function (idx) {\r\n                return Math.random() * 200;\r\n              }\r\n            }\r\n          ],\r\n        };\r\n      function getOrgIpPieData(type){// 绘制图表\r\n       // let searchIp = '';\r\n        if(type){\r\n          _this.isOrgIpPieOrg=false;\r\n          _this.searchIp=\"shadow.access.org_remote_ip\";\r\n          options.title.text=_this.$t('lg.numaccessproxytop10');\r\n          options.toolbox.feature.myTool1.title=_this.$t('lg.sourceip');\r\n        }else{\r\n          _this.isOrgIpPieOrg=true;\r\n          _this.searchIp=\"shadow.access.remote_ip\";\r\n          options.title.text=_this.$t('lg.numaccessiptop10');\r\n          options.toolbox.feature.myTool1.title=_this.$t('lg.agentip');\r\n        }\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body: {\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": [\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.response_code:200\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.error_code:0\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.decrypted:1\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"range\": {\r\n                      \"@timestamp\": {\r\n                        \"gte\": _this.fromTime,\r\n                        \"lte\": _this.endTime\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"ip\": {\r\n                \"terms\": {\r\n                  \"field\": _this.searchIp,\r\n                  \"size\": 10\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }).then((res)=>{\r\n          // console.log(res);\r\n          var tarResult=res.aggregations?res.aggregations.ip.buckets:[];\r\n          var result=[],legendRlt=[];\r\n          for(var i=0;i<tarResult.length;i++){\r\n            var dataI=tarResult[i];\r\n            result.push(\r\n              {\r\n                value:dataI[\"doc_count\"],\r\n                name:dataI[\"key\"]\r\n              }\r\n            );\r\n            legendRlt.push(dataI[\"key\"])\r\n          }\r\n          options.series[0].data=result;\r\n          // options.legend.data=legendRlt;\r\n          if(result.length==0){\r\n            _this.orgIpPieNodata=true;\r\n          }else{\r\n            _this.orgIpPieNodata=false;\r\n          }\r\n          _this.orgIpPieChart.setOption(options,true);\r\n          _this.orgIpPieLoading=false;\r\n\r\n          _this.orgIpPieChart.off(\"click\");\r\n          _this.orgIpPieChart.on(\"click\",(params)=>{\r\n            // console.log(params);\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            //{\"bool\":{\"must\":[{\"bool\":{\"should\": []}}]}}\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                \"query\":\"shadow.access.error_code:0\"\r\n              }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                \"query\":\"shadow.access.response_code:200\"\r\n              }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.decrypted:1\"\r\n              }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                \"query\": _this.searchIp+\":\"+'\\\"'+_this.logDialogTitle+'\\\"'\r\n              }\r\n            });\r\n            _this.getOnepieceFromPie();\r\n          })\r\n        });\r\n      }\r\n      getOrgIpPieData(); \r\n    },\r\n    drawDomainLine(){\r\n      var _this=this;\r\n      _this.domainLineLoading=true;\r\n      var domainDom=document.getElementById('domainLineContainer');\r\n      _this.domainLineChart = echarts.init(domainDom);\r\n\r\n      _this.domainLineChart.off('brushSelected');//一定要清除brush事件\r\n      var brushFalg = false;//设置一个阀值，鼠标弹起时才触发\r\n      domainDom.addEventListener(\"mousedown\", () => {\r\n        brushFalg=false;\r\n      });\r\n      domainDom.addEventListener(\"mouseup\", () => {\r\n        brushFalg=true;\r\n      });\r\n\r\n      var options = {\r\n          color:['#b6a2de','#60c0dd','#e87c25','#9bca63','#3fb1e3'],\r\n          title: {\r\n            text: _this.$t('lg.normalaccdomaintop5'),\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip: {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n              type: 'shadow',\r\n              label: {\r\n                show: true\r\n              }\r\n            }\r\n          },\r\n          legend: {\r\n            top:'20px',\r\n            data:[],\r\n          },\r\n          grid: {\r\n            left: '5%',\r\n            right: '3%',\r\n            bottom:'4%',\r\n            top:'25%',\r\n            containLabel: true\r\n          },\r\n          brush: {\r\n            toolbox: ['lineX'],\r\n            xAxisIndex: \"all\",\r\n            transformable:false,\r\n            throttleType:'debounce',\r\n            throttleDelay: 1000,\r\n            brushStyle:{\r\n              borderWidth: 0,\r\n            }\r\n          },\r\n          toolbox: {\r\n            show:false,\r\n            right:'10',\r\n            top:'10',\r\n          },\r\n          xAxis: {\r\n            show:false,\r\n            type: 'category',\r\n            data: [],\r\n          },\r\n          yAxis: {\r\n            show:false,\r\n            type: 'value',\r\n            name:_this.$t('lg.counts'),\r\n            minInterval: 1//保持y轴刻度只为整数\r\n          },\r\n          series: [\r\n            // {\r\n            //     name:'Step Start',\r\n            //     type:'line',\r\n            //     step: 'start',\r\n            //     data:[120, 132, 101, 134, 90, 230, 210]\r\n            // },\r\n            // {\r\n            //     name:'Step Middle',\r\n            //     type:'line',\r\n            //     step: 'middle',\r\n            //     data:[220, 282, 201, 234, 290, 430, 410]\r\n            // },\r\n          ]\r\n        };\r\n      function lineTimerFn(){\r\n        // lineTimer().then((nodes)=>{\r\n        //   var nodeArr=[];\r\n        //   for(var n=0;n<nodes.aggregations.langs.buckets.length;n++){\r\n        //     nodeArr.push(\r\n        //       nodes.aggregations.langs.buckets[n].key\r\n        //     )\r\n        //   }\r\n          client.search({\r\n            index: \"shadow-filebeat-*\",\r\n            body:  {\r\n              \"size\": 0,\r\n              \"query\": {\r\n                \"bool\": {\r\n                  \"filter\": _this.filterObj,\r\n                  \"must\": [\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.response_code:200\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.error_code:0\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.decrypted:1\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"range\": {\r\n                      \"@timestamp\": {\r\n                        \"gte\": _this.fromTime,\r\n                        \"lte\": _this.endTime\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n                }\r\n              },\r\n              \"aggs\": {\r\n                \"host\": {\r\n                  \"terms\": {\r\n                    \"field\": \"shadow.access.http_host\",\r\n                    \"size\": 5\r\n                  },\r\n                  \"aggs\": {\r\n                    \"time_histo\": {                  \r\n                      \"date_histogram\": {\r\n                        \"field\": \"@timestamp\",\r\n                        \"interval\": _this.timeinterval,\r\n                        \"extended_bounds\": {\r\n                          \"min\": _this.fromTime,\r\n                          \"max\": _this.endTime\r\n                        }\r\n                      }\r\n                    }        \r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }).then((res)=>{\r\n            // console.log(res)\r\n            var tarResult=res.aggregations?res.aggregations.host.buckets:[];\r\n            var legendData=[],seriesData=[];\r\n            if(tarResult.length==0){\r\n              options.xAxis.show=false;\r\n              options.yAxis.show=false;\r\n              options.toolbox.show=false;\r\n              _this.domainLineNodata=true;\r\n            }else{\r\n              options.xAxis.show=true;\r\n              options.yAxis.show=true;\r\n              options.toolbox.show=true;\r\n              _this.domainLineNodata=false;\r\n            }\r\n            for(var i=0;i<tarResult.length;i++){\r\n              var xaxisData=[],valData=[];\r\n              var dataI=tarResult[i];\r\n              legendData.push(dataI.key);\r\n              for(var j=0;j<dataI.time_histo.buckets.length;j++){\r\n                var dataJ=dataI.time_histo.buckets[j];\r\n                var dataJV=dataJ.doc_count;\r\n                if(!dataJV){\r\n                  dataJV=0\r\n                }\r\n                xaxisData.push(_this.transformMyDate(dataJ.key));\r\n                valData.push(dataJV);\r\n              }\r\n              seriesData.push(\r\n                {\r\n                  name:dataI.key,\r\n                  type:'line',\r\n                  data:valData\r\n                }\r\n              );\r\n            }\r\n            options.legend.data=legendData;\r\n            options.xAxis.data=xaxisData;\r\n            options.series=seriesData;\r\n            _this.domainLineChart.setOption(options,true);\r\n            _this.domainLineLoading=false;\r\n\r\n            //brush 操作\r\n            _this.domainLineChart.on('brushSelected', function (params) {\r\n              // console.log(params)\r\n              if(brushFalg){\r\n                if(params.batch && params.batch[0].areas[0]){\r\n                  // console.log(params.batch[0])\r\n                  var startIndex=params.batch[0].areas[0].coordRange[0]=='-0'||params.batch[0].areas[0].coordRange[0]<0?0:params.batch[0].areas[0].coordRange[0];\r\n                  var endIndex=params.batch[0].areas[0].coordRange[1];\r\n                  var tstart=xaxisData[startIndex],tend=xaxisData[endIndex]?xaxisData[endIndex]:xaxisData[endIndex-1];\r\n\r\n                  if(tstart==tend){ //采样频率稍大时（为'5m'时很容易出现这个问题）,如果用户选定的范围只在一个采样点内（只拉动一个阴影格），会导致起始查询时间和截止查询时间一致，这时在这个时间点上可能没有数据（但看起来应该有数据，采样频率导致的），因此遇到这种情况就把起始时间的范围以及截止时间的范围都各自扩大一个采样点，这样保证了用户只选取一个阴影格的时候也会有数据。\r\n                    // console.log(tstart,tend,'相等');\r\n                    var adTstart=new Date(tstart).getTime(),adTend=new Date(tend).getTime();\r\n                    if(_this.$store.state.mydatedata.interval=='5m'){//此时interval=='1d' 或者 '1h'的可能性很小，因此没写了\r\n                      adTstart-=5*60*1000;\r\n                      adTend+=5*60*1000;\r\n                    }else if(_this.$store.state.mydatedata.interval=='10s'){\r\n                      adTstart-=10*1000;\r\n                      adTend+=10*1000;\r\n                    }else if(_this.$store.state.mydatedata.interval=='1s'){ //interval=='1s' 采样频率精确到1s，在往下拉也会一直有数据，因此也没写了\r\n                      // adTstart-=1*1000\r\n                      // adTend+=1*1000\r\n                    }\r\n                    tstart = _this.transformMyDate(adTstart);\r\n                    tend = _this.transformMyDate(adTend);\r\n                  }\r\n                  // console.log(tstart,tend);\r\n\r\n                  _this.$store.state.nowTimeVal=[new Date(tstart),new Date(tend)];//改变右上角时间（跟拉到的时间保持一致）\r\n                  clearTimeout(_this.$store.state.refreshTimeout)//图表轮询定时器 清除按时刷新数据的定时器\r\n                  _this.$store.state.refreshAble=true;//禁用自动刷新\r\n                  setTimeout(()=>{\r\n                    _this.$store.commit(types.MYDATEPICKER);\r\n                  },0)\r\n                }\r\n              }\r\n            });\r\n          });\r\n        // })\r\n      }\r\n      lineTimerFn();\r\n    },\r\n    drawDomainPie(){\r\n      var _this=this;\r\n      _this.domainPieLoading=true;\r\n      _this.domainPieChart = echarts.init(document.getElementById('domainPieContainer'));\r\n      var options = {\r\n            color:['#c6b38e','#a4d8c2','#f3d999','#d3758f','#dcc392','#b8d2c7','#3cb371','#d5b158','#38b6b6','#82b6e9'],\r\n            title : {\r\n              text: _this.$t('lg.normalaccdomaintop10'),\r\n              // subtext: 'TOP10',\r\n              // top:'20px',\r\n              x:'center',\r\n              textStyle: {\r\n                fontSize: '16',\r\n                fontWeight: 'normal'\r\n              }\r\n            },\r\n            tooltip: {\r\n              trigger: 'item',\r\n              formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n            },\r\n            // legend: {\r\n            //   orient: 'horizontal',\r\n            //   bottom:'0px',\r\n            //   data:[]\r\n            // },\r\n            series: [\r\n              {\r\n                name:_this.$t('lg.accesssource')+':',\r\n                type:'pie',\r\n                radius:['25%','35%'],\r\n                // radius:'40%',\r\n                // center: ['50%', '50%'],\r\n                data:[].sort(function (a, b) { return a.value - b.value; }),\r\n                // roseType: 'radius',//area radius\r\n                label: {\r\n                  position:'outside',\r\n                  normal: {\r\n                    textStyle: {\r\n                      fontSize: '12',  \r\n                    },\r\n                    formatter: \"{b}: {c}\"\r\n                  },\r\n                  emphasis: {\r\n                    show: true,\r\n                    textStyle: {\r\n                      fontSize: '14',\r\n                      fontWeight: 'normal'\r\n                    }\r\n                  }\r\n                },\r\n                labelLine: {\r\n                  normal: {\r\n                    smooth: 0,\r\n                    length: 10,\r\n                    length2: 20,\r\n                  },\r\n                },\r\n                animationType: 'scale',\r\n                animationEasing: 'elasticOut',\r\n                animationDelay: function (idx) {\r\n                  return Math.random() * 200;\r\n                }\r\n              }\r\n            ]\r\n          };\r\n      function getDomainPieData(){\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body: {\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": [\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.response_code:200\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.error_code:0\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.decrypted:1\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"range\": {\r\n                      \"@timestamp\": {\r\n                        \"gte\": _this.fromTime,\r\n                        \"lte\": _this.endTime\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"url\": {\r\n                \"terms\": {\r\n                  \"field\": \"shadow.access.http_host\",\r\n                  \"size\": 10\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }).then((res)=>{\r\n          // console.log(res);\r\n          var tarResult=res.aggregations?res.aggregations.url.buckets:[];\r\n          var result=[],legendRlt=[];\r\n          for(var i=0;i<tarResult.length;i++){\r\n            var dataI=tarResult[i];\r\n            result.push(\r\n              {\r\n                value:dataI[\"doc_count\"],\r\n                name:dataI[\"key\"]\r\n              }\r\n            );\r\n            legendRlt.push(dataI[\"key\"])\r\n          }\r\n          options.series[0].data=result;\r\n          // options.legend.data=legendRlt;\r\n          if(result.length==0){\r\n            _this.domainPieNodata=true;\r\n          }else{\r\n            _this.domainPieNodata=false;\r\n          }\r\n          _this.domainPieChart.setOption(options,true);\r\n          _this.domainPieLoading=false;\r\n         \r\n          _this.domainPieChart.off(\"click\");\r\n          _this.domainPieChart.on(\"click\",(params)=>{\r\n            // console.log(params);\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                      \"query\":\"shadow.access.error_code:0\"\r\n                    }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                      \"query\":\"shadow.access.response_code:200\"\r\n                    }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.decrypted:1\"\r\n              }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n                  \"query_string\": {\r\n                      \"query\":\"shadow.access.http_host:\"+_this.logDialogTitle.replace(/:/g,'\\\\:')\r\n                    }\r\n            });\r\n            _this.getOnepieceFromPie();\r\n          })\r\n        });\r\n      }\r\n      getDomainPieData();\r\n    },\r\n    drawFingerPie(){\r\n      var _this=this;\r\n      _this.fingerPieLoading=true;\r\n      _this.fingerPieChart = echarts.init(document.getElementById('fingerPieContainer'));\r\n      \r\n      var option = {\r\n        color:['#73a373','#73b9bc','#7289ab','#91ca8c','#f49f42','#759aa0','#e69d87','#8dc1a9','#ea7e53','#eedd78'],\r\n        title : {\r\n          text: _this.$t('lg.fpaccesstop10'),\r\n          x:'center',\r\n          textStyle: {\r\n          fontSize: '16',\r\n          fontWeight: 'normal'\r\n          }\r\n        }, \r\n        tooltip : {    \r\n          trigger: 'item',\r\n          formatter: \"{a} <br/>{b} : {c} ({d}%)\"\r\n        },\r\n        legend: {\r\n          show:_this.fingerPieLegendShow,\r\n          backgroundColor:'#fff',\r\n          orient: 'vertical',\r\n          top:'30',\r\n          right:'right',\r\n          data: []//['视频广告']\r\n        },\r\n        series: \r\n          {\r\n            name: _this.$t('lg.accesssource'),\r\n            type: 'pie',\r\n            radius : '40%',\r\n            center: ['50%', '50%'],\r\n            data:[],//[{value:135, name:'视频广告'}],\r\n            itemStyle: {\r\n              emphasis: {\r\n                shadowBlur: 10,\r\n                shadowOffsetX: 0,\r\n                shadowColor: 'rgba(0, 0, 0, 0.5)'\r\n              }\r\n            },\r\n            label: {\r\n              position:'outside',\r\n              normal: {\r\n                textStyle: {\r\n                  fontSize: '12',  \r\n                },\r\n                formatter: \"{b}: {c}\"\r\n              },\r\n              emphasis: {\r\n                show: true,\r\n                textStyle: {\r\n                  fontSize: '14',\r\n                  fontWeight: 'normal',\r\n                },\r\n              }\r\n            },\r\n            labelLine: {\r\n              normal: {\r\n                smooth: 0,\r\n                length: 10,\r\n                length2: 20,\r\n              },\r\n            },\r\n          }\r\n        };\r\n\r\n      function getFingerPieData(){\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body:{\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": [\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.response_code:200\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.error_code:0\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.decrypted:1\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"range\": {\r\n                      \"@timestamp\": {\r\n                        \"gte\": _this.fromTime,\r\n                        \"lte\": _this.endTime\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"tokenName\": {\r\n                \"terms\": {\"field\" : \"shadow.access.token\",\"size\": 10}\r\n              }\r\n            }\r\n          }\r\n        }).then((res)=>{\r\n          var tarResult=[],\r\n          tarResult=res.aggregations?res.aggregations.tokenName.buckets:[];\r\n          if(tarResult.length==0){\r\n            _this.fingerPieNodata=true;\r\n          }else{\r\n            _this.fingerPieNodata=false;\r\n          }\r\n          var result=[],legendRlt=[]; \r\n          for(var i=0;i<tarResult.length;i++){\r\n            var dataI=tarResult[i];\r\n              result.push(\r\n              {\r\n                value:dataI[\"doc_count\"],\r\n                name:dataI[\"key\"]\r\n              }\r\n            );\r\n           legendRlt.push(dataI[\"key\"])\r\n          }\r\n          \r\n          option.series.data=result;\r\n          option.legend.data=legendRlt;\r\n          _this.fingerPieChart.setOption(option,true);\r\n          _this.fingerPieLoading=false;\r\n        \r\n          _this.fingerPieChart.off(\"click\");\r\n          _this.fingerPieChart.on(\"click\",(params)=>{\r\n            // console.log(params)\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                \"query\":\"shadow.access.error_code:0\"\r\n              }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                \"query\":\"shadow.access.response_code:200\"\r\n              }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.decrypted:1\"\r\n              }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                  \"query\":\"shadow.access.token:\"+'\\\"'+_this.logDialogTitle+'\\\"'\r\n                }\r\n              });\r\n            _this.getOnepieceFromPie();\r\n          })\r\n        });\r\n      }\r\n      getFingerPieData();\r\n    },\r\n    drawAutoToolPie(){\r\n      var _this=this;\r\n      _this.autoToolPieLoading=true;\r\n      this.autoToolPieChart = echarts.init(document.getElementById('autoToolPieContainer'));\r\n    \r\n      var option = {\r\n          title : {\r\n            text: _this.$t('lg.userterminaltype'),\r\n            x:'center',\r\n            textStyle: {\r\n            fontSize: '16',\r\n            fontWeight: 'normal'\r\n            }\r\n          }, \r\n          color: ['#4ea397'],\r\n          tooltip: {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n              type: 'none'\r\n            },\r\n            formatter: function (params) {\r\n              return params[0].name + ': ' + params[0].value;\r\n            }\r\n          },\r\n          grid: {\r\n            top:'12%',\r\n            left: '-10',\r\n            right: '5%',\r\n            bottom: '10%',\r\n            containLabel: true\r\n          },\r\n          xAxis: {\r\n            show:false,\r\n            data: [],\r\n            axisTick: {show: true},\r\n            axisLine: {show: true},\r\n            axisLabel: {\r\n              textStyle: {\r\n                color: '#4ea397'\r\n              },\r\n              interval:0,//横轴信息全部显示  \r\n              rotate:-30,//-30度角倾斜显示  \r\n            }\r\n          },\r\n          yAxis: {\r\n            show:false,\r\n          },\r\n          \r\n          series: [{\r\n            name: 'hill',\r\n            type: 'pictorialBar',\r\n            barCategoryGap: '-5%',\r\n            symbol: 'path://M0,10 L10,10 C5.5,10 5.5,5 5,0 C4.5,5 4.5,10 0,10 z',\r\n            itemStyle: {\r\n              normal: {\r\n                opacity: 0.6\r\n              },\r\n              emphasis: {\r\n                opacity: 1\r\n              }\r\n            },\r\n            data: [],\r\n            // label:{\r\n            //   normal: {\r\n            //     show: true,\r\n            //     position:'top',\r\n            //     color:'#e54035'\r\n            //   }\r\n            // },\r\n            z: 10\r\n          }, {\r\n            name: 'glyph',\r\n            type: 'pictorialBar',\r\n            barGap: '-100%',\r\n            symbolPosition: 'end',\r\n            symbolSize: 5,\r\n            symbolOffset: [0, '-120%'],\r\n            data: []\r\n          }]\r\n        };\r\n\r\n       function getAutoToolPieData(){\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body:{\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": [\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.response_code:200\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.error_code:0\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.decrypted:1\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"range\": {\r\n                      \"@timestamp\": {\r\n                        \"gte\": _this.fromTime,\r\n                        \"lte\": _this.endTime\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"user_agent\": {\r\n                \"terms\": {\"field\" : \"shadow.access.user_agent.name\",\"size\": 10}\r\n              }\r\n            }\r\n          }\r\n\r\n        }).then((res)=>{\r\n          // console.log(res);\r\n          var tarResult=res.aggregations?res.aggregations.user_agent.buckets:[];\r\n          // tarResult=[\r\n          //   {key: \"Chrome\", doc_count: 778},{key: \"aws\", doc_count: 199},\r\n          //   {key: \"BAI\", doc_count: 879},{key: \"fox\", doc_count: 198},\r\n          // ];\r\n          var seriesData1=[],seriesData2=[],xAxisData=[];\r\n          \r\n          if(tarResult.length>0){\r\n            _this.autoToolPieNodata=false;\r\n            option.xAxis.show=true;\r\n            \r\n            tarResult.forEach(element => {\r\n              xAxisData.push(element.key);\r\n              seriesData1.push(element.doc_count)\r\n              seriesData2.push({value:element.doc_count})\r\n            });\r\n\r\n          }else{\r\n            _this.autoToolPieNodata=true;\r\n            option.xAxis.show=false;\r\n          }\r\n\r\n          option.series[0].data=seriesData1;\r\n          option.series[1].data=seriesData2;\r\n          option.xAxis.data=xAxisData;\r\n\r\n          _this.autoToolPieChart.setOption(option,true);\r\n          _this.autoToolPieLoading=false;\r\n         \r\n          _this.autoToolPieChart.off(\"click\");\r\n          _this.autoToolPieChart.on(\"click\",(params)=>{\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                      \"query\":\"shadow.access.error_code:0\"\r\n                    }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                      \"query\":\"shadow.access.response_code:200\"\r\n                    }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.decrypted:1\"\r\n              }\r\n            });\r\n            _this.popQueryObj.bool.must.push({\r\n                  \"query_string\": {\r\n                      \"query\":\"shadow.access.user_agent.name:\"+'\\\"'+_this.logDialogTitle+'\\\"'\r\n                    }\r\n                });\r\n            _this.getOnepieceFromPie();\r\n          })\r\n\r\n        });\r\n      }\r\n      getAutoToolPieData();\r\n    },\r\n   // drawApiRespTimeBar(){\r\n    //   var _this=this;\r\n    //   _this.apiRespTimeBarLoading=true;\r\n    //   _this.apiRespTimeBarChart = echarts.init(document.getElementById('apiRespTimeBarContainer'));\r\n\r\n    //   var option = {\r\n    //         title: {\r\n    //           text: 'API响应时间/Top10',\r\n    //           x:'left',\r\n    //           textStyle: {\r\n    //             fontSize: '16',\r\n    //             fontWeight: 'normal'\r\n    //           }\r\n    //         },\r\n    //         color:['#626c91','#97b552'],\r\n    //         tooltip: {\r\n    //           trigger: 'axis',\r\n    //           axisPointer: {\r\n    //             type: 'cross',\r\n    //           }\r\n    //         },\r\n    //         grid: {\r\n    //           left: '5%',\r\n    //           right: '4%',\r\n    //           bottom:'4%',\r\n    //           top:'20%',\r\n    //           containLabel: true\r\n    //         },\r\n    //         legend: {\r\n    //           show:false,\r\n    //           top:'20px',\r\n    //           data: ['响应时间', '次数']\r\n    //         },\r\n    //         toolbox: {\r\n    //           right:'20',\r\n    //           top:'10',\r\n    //         },\r\n    //         xAxis: {\r\n    //           show:false,\r\n    //           type: 'category',\r\n    //           data: [],\r\n    //           axisPointer: {\r\n    //             type: 'shadow'\r\n    //           },\r\n    //           // axisLabel:{\r\n    //           //   interval:2\r\n    //           // }\r\n    //         },\r\n    //         yAxis: [\r\n    //           { \r\n    //             show:false,\r\n    //             type: 'value',\r\n    //             name: '响应时间/ms',\r\n    //             axisLabel: {\r\n    //               formatter: '{value}'\r\n    //             },\r\n    //           },\r\n    //           { \r\n    //             show:false,\r\n    //             type: 'value',\r\n    //             name: '次数',\r\n    //             axisLabel: {\r\n    //               formatter: '{value}'\r\n    //             },\r\n    //             minInterval: 1//保持y轴刻度只为整数\r\n    //           }\r\n    //         ],\r\n    //         series: [\r\n    //           {\r\n    //             name: '响应时间',\r\n    //             type: 'bar',\r\n    //             barMaxWidth:20,\r\n    //             data: []\r\n    //           },\r\n    //           {\r\n    //             name: '次数',\r\n    //             type: 'line',\r\n    //             type: 'bar',\r\n    //             barMaxWidth:20,\r\n    //             yAxisIndex: 1,\r\n    //             data: []\r\n    //           }\r\n    //         ]\r\n    //     };\r\n    //   function getApiRespTime(){\r\n    //     client.search({\r\n    //       index: \"shadow-filebeat-*\",\r\n    //       body: {\r\n    //         \"size\": 0,\r\n    //         \"query\": {\r\n    //           \"bool\": {\r\n    //             \"filter\": _this.filterObj,\r\n    //             \"must\": [\r\n    //               {\r\n    //                 \"query_string\": {\r\n    //                   \"query\": \"shadow.access.response_code:200\"\r\n    //                 }\r\n    //               },\r\n    //               {\r\n    //                 \"query_string\": {\r\n    //                   \"query\": \"shadow.access.error_code:0\"\r\n    //                 }\r\n    //               },\r\n    //               {\r\n    //                 \"query_string\": {\r\n    //                   \"query\": \"shadow.access.decrypted:1\"\r\n    //                 }\r\n    //               },\r\n    //               {\r\n    //                 \"range\": {\r\n    //                   \"@timestamp\": {\r\n    //                     \"gte\": _this.fromTime,\r\n    //                     \"lte\": _this.endTime\r\n    //                   }\r\n    //                 }\r\n    //               }\r\n    //             ]\r\n    //           }\r\n    //         },\r\n    //         \"aggs\": {\r\n    //           \"GroupByDomain\": {\r\n    //             \"terms\": {\r\n    //               \"field\": \"shadow.access.domain\",\r\n    //               \"min_doc_count\": 1,\r\n    //               \"size\": 500\r\n    //             },\r\n    //             \"aggs\": {\r\n    //               \"GroupByRespTime\": {\r\n    //                 \"terms\": {\r\n    //                   \"field\": \"shadow.access.org_url\",\r\n    //                   \"min_doc_count\": 1,\r\n    //                   \"size\": 10\r\n    //                 },\r\n    //                 \"aggs\": {\r\n    //                   \"avg_time\": {\r\n    //                     \"avg\": {\r\n    //                       \"field\": \"shadow.access.upstream_time\"\r\n    //                     }\r\n    //                   }\r\n    //                 }\r\n    //               }\r\n    //             }\r\n    //           }\r\n    //         }\r\n    //       }\r\n    //     }).then((res)=>{\r\n    //       // console.log(res);\r\n    //       var buckets=[];\r\n    //       var domainBuckets=res.aggregations?res.aggregations.GroupByDomain.buckets:[];\r\n    //       if(_this.checkDomain && domainBuckets.length>0){\r\n    //         buckets=res.aggregations.GroupByDomain.buckets[0].GroupByRespTime.buckets;\r\n    //       }else{//如果不选定域名，则该图表无法展示数据（数据维度不同）。用暂无数据替代\r\n    //         buckets=[];\r\n    //       }\r\n\r\n    //       var xaxisData=[],respTimeData=[],respCountData=[];\r\n    //       buckets.forEach(ele => {\r\n    //         if(ele.avg_time.value){\r\n    //           xaxisData.push(ele.key);\r\n    //           respTimeData.push((ele.avg_time.value*1000).toFixed(2))//*1000由秒变成毫秒\r\n    //           respCountData.push(ele.doc_count)\r\n    //         }\r\n    //       });\r\n\r\n    //       if(!_this.checkDomain || xaxisData.length==0){\r\n    //         option.xAxis.show=false;\r\n    //         option.yAxis[0].show=false;\r\n    //         option.yAxis[1].show=false;\r\n    //         option.tooltip.show=false;\r\n    //         _this.apiRespTimeBarNodata=true;\r\n    //         option.legend.show=false;\r\n    //       }else{\r\n    //         option.xAxis.show=true;\r\n    //         option.yAxis[0].show=true;\r\n    //         option.yAxis[1].show=true;\r\n    //         option.tooltip.show=true;\r\n    //         option.legend.show=true;\r\n    //         _this.apiRespTimeBarNodata=false;\r\n    //       }\r\n          \r\n    //       option.xAxis.data=xaxisData;\r\n    //       option.series[0].data=respTimeData;\r\n    //       option.series[1].data=respCountData;\r\n\r\n    //       _this.apiRespTimeBarChart.setOption(option,true);\r\n    //       _this.apiRespTimeBarLoading=false;\r\n\r\n    //       _this.apiRespTimeBarChart.off(\"click\");\r\n    //       _this.apiRespTimeBarChart.on(\"click\",(params)=>{\r\n    //         // console.log(params)\r\n    //         _this.logDialogVisible=true;\r\n    //         _this.logDialogTitle=params.name;\r\n    //         _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n    //         _this.popQueryObj.bool.must.push({\r\n    //           \"query_string\": {\r\n    //             \"query\":\"shadow.access.response_code:200\"\r\n    //           }\r\n    //         });\r\n    //         _this.popQueryObj.bool.must.push({\r\n    //           \"query_string\": {\r\n    //             \"query\": \"shadow.access.error_code:0\"\r\n    //           }\r\n    //         });\r\n    //         _this.popQueryObj.bool.must.push({\r\n    //           \"query_string\": {\r\n    //             \"query\": \"shadow.access.decrypted:1\"\r\n    //           }\r\n    //         });\r\n    //         _this.popQueryObj.bool.must.push({\r\n    //           \"query_string\": {\r\n    //             \"query\":\"shadow.access.org_url:\"+_this.logDialogTitle.replace(/\\//g,'\\\\/')\r\n    //           } \r\n    //         });\r\n    //         _this.getOnepieceFromPie();\r\n    //       });\r\n    //     });\r\n    //   }\r\n    //   getApiRespTime();\r\n   // },\r\n\r\n    fullScreen(){//大屏展示\r\n      var chartGridDom = document.getElementsByClassName('apiChart-wrapper');\r\n      chartGridDom[0].requestFullscreen();\r\n\r\n      window.addEventListener(\"fullscreenchange\", (e) => {\r\n        if (document.fullscreenElement) {\r\n          this.isShowQueryPanel = false;\r\n          this.isShowGridMenu = false;\r\n        } else {\r\n          this.isShowQueryPanel = true;\r\n          this.isShowGridMenu = true;\r\n        }\r\n      })\r\n    },\r\n    downLoadPdf(){//导出数据图为pdf文件\r\n      if(this.attackSumNum!=0){\r\n        const myChart1Str = this.businessLineChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart2Str = this.urlVisitCtBarChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart3Str = this.regionSunburstChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart4Str = this.orgIpLineChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart5Str = this.orgIpPieChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart6Str = this.domainLineChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart7Str = this.domainPieChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart8Str = this.fingerPieChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart9Str = this.autoToolPieChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        // const myChart10Str = this.apiRespTimeBarChart.getDataURL({\r\n        //   type:'jpeg',\r\n        //   pixelRatio: 2,\r\n        //   backgroundColor: '#fff',\r\n        // }).replace(\"data:image/jpeg;base64,\",\"\");\r\n\r\n        const myCharArray = [myChart1Str,myChart2Str,myChart3Str,myChart4Str,myChart5Str,myChart6Str,myChart7Str,myChart8Str,myChart9Str]; //myChart10Str\r\n        const url = SERVER_API_URL + 'pe/download/conversion/jpg2pdf';\r\n        axios.post(url,{\r\n          base64StringList:myCharArray\r\n        },{\r\n          responseType:'blob'\r\n        }).then((res)=>{\r\n          //  console.log(res)\r\n          if(res.status==200){\r\n            var filename = '正常访问数据图表.pdf';\r\n            this.$store.commit(types.MAKEPDF,{'pdfdata':res.data,'pdfname':filename});\r\n          }\r\n        }).catch((err)=>{\r\n          console.log(err);\r\n        });\r\n      }else{\r\n        this.$message.error(this.$t('lg.nodata'));\r\n      }\r\n    },\r\n   \r\n    //日志弹框\r\n    getChangeLogData(pageObj){   //改变分页返回数据\r\n      this.fromPage = pageObj.curPage-1;\r\n      this.pageSize= pageObj.pageNum;\r\n      this.requeryObj?this.getOnepieceFromPie(this.requeryObj):this.getOnepieceFromPie();\r\n    },\r\n    getOnepieceFromPie(requeryObj){\r\n      var _this=this;\r\n      // console.log(_this.popQueryObj);\r\n\r\n      let clientQueryObj = JSON.parse(JSON.stringify(_this.popQueryObj));//清空（清空方法本身加的查询条件，但同时保存了外部查询条件）\r\n      clientQueryObj.bool.must.push(\r\n        {\r\n          \"range\": {\r\n            \"@timestamp\": {\r\n              \"gte\": _this.fromTime,\r\n              \"lte\": _this.endTime\r\n            }\r\n          }\r\n        }\r\n      );\r\n      if(requeryObj){//双重过滤（顶部查询面板以及日志弹框里面的requery子组件查询。要把这两者的查询语句融汇在一起）\r\n        // console.log(requeryObj);\r\n        const requeryArr = requeryObj.bool.must;\r\n        // _this.popQueryObj.bool.filter={..._this.popQueryObj.bool.filter,...requeryObj}\r\n\r\n        if(clientQueryObj.bool.filter.bool){\r\n          requeryArr.forEach((item)=>{\r\n            clientQueryObj.bool.filter.bool.must.push(item);\r\n          })\r\n        }else{\r\n          clientQueryObj.bool.filter={\"bool\":{\"must\":[]}}\r\n          requeryArr.forEach((item)=>{\r\n            clientQueryObj.bool.filter.bool.must.push(item);\r\n          })\r\n        }\r\n      }\r\n      // console.log(clientQueryObj)\r\n      client.search({\r\n        index:\"shadow-filebeat*\",\r\n        body:{\r\n          \"from\":_this.fromPage*_this.pageSize,\r\n          \"size\": _this.pageSize,\r\n          \"sort\": {\r\n            \"@timestamp\": \"desc\"\r\n          },\r\n          \"query\": clientQueryObj\r\n        }\r\n      }).then((res2)=>{\r\n        console.log(\"图表弹出表格数据：======\")\r\n        console.log(res2)\r\n        _this.chartLogsTotalNum=res2.hits.total.value;\r\n        let logResArr=res2.hits.hits;\r\n\r\n        // 获取access.log表体数据\r\n\r\n        \r\n        _this.chartLogsBodyData = handleAccesslogData(logResArr);\r\n      })\r\n    },\r\n    requeryRowByAccess(obj){ //用户通过requery孙组件筛选access.log显示的行\r\n      this.requeryObj=obj.requeryObj //记录用户再次查询日志的 查询语句\r\n      this.fromPage=0;\r\n      this.getOnepieceFromPie(this.requeryObj);\r\n      if(this.$refs.log_tables) this.$refs.log_tables.tabCurPage=1;//当用户点击查询后，查询结果的页码要回到第一页\r\n    },\r\n    refilterColByAccess(obj){  //用户通过refilter孙组件筛选access.log显示的列，删除或者增加字段显示的时候变化头部，发送用户增删请求\r\n      var url = SERVER_API_URL + '/pe/shadow/kv';\r\n      axios.post(url,{apiChartAccess:obj}).then(res=>{\r\n        if(Object.keys(res.data.data.Failure)){\r\n          axios.patch(url,{apiChartAccess:obj}).then(res=>{\r\n          })\r\n        }\r\n      })\r\n      this.chartLogsHeadData = obj;\r\n    },\r\n    logDialogClose(){\r\n      this.logDialogVisible=false;\r\n      this.logDialogTitle='';\r\n      this.fromPage=0;\r\n      this.chartLogsTotalNum=0;\r\n      this.popQueryObj={\"bool\":{\"must\":[]}};\r\n      this.broadcast('logRequery',\"clearData\");//清空孙组件里logRequry的查询条件输入框里的内容，要引入Emitter\r\n      this.requeryObj=null;//清空孙组件里logRequry的被带入日志查询语句的查询条件\r\n    },\r\n\r\n    // 功能函数\r\n    transformMyDate(d){\r\n      d=new Date(d);\r\n      function pad(n){\r\n        return n<10 ? '0'+n : n\r\n      }\r\n      return pad(d.getFullYear())+\"-\"+pad(parseInt(d.getMonth())+1)+\"-\"+pad(d.getDate())+\" \"+pad(d.getHours())+':' + pad(d.getMinutes())+':' + pad(d.getSeconds());//+':' + pad(d.getSeconds())\r\n    }\r\n  },\r\n  beforeDestroy(){\r\n    window.removeEventListener('resize',function(){});\r\n  }\r\n}\r\n</script>\r\n<style>\r\n.apiChart-wrapper{\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  padding: 15px;\r\n  box-sizing: border-box;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.apiChartContent{\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n  padding-right: 10px;\r\n}\r\n\r\n/*图表*/\r\n.chartRow{\r\n  margin-bottom: 10px;\r\n}\r\n.chartRowBusi{\r\n  margin-left: 0px!important;\r\n}\r\n\r\n#urlVisitCtBarContainer,#regionSunburstContainer,#orgIpLineContainer,#domainLineContainer,#orgIpPieContainer,#domainPieContainer,#fingerPieContainer,#autoToolPieContainer,#apiRespTimeBarContainer{\r\n  width: 100%;\r\n  height: 310px;\r\n  padding: 10px;\r\n  box-sizing: border-box;\r\n}\r\n/*业务表 max min*/\r\n.busiChartBox{\r\n  padding: 10px;\r\n  box-sizing: border-box;\r\n  background: #f7f7f7;\r\n}\r\n#businessContainer{\r\n  width: 100%;\r\n  height: 290px;\r\n}\r\n.busiNumBox{\r\n  background: #fff;\r\n  height: 290px;\r\n  padding: 30px 10px !important;\r\n  box-sizing: border-box;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n.totalList{\r\n  margin-bottom: 20px;\r\n}\r\n.totalList li{\r\n  color: #27727b;\r\n  margin-bottom: 10px;\r\n  line-height: 15px;\r\n}\r\n.someList li{\r\n  color: #7eb00a;\r\n  margin-bottom: 10px;\r\n  line-height: 15px;\r\n}\r\n.totalList .listTitle,.someList .listTitle{\r\n  color: #606266;\r\n  margin-bottom: 15px;\r\n  padding-left: 0px;\r\n}\r\n.liLable{\r\n  font-size: 12px;\r\n  font-style:italic;\r\n  padding-left: 10px;\r\n}\r\n.liValue{\r\n  text-align: center;\r\n  font-size: 1.2vw;\r\n}\r\n/*次数显示&业务表*/\r\n.numBox{\r\n  width: 100%;\r\n  height: 310px;\r\n  padding: 10px;\r\n  box-sizing: border-box;\r\n  /* box-shadow: 2px 2px 5px #ccc; */\r\n}\r\n.numBoxTitle{\r\n  font-size: 16px;\r\n  color: #333;\r\n}\r\n.totalBox {\r\n  margin-top: 20px;\r\n  height: 80px;\r\n}\r\n.abnormalBox{\r\n  margin-top: 30px;\r\n  height: 100px;\r\n}\r\n.numTitle{\r\n  color: #606266; \r\n  padding-left: 10px;\r\n}\r\n.totalNum{\r\n  margin-left: 20%;\r\n  font-size: 2.5vw;\r\n  color: #516b91;\r\n  line-height: 60px;\r\n}\r\n.abnormalNum{\r\n  text-align: center;\r\n  font-size: 4vw;\r\n  color: #2b821d;\r\n  line-height: 90px;\r\n}\r\n.uTxt{\r\n  font-size: 14px;\r\n  color: #606266;\r\n}\r\n\r\n/*pei图暂无数据*/\r\n.adaptive-circle {\r\n  margin: 50px auto 0;\r\n  width: 22%;\r\n  height: 0;\r\n  padding-top: 22%;\r\n  border-radius: 100%;\r\n  box-sizing: border-box;\r\n  background:#fff;\r\n  position:absolute;\r\n  top:15%;\r\n  left:40%;\r\n}\r\n.fingerPie-circle{\r\n  margin: 0;\r\n  width: 15%;\r\n  left:42%;\r\n  top:30%;\r\n  padding-top: 15%;\r\n}\r\n.adaptive-circle .layout {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  text-align: center;\r\n}\r\n.adaptive-circle .layout.middle:before {\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n  content: '';\r\n  height: 100%;\r\n  width: 0;\r\n  overflow: hidden;\r\n}\r\n.adaptive-circle .layout.middle div:first-child {\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n}\r\n\r\n/*导出数据图表*/\r\n/*.downBtn{\r\n  position: fixed;\r\n  bottom: 20px;\r\n  right: 50px;\r\n  padding: 5px;\r\n}\r\n.downBtn a{\r\n  font-size: 15px;\r\n}*/\r\n\r\n/* loading 主要针对‘自定义图表’的loading */\r\n.apiChart-wrapper .el-loading-spinner{\r\n  padding: 3px;\r\n  box-sizing: border-box;\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  text-align: right;\r\n  margin-top: 0;\r\n}\r\n.apiChart-wrapper .el-loading-spinner i{\r\n  color: #242222;\r\n  font-size: 18px;\r\n}\r\n</style>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/apiConfig/apiChart.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"apiChart-wrapper\"},[_c('query-panel',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowQueryPanel),expression:\"isShowQueryPanel\"}],attrs:{\"isApi\":true},on:{\"getAllQuerychart\":_vm.getAllchart}}),_vm._v(\" \"),_c('div',{staticClass:\"apiChartContent\"},[_c('el-row',{staticClass:\"chartRow chartRowBusi\",attrs:{\"gutter\":20}},[_c('el-col',{staticClass:\"busiChartBox\",attrs:{\"span\":18}},[_c('el-col',{staticStyle:{\"padding-left\":\"0px\"},attrs:{\"span\":20}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.businessLineLoading),expression:\"businessLineLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.businessNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"businessContainer\"}})],1)]),_vm._v(\" \"),_c('el-col',{staticClass:\"busiNumBox\",attrs:{\"span\":4}},[_c('ul',{staticClass:\"totalList\"},[_c('li',{staticClass:\"listTitle\"},[_vm._v(_vm._s(_vm.$t('lg.totalrequests'))+\"：\")]),_vm._v(\" \"),_c('li',[_c('i',{staticClass:\"liLable\"},[_vm._v(\"MAX:\")]),_vm._v(\" \"),_c('p',{staticClass:\"liValue\"},[_vm._v(_vm._s(_vm.wholeCtMax))])]),_vm._v(\" \"),_c('li',[_c('i',{staticClass:\"liLable\"},[_vm._v(\"MIN:\")]),_vm._v(\" \"),_c('p',{staticClass:\"liValue\"},[_vm._v(_vm._s(_vm.wholeCtMin))])])]),_vm._v(\" \"),_c('ul',{staticClass:\"someList\"},[_c('li',{staticClass:\"listTitle\"},[_vm._v(_vm._s(_vm.$t('lg.normalaccess'))+\"：\")]),_vm._v(\" \"),_c('li',[_c('i',{staticClass:\"liLable\"},[_vm._v(\"MAX:\")]),_vm._v(\" \"),_c('p',{staticClass:\"liValue\"},[_vm._v(_vm._s(_vm.normalCtMax))])]),_vm._v(\" \"),_c('li',[_c('i',{staticClass:\"liLable\"},[_vm._v(\"MIN:\")]),_vm._v(\" \"),_c('p',{staticClass:\"liValue\"},[_vm._v(_vm._s(_vm.normalCtMin))])])])])],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":6}},[_c('div',{staticClass:\"chart-content numBox txtOverflow\"},[_c('p',{staticClass:\"text-center numBoxTitle\"},[_vm._v(_vm._s(_vm.$t('lg.totaldatav')))]),_vm._v(\" \"),_c('div',{staticClass:\"totalBox\"},[_c('p',{staticClass:\"numTitle\"},[_vm._v(_vm._s(_vm.$t('lg.totalrquestammount')))]),_vm._v(\" \"),_c('p',{staticClass:\"totalNum\"},[_vm._v(_vm._s(_vm.totalNum)),_c('span',{staticClass:\"uTxt\"},[_vm._v(\"次\")])])]),_vm._v(\" \"),_c('div',{staticClass:\"abnormalBox\"},[_c('p',{staticClass:\"numTitle\"},[_vm._v(_vm._s(_vm.$t('lg.totalnormalaccess')))]),_vm._v(\" \"),_c('p',{staticClass:\"abnormalNum\"},[_vm._v(_vm._s(_vm.attackSumNum)),_c('span',{staticClass:\"uTxt\"},[_vm._v(_vm._s(_vm.$t('lg.count')))])])])])])],1),_vm._v(\" \"),_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":14}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.urlVisitCtLoading),expression:\"urlVisitCtLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.urlVisitCtBarNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"urlVisitCtBarContainer\"}})],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":10}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.regionSunburstLoading),expression:\"regionSunburstLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.regionSunburstNodata)?_c('div',{staticClass:\"adaptive-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(_vm._s(_vm.$t('lg.nodata')))])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"regionSunburstContainer\"}})])])],1),_vm._v(\" \"),_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":16}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.orgIpLineLoading),expression:\"orgIpLineLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.orgIpLineNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"orgIpLineContainer\"}})],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":8}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.orgIpPieLoading),expression:\"orgIpPieLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.orgIpPieNodata)?_c('div',{staticClass:\"adaptive-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(_vm._s(_vm.$t('lg.nodata')))])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"orgIpPieContainer\"}})])])],1),_vm._v(\" \"),_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":16}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.domainLineLoading),expression:\"domainLineLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.domainLineNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"domainLineContainer\"}})],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":8}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.domainPieLoading),expression:\"domainPieLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.domainPieNodata)?_c('div',{staticClass:\"adaptive-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(_vm._s(_vm.$t('lg.nodata')))])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"domainPieContainer\"}})])])],1),_vm._v(\" \"),_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":14}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.fingerPieLoading),expression:\"fingerPieLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.fingerPieNodata)?_c('div',{staticClass:\"adaptive-circle fingerPie-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(_vm._s(_vm.$t('lg.nodata')))])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"fingerPieContainer\"}})])]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":10}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.autoToolPieLoading),expression:\"autoToolPieLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.autoToolPieNodata)?_c('div',{staticClass:\"adaptive-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(_vm._s(_vm.$t('lg.nodata')))])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"autoToolPieContainer\"}})])])],1)],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":_vm.logDialogTitle,\"visible\":_vm.logDialogVisible,\"width\":\"80%\",\"before-close\":_vm.logDialogClose},on:{\"update:visible\":function($event){_vm.logDialogVisible=$event}}},[_c('log-rebuild',{attrs:{\"tableKeyArr\":_vm.tableKeyArrApi,\"dynamicTag\":_vm.chartLogsHeadData},on:{\"refilterColBy\":_vm.refilterColByAccess,\"requeryRowBy\":_vm.requeryRowByAccess}}),_vm._v(\" \"),(_vm.chartLogsTotalNum==0)?_c('div',{staticClass:\"nodata-box\"},[_vm._v(_vm._s(_vm.$t('lg.nodata')))]):_vm._e(),_vm._v(\" \"),(_vm.chartLogsTotalNum>0)?_c('div',{staticClass:\"logTableHeight\"},[_c('log-tables',{ref:\"log_tables\",attrs:{\"tabheadData\":_vm.chartLogsHeadData,\"tabodyData\":_vm.chartLogsBodyData,\"totalNum\":_vm.chartLogsTotalNum,\"isLogLoding\":false},on:{\"getChangeLogData\":_vm.getChangeLogData}})],1):_vm._e()],1),_vm._v(\" \"),_c('ul',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowGridMenu),expression:\"isShowGridMenu\"}],staticClass:\"operationBtnUl\"},[_c('li',[_c('img',{attrs:{\"src\":\"static/icon/fullScreen.png\",\"alt\":\"大屏展示\",\"title\":\"大屏展示\"},on:{\"click\":_vm.fullScreen}})]),_vm._v(\" \"),_c('li',[_c('img',{attrs:{\"src\":\"static/icon/downpdfChart.png\",\"alt\":\"导出pdf\",\"title\":\"导出pdf\"},on:{\"click\":_vm.downLoadPdf}})])])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7513b51d\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/apiConfig/apiChart.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7513b51d\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./apiChart.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./apiChart.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./apiChart.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7513b51d\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./apiChart.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/apiConfig/apiChart.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}