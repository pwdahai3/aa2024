webpackJsonp([37],{JKB9:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("mtWM"),s=i.n(n),a=i("yJCr"),o={components:{loading:i("qqiS").a},props:{isShow2:{type:Boolean},data:{type:Object}},data:function(){return{recipientsForm:{recipients:[{recAdress:""}],mailSubject:"",componentName:"",nodeName:"",subComponentName:"",enableDaemon:!1,enableNotification:!1},recipientsFormRules:{},editloading:!1}},watch:{data:function(){if(this.data.params){var e=[];this.recipientsForm.mailSubject=this.data.params.mailSubject,this.data.params.mailRecipient.forEach(function(t,i){e.push({recAdress:t})}),this.recipientsForm.recipients=e}this.recipientsForm.componentName=this.data.componentName,this.recipientsForm.nodeName=this.data.nodeName,this.recipientsForm.subComponentName=this.data.subComponentName,this.recipientsForm.enableDaemon=this.data.enableDaemon,this.recipientsForm.enableNotification=this.data.enableNotification}},methods:{closePop:function(){this.recipientsForm={recipients:[{recAdress:""}],mailSubject:""},this.$emit("setClose",!1)},addRecipients:function(){this.recipientsForm.recipients.push({recAdress:""})},delRecipients:function(e){this.recipientsForm.recipients.length>1&&this.recipientsForm.recipients.splice(e,1)},addFn:function(){var e=this,t=this;this.editloading=!0;for(var i=a.b+"/monitoring/component",n=[],o=0;o<t.recipientsForm.recipients.length;o++)n.push(t.recipientsForm.recipients[o].recAdress);var c=[{componentName:t.recipientsForm.componentName,nodeName:t.recipientsForm.nodeName,subComponentName:t.recipientsForm.subComponentName,enableDaemon:t.recipientsForm.enableDaemon,params:{mailRecipient:n,notificationType:"email",mailSubject:t.recipientsForm.mailSubject}}];s.a.post(i,c).then(function(i){0==i.data.responseCode?(t.$emit("updateRec"),t.$message({type:"success",message:t.$t("lg.success")}),t.recipientsForm={recipients:[{recAdress:""}],mailSubject:""},t.$emit("setClose",!1)):t.$message.error(t.$t("lg.failed")),e.editloading=!1})}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:"编辑收件人",visible:e.isShow2,width:"55%","before-close":e.closePop},on:{"update:visible":function(t){e.isShow2=t}}},[i("el-form",{ref:"recipientsForm",attrs:{model:e.recipientsForm,"label-width":"90px",rules:e.recipientsFormRules}},[e._l(e.recipientsForm.recipients,function(t,n){return i("div",{key:n},[i("el-form-item",{attrs:{label:0==n?e.$t("lg.recipient"):"",prop:"recipients."+n+".recAdress",rules:[{required:!0,message:e.$t("lg.required"),trigger:"blur"},{pattern:/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/,message:e.$t("lg.invalidemail"),trigger:"blur"}]}},[i("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:e.$t("lg.recipientadd")},model:{value:t.recAdress,callback:function(i){e.$set(t,"recAdress","string"==typeof i?i.trim():i)},expression:"item.recAdress"}}),e._v(" "),i("span",{attrs:{title:e.$t("lg.addrecipient")},on:{click:function(t){e.addRecipients()}}},[i("i",{staticClass:"el-icon-circle-plus-outline cursor-pointer"})]),e._v(" "),i("span",{attrs:{title:e.$t("lg.deleterecipient")},on:{click:function(t){e.delRecipients(n)}}},[i("i",{staticClass:"el-icon-close cursor-pointer"})])],1)],1)}),e._v(" "),i("el-form-item",{attrs:{label:e.$t("lg.emailtitle"),prop:"mailSubject"}},[i("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("lg.emailtitle")},model:{value:e.recipientsForm.mailSubject,callback:function(t){e.$set(e.recipientsForm,"mailSubject",t)},expression:"recipientsForm.mailSubject"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addFn()}}},[e._v(e._s(e.$t("lg.save")))]),e._v(" "),i("el-button",{on:{click:function(t){e.closePop()}}},[e._v(e._s(e.$t("lg.cancel")))])],1)],2),e._v(" "),i("loading",{directives:[{name:"show",rawName:"v-show",value:e.editloading,expression:"editloading"}],attrs:{title:"数据处理中..."}})],1)],1)},staticRenderFns:[]},r={created:function(){this.$store.state.contentLoading=!0,this.getCStatusList()},data:function(){return{csData:{},isshow:!1,isshow2:!1,pdata:{},pdata2:{}}},methods:{getCStatusList:function(){var e=this,t=a.b+"/monitoring/component";s.a.get(t).then(function(t){if(0==t.data.responseCode){var i=t.data.data,n=i.shadow;for(var s in n)n[s].forEach(function(e){"filebeat"==e.subComponentName?e.subComponentNameTxt="shadow log":"keepalived"==e.subComponentName?e.subComponentNameTxt="cluster":"metricbeat"==e.subComponentName&&(e.subComponentNameTxt="shadow metric")});e.csData=i}e.$store.state.contentLoading=!1})},daemonChange:function(e){var t=this,i=a.b+"/monitoring/component",n=[{componentName:e.componentName,nodeName:e.nodeName,subComponentName:e.subComponentName,enableDaemon:e.enableDaemon,enableNotification:e.enableNotification}];s.a.post(i,n).then(function(e){0==e.data.responseCode?t.$message({type:"success",message:t.$t("lg.success")}):t.$message.error(t.$t("lg.failed"))})},viewrec:function(e){this.pdata2=e,this.isshow2=!0}},components:{editrec:i("VU/8")(o,c,!1,null,null,null).exports}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"cmonitor-wrapper"},[e._l(e.csData,function(t,n){return i("div",{key:n,staticClass:"cmonitor-cm-wrapper"},[i("h2",{staticClass:"cm-title"},[e._v(e._s(n)+" "+e._s(Object.keys(e.csData)[n]))]),e._v(" "),e._l(t,function(n,s){return i("div",{key:s,staticClass:"cm-box"},[i("h3",{staticClass:"cm-node-name"},[e._v(e._s(s)+" "+e._s(Object.keys(t)[s]))]),e._v(" "),i("table",[e._m(0,!0),e._v(" "),i("tbody",e._l(n,function(t,n){return i("tr",[i("td",[e._v(e._s(t.subComponentNameTxt||t.subComponentName))]),e._v(" "),"running"==t.status?i("td",[e._m(1,!0)]):i("td",[e._m(2,!0),e._v(" "),i("div",{staticClass:"error-status"},[e._v(e._s(t.status))])]),e._v(" "),"shadow"==t.subComponentName||"keepalived"==t.subComponentName?i("td"):i("td",[i("el-switch",{attrs:{"active-color":"#34a01f","inactive-color":"#dcdfe6"},on:{change:function(i){e.daemonChange(t)}},model:{value:t.enableDaemon,callback:function(i){e.$set(t,"enableDaemon",i)},expression:"item2.enableDaemon"}})],1),e._v(" "),i("td",[i("el-switch",{attrs:{"active-color":"#34a01f","inactive-color":"#dcdfe6"},on:{change:function(i){e.daemonChange(t)}},model:{value:t.enableNotification,callback:function(i){e.$set(t,"enableNotification",i)},expression:"item2.enableNotification"}})],1),e._v(" "),i("td",{staticStyle:{"font-size":"12px"}},[i("a",{attrs:{href:"javascript:;"},on:{click:function(i){e.viewrec(t)}}},[e._v("编辑查看")])])])}))])])})],2)}),e._v(" "),i("editrec",{attrs:{isShow2:e.isshow2,data:e.pdata2},on:{setClose:function(t){e.isshow2=!1,e.pdata2={}},updateRec:e.getCStatusList}})],2)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",{staticStyle:{"min-width":"200px"}},[this._v("子组件名称")]),this._v(" "),t("th",[this._v("状态")]),this._v(" "),t("th",{staticStyle:{width:"100px"}},[this._v("监控守护进程")]),this._v(" "),t("th",{staticStyle:{width:"100px"}},[this._v("开启邮件通知")]),this._v(" "),t("th",{staticStyle:{width:"100px"}},[this._v("收件人")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"lds-grid"},[t("div",{staticClass:"green"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"lds-grid"},[t("div",{staticClass:"red"})])}]};var m=i("VU/8")(r,l,!1,function(e){i("MPoo")},"data-v-4cbc29d6",null);t.default=m.exports},MPoo:function(e,t){}});
//# sourceMappingURL=37.13fa4c4bbb0a9e9dd250.js.map