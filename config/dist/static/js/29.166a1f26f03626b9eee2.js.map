{"version":3,"sources":["webpack:///src/components/behavior/behaviortime.vue","webpack:///./src/components/behavior/behaviortime.vue?f5a4","webpack:///./src/components/behavior/behaviortime.vue"],"names":["behaviortime","required","message","this","$t","trigger","pattern","domain","_this","_this2","multiple","counts","starttime","endtime","sttime","edtime","dateTimeLong","Date","fromTime","endTime","domainVal","urlVal","then","res","buckets","key","doc_count","value","itemObj","resultArr","h","label","timingTaskPop","behavior_behaviortime","render","_vm","_h","$createElement","_c","_self","staticClass","_v","_s","ref","staticStyle","padding-bottom","attrs","model","behaviorform","rules","behaviorformRules","label-width","gutter","span","prop","width","placeholder","loading","$store","state","getEsDomainArrLoading","on","visible-change","$event","getDomains","callback","$$v","$set","expression","_l","item","clearable","getEsUrlArrLoading","getUrls","type","icon","click","getTokenTimeData","data","queryTimeData","props","queryTimeTreeProps","render-content","queryTimeRenderContent","isShowTimingTask","isShow","myTaskType","myTaskTypeTxt","setTimingTaskClose","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/29.166a1f26f03626b9eee2.js","sourcesContent":["<template>\r\n  <div class=\"behavior-wrapper\">\r\n    <h2 class=\"breadcrumb\">{{$t('lg.jiyushijiang')}}</h2>\r\n    <el-form class=\"form-bg\" style=\"padding-bottom:0\" ref=\"behaviorform\" :model=\"behaviorform\" :rules=\"behaviorformRules\"  label-width=\"0\">\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"8\">\r\n          <div class=\"grid-content\">\r\n            <el-form-item prop=\"domain\">\r\n              <el-select v-model=\"behaviorform.domain\" :placeholder=\"$t('lg.selectdomain')\" @visible-change=\"getDomains($event)\" style=\"width:100%\" :loading=\"$store.state.getEsDomainArrLoading\">\r\n                <template v-for=\"item in $store.state.esDomainArr\">\r\n                  <el-option :key=\"item.key\" :label=\"item.key\" :value=\"item.key\"></el-option>\r\n                </template>\r\n              </el-select>\r\n              <!-- <el-input v-model.trim=\"behaviorform.domain\" style=\"width:100%\" :placeholder=\"$t('lg.inputdomain')\"></el-input> -->\r\n            </el-form-item>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <div class=\"grid-content\">\r\n            <el-form-item prop=\"url\">\r\n              <el-select v-model=\"behaviorform.url\" :placeholder=\"$t('lg.selecturl')\" style=\"width:100%\" clearable @visible-change=\"getUrls($event)\" :loading=\"$store.state.getEsUrlArrLoading\">\r\n                <template v-for=\"item in $store.state.esUrlArr\">\r\n                  <el-option :key=\"item.key\" :label=\"item.key\" :value=\"item.key\"></el-option>\r\n                </template>\r\n              </el-select>\r\n            </el-form-item>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <div class=\"grid-content\">\r\n              <el-form-item prop=\"multiple\">\r\n                <el-input v-model=\"behaviorform.multiple\" :placeholder=\"$t('lg.timefactor')\" style=\"width:100%\"></el-input>\r\n              </el-form-item>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <div class=\"grid-content\">\r\n              <el-form-item prop=\"counts\">\r\n                <el-input v-model=\"behaviorform.counts\" :placeholder=\"$t('lg.counts')\" style=\"width:100%\"></el-input>\r\n              </el-form-item>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <div class=\"grid-content\">\r\n            <el-button type=\"primary\" style=\"width:100%\" @click=\"getTokenTimeData\" icon=\"el-icon-search\">{{$t('lg.query')}}</el-button>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n    </el-form>\r\n    \r\n    <!-- 查询结果数据展示 -->\r\n    <div class=\"myTreeBox\">\r\n      <el-tree\r\n        :data=\"queryTimeData\"\r\n        :props=\"queryTimeTreeProps\"\r\n        ref=\"tree\"\r\n        :render-content=\"queryTimeRenderContent\"><!-- show-checkbox -->\r\n      </el-tree>\r\n    </div>\r\n\r\n    <div class=\"text-right\">\r\n      <el-button type=\"success\" icon=\"el-icon-time\" @click=\"isShowTimingTask=true\">{{$t('lg.arrangealerting')}}</el-button>\r\n    </div>\r\n    <timing-task-pop :isShow=\"isShowTimingTask\" :myTaskType=\"'tokenTime'\" :myTaskTypeTxt=\"$t('lg.tokentimebased')\" @setTimingTaskClose=\"isShowTimingTask=false\"></timing-task-pop>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from 'axios';\r\nimport * as types from '@/store/types';\r\nimport client from \"@/components/es/connection\";\r\n// import toSddate from '@/assets/js/tosddate';\r\nimport toISO8601 from '@/assets/js/iso8601';\r\nimport {SERVER_API_URL} from '@/conf/constvar';\r\nimport timingTaskPop from '@/components/alarmTask/timingTaskPop';\r\nexport default {\r\n  data(){\r\n    return{\r\n      behaviorform:{\r\n        domain:'',\r\n        url:'',\r\n        multiple:'',\r\n        counts:'',\r\n        // domainArr:[],\r\n        // urlArr:[],\r\n      },\r\n      behaviorformRules:{\r\n        domain: [\r\n          {required: true, message: this.$t('lg.inputdomain'), trigger: 'blur'}\r\n        ],\r\n        url: [\r\n          // {required: true, message: this.$t('lg.selectarea'), trigger: 'blur'}\r\n        ],\r\n        multiple:[\r\n          {required: true, message: this.$t('lg.inputtimefactor'), trigger: 'blur'},\r\n          {pattern:/^[0-9]+$/,message: this.$t('lg.requirepositive'), trigger: 'change'}\r\n        ],\r\n        counts:[\r\n          {required: true, message: this.$t('lg.inputcounts'), trigger: 'blur'},\r\n          {pattern:/^[0-9]+$/,message:this.$t('lg.requirepositive'), trigger: 'change'}\r\n        ]\r\n      },\r\n\r\n      queryTimeData:[],\r\n      queryTimeTreeProps:{\r\n        children: 'children',\r\n        label: 'label'\r\n      },\r\n\r\n      isShowTimingTask:false,\r\n    }\r\n  },\r\n  methods:{\r\n    getDomains(callback){//获取域名数据\r\n      if(callback){\r\n        this.behaviorform.domain=\"\";\r\n        this.behaviorform.url=\"\";\r\n        this.$store.commit(types.GETESDOMAINS,true);\r\n      }\r\n    },\r\n   // getGEOIP(callback){//获取区域数据\r\n    //   // console.log(callback)\r\n    //   if(callback){\r\n    //     var _this=this;\r\n    //     var sttime=_this.$store.state.mydatedata.starttime,\r\n    //         edtime=_this.$store.state.mydatedata.endtime;\r\n    //     var fromTime2=toISO8601(sttime),\r\n    //         endTime2=toISO8601(edtime);\r\n    //     var fromTime=fromTime2 || toISO8601(new Date(Date.now()-_this.$store.state.dateTimeLong)),\r\n    //         endTime=endTime2 || toISO8601(new Date());\r\n    //     var domainVal = _this.behaviorform.domain;\r\n    //       _this.behaviorform.geoip=\"\";\r\n    //     client.search({\r\n    //       index:\"shadow-filebeat*\",\r\n    //       body:{\r\n    //         \"size\": 0,\r\n    //         \"query\": {\r\n    //           \"bool\": {\r\n    //             \"must\": [\r\n    //               {\r\n    //                 \"query_string\": {\r\n    //                   \"query\": \"shadow.access.error_code:0\"\r\n    //                 }\r\n    //               },\r\n    //               {\r\n    //                 \"query_string\": {\r\n    //                   \"query\": \"shadow.access.decrypted:1\"\r\n    //                 }\r\n    //               },\r\n    //               {\r\n    //                 \"term\": {\r\n    //                   \"shadow.access.domain\": domainVal\r\n    //                 }\r\n    //               },\r\n    //               {\r\n    //                 \"range\": {\r\n    //                   \"@timestamp\": {\r\n    //                     \"gte\": fromTime,\r\n    //                     \"lte\": endTime,\r\n    //                   }\r\n    //                 }\r\n    //               }\r\n    //             ],\r\n    //             \"must_not\": [\r\n    //               {\r\n    //                 \"match\": {\r\n    //                   \"shadow.access.token\": \"00000000000000000000000000000000\"\r\n    //                 }\r\n    //               },{\r\n    //                 \"match\": {\r\n    //                   \"shadow.access.token\":\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"\r\n    //                 }\r\n    //               }\r\n    //             ]\r\n    //           }\r\n    //         },\r\n    //         \"aggs\": {\r\n    //           \"geo\": {\r\n    //             \"terms\": {\r\n    //               \"script\": {\r\n    //                 \"inline\": \"params._source.shadow.access.geoip\",\r\n    //                 \"lang\": \"painless\"\r\n    //               },\r\n    //               \"size\": 100\r\n    //             },\r\n    //             \"aggs\": {\r\n    //               \"geoip\": {\r\n    //                 \"scripted_metric\": {\r\n    //                   \"init_script\": \"params._agg.geoip = []\",\r\n    //                   \"map_script\": \"params._agg.geoip.add(params._source.shadow.access.geoip)\",\r\n    //                   \"combine_script\": \"ArrayList list=new ArrayList(); for (s in params._agg.geoip) { list.add(s); } return list\",\r\n    //                   \"reduce_script\": \"return params._aggs.get(0)\"\r\n    //                 }\r\n    //               }\r\n    //             }\r\n    //           }\r\n    //         }\r\n    //       }\r\n    //     }).then((res)=>{\r\n    //       // console.log(res);\r\n    //       var buckets=res.aggregations.geo.buckets;\r\n    //       var result=[];\r\n    //       for(var i=0;i<buckets.length;i++){\r\n    //         var dataI=buckets[i];\r\n    //         if(dataI.geoip.value[0].city_name){\r\n    //           result.push(dataI.geoip.value[0].city_name)\r\n    //         }\r\n    //       }\r\n    //       _this.behaviorform.urlArr=result;\r\n    //     });\r\n    //   }\r\n   // },\r\n    getUrls(callback){//获取url数据\r\n      if(callback){\r\n        this.behaviorform.url=\"\";\r\n        var domainVal = this.behaviorform.domain;\r\n        this.$store.commit(types.GETESURLS,{domain:domainVal,flag:true});\r\n      }\r\n    },\r\n    getTokenTimeData(){//查询\r\n      this.$refs['behaviorform'].validate((valid)=>{\r\n        if(valid){\r\n          var _this=this;\r\n          var domainVal=_this.behaviorform.domain,\r\n              urlVal=_this.behaviorform.url?'\\\"'+_this.behaviorform.url+'\\\"':'*',\r\n              multiple=_this.behaviorform.multiple,\r\n              counts=_this.behaviorform.counts;\r\n          var sttime=_this.$store.state.mydatedata.starttime,\r\n              edtime=_this.$store.state.mydatedata.endtime;\r\n          var fromTime2=toISO8601(sttime),\r\n              endTime2=toISO8601(edtime);\r\n          var fromTime=fromTime2 || toISO8601(new Date(Date.now()-_this.$store.state.dateTimeLong)),\r\n              endTime=endTime2 || toISO8601(new Date()); \r\n          _this.$store.state.contentLoading=true;\r\n          client.search({\r\n            index:\"shadow-filebeat*\",\r\n            body:{\r\n              \"size\": 0,\r\n              \"query\": {\r\n                \"bool\": {\r\n                  \"filter\":[\r\n                    {\r\n                      \"range\": {\r\n                        \"@timestamp\": {\r\n                          \"gte\": fromTime,\r\n                          \"lte\": endTime,\r\n                        }\r\n                      }\r\n                    }\r\n                  ],\r\n                  \"must\": [\r\n                    {\r\n                      \"query_string\": {\r\n                        \"query\": \"shadow.access.error_code:0\"\r\n                      }\r\n                    },\r\n                    {\r\n                      \"query_string\": {\r\n                        \"query\": \"shadow.access.response_code:200\"\r\n                      }\r\n                    },\r\n                    {\r\n                      \"bool\": {\r\n                        \"should\": [\r\n                          {\r\n                            \"query_string\": {\r\n                              \"query\": \"shadow.access.decrypted:1\"\r\n                            }\r\n                          },\r\n                          {\r\n                            \"query_string\": {\r\n                              \"query\": \"shadow.access.api_indicator:1\"\r\n                            }\r\n                          }\r\n                        ]\r\n                      }\r\n                    },\r\n                    {\r\n                      \"term\": {\r\n                        \"shadow.access.http_host\": domainVal\r\n                      }\r\n                    },\r\n                    {\r\n                      \"query_string\": {\r\n                        \"query\": \"shadow.access.org_url:\"+urlVal\r\n                      }\r\n                    }\r\n                  ],\r\n                  \"must_not\": [\r\n                    {\r\n                      \"match\": {\r\n                        \"shadow.access.token\": \"00000000000000000000000000000000\"\r\n                      }\r\n                    },{\r\n                      \"match\": {\r\n                        \"shadow.access.token\":\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"\r\n                      }\r\n                    }\r\n                  ]\r\n                }\r\n              },\r\n              \"aggs\": {\r\n                \"GroupByUrl\":{\r\n                  \"terms\": {\r\n                    \"field\": \"shadow.access.org_url\",\r\n                    \"size\": 500\r\n                  },\r\n                  \"aggs\": {\r\n                    \"GroupByToken\": {\r\n                      \"terms\": {\r\n                        \"field\": \"shadow.access.token\",\r\n                        \"size\": 500\r\n                      },\r\n                      \"aggs\": {\r\n                        \"avg_starttime\": {\r\n                          \"avg\": {\r\n                            \"field\": \"shadow.access.send_time\"\r\n                          }\r\n                        },\r\n                        \"avg_endtime\": {\r\n                          \"avg\": {\r\n                            \"field\": \"shadow.access.rec_time\"\r\n                          }\r\n                        },\r\n                        \"avg_time\": {\r\n                          \"bucket_script\": {\r\n                            \"buckets_path\": {\r\n                              \"avg_starttime\": \"avg_starttime\",\r\n                              \"avg_endtime\": \"avg_endtime\"\r\n                            },\r\n                            \"script\": \"params.avg_endtime-params.avg_starttime\"\r\n                          }\r\n                        },\r\n                        \"suspects\": {\r\n                          \"scripted_metric\": {\r\n                            \"init_script\": \"params._agg.suspects=[]\",\r\n                            \"map_script\": \"params._agg.suspects.add(Long.parseLong(params._source.shadow.access.rec_time)-Long.parseLong(params._source.shadow.access.send_time))\",\r\n                            \"combine_script\": \"ArrayList list=new ArrayList();for(s in params._agg.suspects){list.add(s);}return list\",\r\n                            \"reduce_script\": `double total_time=0;int length=0;for(a in params._aggs){for(i in a){total_time+=i;length+=1;}}double avg_time=total_time/length;int count=0;for(a in params._aggs){for(i in a){if(i>(avg_time*${multiple})){count+=1;}}}if(count>=${counts}){return count;}else{return null;}`\r\n                          }\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }).then((res)=>{\r\n            // console.log(res)\r\n            let resultArr=[];\r\n            const buckets=res.aggregations.GroupByUrl.buckets;\r\n            buckets.forEach(ele=>{\r\n              let itemObj={\r\n                    label:ele.key,\r\n                    children:[]\r\n                  };\r\n              const childrenObj=ele.GroupByToken.buckets;\r\n              childrenObj.forEach(val=>{\r\n                if(val.suspects.value){\r\n                  itemObj.children.push({\r\n                    label:val.key,\r\n                    counts:val.doc_count,\r\n                    avgTime:(val.avg_time.value/1000).toFixed(2),\r\n                    suspects:val.suspects.value\r\n                  })\r\n                }\r\n              })\r\n              if(itemObj.children.length>0){\r\n                resultArr.push(itemObj)\r\n              }\r\n            })\r\n\r\n            // console.log(resultArr)\r\n            _this.queryTimeData=resultArr;\r\n            _this.$store.state.contentLoading=false;\r\n\r\n          });\r\n        }\r\n      })\r\n    },\r\n    queryTimeRenderContent(h, { node, data, store }){//重新渲染 自定义节点内容 \r\n      if(data.children){\r\n        return (\r\n          <span class=\"my-tree-node\">\r\n            <span>{node.label}</span>\r\n          </span>\r\n        );\r\n      }else{\r\n        //  <div class=\"my-tree-node\">\r\n        //      <table>\r\n        //       <thead>\r\n        //         <tr>\r\n        //           <th>浏览器指纹</th>\r\n        //           <th>平均时间</th>\r\n        //           <th>次数</th>\r\n        //         </tr>\r\n        //       </thead>\r\n        //       <tbody>\r\n        //         <tr>\r\n        //           <td>{data.label}</td>\r\n        //           <td>{data.avgTime}</td>\r\n        //           <td>{data.counts}</td>\r\n        //         </tr>\r\n        //       </tbody>\r\n        //     </table>\r\n        //   </div>\r\n        return (\r\n          <p class=\"my-tree-node\">\r\n            <span>浏览器指纹：{node.label}，其平均访问时间为：{data.avgTime}秒，访问次数为：{data.counts}次</span>\r\n          </p>\r\n        );\r\n      }\r\n    }\r\n  },\r\n  components:{\r\n    timingTaskPop\r\n  }\r\n}\r\n</script>\r\n<style lang=\"stylus\">\r\n.behavior-wrapper\r\n  width 100%\r\n  height 100%\r\n  position relative\r\n  padding 15px\r\n  box-sizing border-box\r\n  display flex\r\n  flex-direction column\r\n  overflow hidden\r\n  .myTreeBox\r\n    flex 1\r\n    overflow-y auto\r\n    margin-bottom 10px\r\n    .my-tree-node\r\n      white-space normal\r\n      word-break break-all\r\n      margin 8px\r\n      line-height 20px\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/behavior/behaviortime.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"behavior-wrapper\"},[_c('h2',{staticClass:\"breadcrumb\"},[_vm._v(_vm._s(_vm.$t('lg.jiyushijiang')))]),_vm._v(\" \"),_c('el-form',{ref:\"behaviorform\",staticClass:\"form-bg\",staticStyle:{\"padding-bottom\":\"0\"},attrs:{\"model\":_vm.behaviorform,\"rules\":_vm.behaviorformRules,\"label-width\":\"0\"}},[_c('el-row',{attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":8}},[_c('div',{staticClass:\"grid-content\"},[_c('el-form-item',{attrs:{\"prop\":\"domain\"}},[_c('el-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":_vm.$t('lg.selectdomain'),\"loading\":_vm.$store.state.getEsDomainArrLoading},on:{\"visible-change\":function($event){_vm.getDomains($event)}},model:{value:(_vm.behaviorform.domain),callback:function ($$v) {_vm.$set(_vm.behaviorform, \"domain\", $$v)},expression:\"behaviorform.domain\"}},[_vm._l((_vm.$store.state.esDomainArr),function(item){return [_c('el-option',{key:item.key,attrs:{\"label\":item.key,\"value\":item.key}})]})],2)],1)],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":4}},[_c('div',{staticClass:\"grid-content\"},[_c('el-form-item',{attrs:{\"prop\":\"url\"}},[_c('el-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":_vm.$t('lg.selecturl'),\"clearable\":\"\",\"loading\":_vm.$store.state.getEsUrlArrLoading},on:{\"visible-change\":function($event){_vm.getUrls($event)}},model:{value:(_vm.behaviorform.url),callback:function ($$v) {_vm.$set(_vm.behaviorform, \"url\", $$v)},expression:\"behaviorform.url\"}},[_vm._l((_vm.$store.state.esUrlArr),function(item){return [_c('el-option',{key:item.key,attrs:{\"label\":item.key,\"value\":item.key}})]})],2)],1)],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":4}},[_c('div',{staticClass:\"grid-content\"},[_c('el-form-item',{attrs:{\"prop\":\"multiple\"}},[_c('el-input',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":_vm.$t('lg.timefactor')},model:{value:(_vm.behaviorform.multiple),callback:function ($$v) {_vm.$set(_vm.behaviorform, \"multiple\", $$v)},expression:\"behaviorform.multiple\"}})],1)],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":4}},[_c('div',{staticClass:\"grid-content\"},[_c('el-form-item',{attrs:{\"prop\":\"counts\"}},[_c('el-input',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":_vm.$t('lg.counts')},model:{value:(_vm.behaviorform.counts),callback:function ($$v) {_vm.$set(_vm.behaviorform, \"counts\", $$v)},expression:\"behaviorform.counts\"}})],1)],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":4}},[_c('div',{staticClass:\"grid-content\"},[_c('el-button',{staticStyle:{\"width\":\"100%\"},attrs:{\"type\":\"primary\",\"icon\":\"el-icon-search\"},on:{\"click\":_vm.getTokenTimeData}},[_vm._v(_vm._s(_vm.$t('lg.query')))])],1)])],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"myTreeBox\"},[_c('el-tree',{ref:\"tree\",attrs:{\"data\":_vm.queryTimeData,\"props\":_vm.queryTimeTreeProps,\"render-content\":_vm.queryTimeRenderContent}})],1),_vm._v(\" \"),_c('div',{staticClass:\"text-right\"},[_c('el-button',{attrs:{\"type\":\"success\",\"icon\":\"el-icon-time\"},on:{\"click\":function($event){_vm.isShowTimingTask=true}}},[_vm._v(_vm._s(_vm.$t('lg.arrangealerting')))])],1),_vm._v(\" \"),_c('timing-task-pop',{attrs:{\"isShow\":_vm.isShowTimingTask,\"myTaskType\":'tokenTime',\"myTaskTypeTxt\":_vm.$t('lg.tokentimebased')},on:{\"setTimingTaskClose\":function($event){_vm.isShowTimingTask=false}}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-a2ed3db4\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/behavior/behaviortime.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-a2ed3db4\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./behaviortime.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./behaviortime.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./behaviortime.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-a2ed3db4\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./behaviortime.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/behavior/behaviortime.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}