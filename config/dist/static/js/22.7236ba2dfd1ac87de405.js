webpackJsonp([22],{"8xA7":function(t,e){},O7F6:function(t,e){},XCpJ:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s("mtWM"),i=s.n(o),n=s("qqiS"),a=s("yJCr"),l=(s("xrTZ").Base64,{props:{isShow:{type:Boolean},isAddTk:{type:Boolean}},data:function(){return{locationLoading:!1,bwpopform:{tokenList:[{token:"",keep:!1}]},nodesdata:[],getNodesLoading:!1,oldOptions:[{}],bwpopformRules:{token:[{required:!0,message:"不能为空",trigger:"blur"},{min:32,max:32,message:"长度应该为 32 个字符",trigger:"blur"},{pattern:/^([0-9|a-f|A-F]*)$/,message:"TOKEN格式应为：数字0-9或字母a-f、A-F组成的32位字符",trigger:"change"}]}}},methods:{delToken:function(t){1!=this.bwpopform.tokenList.length&&this.bwpopform.tokenList.splice(t,1)},addToken:function(){this.bwpopform.tokenList.push({token:"",keep:!1})},bwclose:function(){this.$refs.bwpopform.resetFields(),this.bwpopform.tokenList=[{token:"",keep:!1}],this.$emit("bwclose",!1)},addBlackTk:function(t){var e=this,s=this,o=a.b+"pe/shadow/token/blacklist",n=[];s.bwpopform.tokenList.forEach(function(t){n.push({token:t.token,source:["ui"],keep:t.keep?"N":"Y"})}),s.$refs[t].validate(function(t){t&&(s.locationLoading=!0,i.a.post(o,{tokenBlacklistList:n}).then(function(t){if(0==t.data.responseCode)e.$message({type:"success",message:"操作成功"}),s.$emit("getBwlist"),s.bwclose();else{var o=t.data.data,i=s.handleMsg(o);s.$message.error("操作失败: "+i)}s.locationLoading=!1}).catch(function(t){console.log(t)}))})},handleMsg:function(t){var e="";return t.forEach(function(t){for(var s in t)e+=s+":"+t[s].data.message+";"}),e}},components:{loading:n.a}}),c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-dialog",{attrs:{width:"40%",title:t.$t("lg.addblacklist"),visible:t.isShow,"close-on-click-modal":!1,"before-close":t.bwclose},on:{"update:visible":function(e){t.isShow=e}}},[s("el-form",{ref:"bwpopform",attrs:{model:t.bwpopform,rules:t.bwpopformRules,"label-width":"90px"}},[s("div",{staticStyle:{position:"relative"}},[t._l(t.bwpopform.tokenList,function(e,o){return s("div",{key:o,staticClass:"orderBoxJamb"},[s("span",{directives:[{name:"show",rawName:"v-show",value:t.isAddTk,expression:"isAddTk"}],staticClass:"delTk",on:{click:function(e){t.delToken(o)}}},[s("i",{staticClass:"el-icon-close"})]),t._v(" "),s("el-form-item",{attrs:{label:"是否被覆盖"}},[s("el-switch",{model:{value:e.keep,callback:function(s){t.$set(e,"keep",s)},expression:"item.keep"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"TOKEN",prop:"tokenList."+o+".token",rules:t.bwpopformRules.token}},[s("el-input",{attrs:{type:"text"},model:{value:e.token,callback:function(s){t.$set(e,"token","string"==typeof s?s.trim():s)},expression:"item.token"}})],1)],1)}),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.isAddTk,expression:"isAddTk"}],staticClass:"addTk",attrs:{title:t.$t("lg.addmoreinternalbs")},on:{click:t.addToken}},[s("i",{staticClass:"el-icon-circle-plus-outline"})])],2),t._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addBlackTk("bwpopform")}}},[t._v(t._s(t.isAddTk?t.$t("lg.add"):"确认"))]),t._v(" "),s("el-button",{on:{click:function(e){t.bwclose()}}},[t._v(t._s(t.$t("lg.cancel")))])],1)],1),t._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:t.locationLoading,expression:"locationLoading"}],attrs:{title:"数据处理中..."}})],1)],1)},staticRenderFns:[]};var r={data:function(){return{detailLoading:!1,bwlist:[],isShowBwpop:!1,isAddTk:!0,editTkItem:{}}},created:function(){this.$store.state.contentLoading=!0,this.getBwlist()},mounted:function(){var t=this;this.$on("updateBwlist",function(){t.getBwlist()})},methods:{getBwlist:function(){var t=this,e=a.b+"pe/shadow/token/blacklist";i.a.get(e).then(function(e){if(0==e.data.responseCode){var s=e.data.data;s.forEach(function(t){t.keepSwitch="N"==t.keep}),t.bwlist=s}else t.$message.error("操作失败:"+e.data.data.message);t.$store.state.contentLoading=!1}).catch(function(t){console.log(t)})},addBwToken:function(){this.isShowBwpop=!0},editBlackTk:function(t){var e=this;e.$store.state.contentLoading=!0;var s=a.b+"pe/shadow/token/blacklist",o=[{token:t.token,source:t.source,keep:t.keepSwitch?"N":"Y"}];i.a.patch(s,{tokenBlacklistList:o}).then(function(t){if(0==t.data.responseCode)e.$message({type:"success",message:"操作成功"});else{var s=t.data.data,o=e.handleMsg(s);e.$message.error("操作失败: "+o)}e.getBwlist()}).catch(function(t){console.log(t)})},del:function(t){var e=this,s=a.b+"pe/shadow/token/blacklist";this.$store.state.contentLoading=!0,i.a.delete(s,{data:{tokenBlacklistList:[{token:t.token}]}}).then(function(t){if(0==t.data.responseCode)e.$message({type:"success",message:"操作成功"}),e.$emit("updateBwlist");else{var s=t.data.data,o=e.handleMsg(s);e.$message.error("操作失败: "+o)}e.$store.state.contentLoading=!1}).catch(function(t){console.log(t)})},handleMsg:function(t){var e="";return t.forEach(function(t){for(var s in t)e+=s+":"+t[s].data.message+";"}),e}},components:{bwpop:s("VU/8")(l,c,!1,function(t){s("8xA7")},"data-v-4b1517b2",null).exports}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bwlist-wrapper"},[s("h2",{staticClass:"breadcrumb"},[t._v(t._s(t.$t("lg.zwHeimingdan")))]),t._v(" "),s("div",{staticClass:"btn-bg"},[s("el-button",{attrs:{type:"primary"},on:{click:t.addBwToken}},[t._v(t._s(t.$t("lg.add")))])],1),t._v(" "),0==t.bwlist.length?s("div",{staticClass:"nodata-box"},[t._v(t._s(t.$t("lg.nodata")))]):t._e(),t._v(" "),s("div",{staticClass:"bwlist-table"},[t.bwlist.length>0?s("table",[t._m(0),t._v(" "),s("tbody",t._l(t.bwlist,function(e){return s("tr",[s("td",[t._v(t._s(e.token))]),t._v(" "),s("td",t._l(e.source,function(e){return s("p",{staticClass:"pArrTxt"},[t._v(t._s("ui"===e?"手动添加":"被报警任务："+e+" 扫描发现"))])})),t._v(" "),s("td",[s("el-switch",{on:{change:function(s){t.editBlackTk(e)}},model:{value:e.keepSwitch,callback:function(s){t.$set(e,"keepSwitch",s)},expression:"item.keepSwitch"}})],1),t._v(" "),s("td",{staticClass:"text-center"},[s("a",{staticClass:"edit-del-a",attrs:{href:"javascript:;"},on:{click:function(s){t.del(e)}}},[s("i",{staticClass:"el-icon-close"}),t._v(t._s(t.$t("lg.delete")))])])])}))]):t._e()]),t._v(" "),s("bwpop",{attrs:{isShow:t.isShowBwpop,isAddTk:t.isAddTk,editTkItem:t.editTkItem},on:{bwclose:function(e){t.isShowBwpop=!1,t.editTkItem={}},getBwlist:t.getBwlist}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("TOKEN")]),this._v(" "),e("th",[this._v("来源方式")]),this._v(" "),e("th",[this._v("TOKEN是否会被覆盖")]),this._v(" "),e("th",{attrs:{width:"100"}})])])}]};var p=s("VU/8")(r,d,!1,function(t){s("O7F6")},"data-v-c0096ee0",null);e.default=p.exports}});
//# sourceMappingURL=22.7236ba2dfd1ac87de405.js.map