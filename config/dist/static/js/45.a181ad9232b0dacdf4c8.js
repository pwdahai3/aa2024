webpackJsonp([45],{enXc:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mtWM"),o=a.n(s),r=a("qqiS"),d=a("yJCr"),n=(a("xrTZ").Base64,{props:{isShow:{type:Boolean}},data:function(){return{userloading:!1,addform:{server:"",typeOptions:["prefer","iburst"],type:"prefer"},addformRules:{server:[{required:!0,message:this.$t("lg.required"),trigger:"blur"}]}}},methods:{addNtp:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=t.addform.server,s=t.addform.type,r=d.b+"pe/shadow/ntpConf/add",n={newServer:a,newType:s};t.userloading=!0,o.a.put(r,n).then(function(e){0==e.data.responseCode?(t.$emit("hasadduser"),t.$message({type:"success",message:t.$t("lg.success")}),t.resetForm()):t.$message.error(t.$t("lg.failed")),t.userloading=!1}).catch(function(e){t.$message.error(e.data),t.userloading=!1})}})},resetForm:function(){this.$refs.addform.resetFields(),this.$emit("addclose")}},components:{loading:r.a}}),i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{width:"40%",title:e.$t("lg.add"),visible:e.isShow,"close-on-click-modal":!1,"before-close":e.resetForm},on:{"update:visible":function(t){e.isShow=t}}},[a("el-form",{ref:"addform",attrs:{model:e.addform,rules:e.addformRules,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"时间服务器IP",prop:"server"}},[a("el-input",{model:{value:e.addform.server,callback:function(t){e.$set(e.addform,"server","string"==typeof t?t.trim():t)},expression:"addform.server"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addform.type,callback:function(t){e.$set(e.addform,"type",t)},expression:"addform.type"}},e._l(e.addform.typeOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addNtp("addform")}}},[e._v(e._s(e.$t("lg.add")))]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm()}}},[e._v(e._s(e.$t("lg.cancel")))])],1)],1),e._v(" "),a("loading",{directives:[{name:"show",rawName:"v-show",value:e.userloading,expression:"userloading"}],attrs:{title:e.$t("lg.loading")}})],1)],1)},staticRenderFns:[]},l=a("VU/8")(n,i,!1,null,null,null).exports,c=a("mvHQ"),u=a.n(c),p=(a("xrTZ").Base64,{props:{editShow:{type:Boolean},ntpData:{type:Object},allData:{type:Array},editindex:{type:Number}},watch:{editShow:function(){this.addform.server=this.ntpData.server,this.addform.type=this.ntpData.type,this.editOriginData0=u()(this.allData)}},data:function(){return{userloading:!1,addform:{server:"",typeOptions:["prefer","iburst"],type:""},editOriginData0:"",editOriginData1:"",addformRules:{server:[{required:!0,message:this.$t("lg.required"),trigger:"blur"}]}}},methods:{saveNtp:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=[],s=void 0,r=void 0;JSON.parse(t.editOriginData0).forEach(function(e){s=e.server,r=e.type,a.push({newServer:s,newType:r,oldServer:s,oldType:r})}),t.editOriginData1=a;var n=t.addform.server,i=t.addform.type,l=d.b+"pe/shadow/ntpConf/post";t.editOriginData1[t.editindex]={newServer:n,newType:i,oldServer:t.editOriginData1[t.editindex].oldServer,oldType:t.editOriginData1[t.editindex].oldType},t.userloading=!0,o.a.post(l,t.editOriginData1).then(function(e){0==e.data.responseCode?(t.$emit("hasadduser"),t.$message({type:"success",message:t.$t("lg.success")}),t.resetForm()):t.$message.error(t.$t("lg.failed")),t.userloading=!1}).catch(function(e){t.$message.error(e.data),t.userloading=!1})}})},resetForm:function(){this.$refs.addform.resetFields(),this.$emit("eidtclose")}},components:{loading:r.a}}),h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{width:"40%",title:"修改",visible:e.editShow,"close-on-click-modal":!1,"before-close":e.resetForm},on:{"update:visible":function(t){e.editShow=t}}},[a("el-form",{ref:"addform",attrs:{model:e.addform,rules:e.addformRules,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"时间服务器IP",prop:"server"}},[a("el-input",{model:{value:e.addform.server,callback:function(t){e.$set(e.addform,"server","string"==typeof t?t.trim():t)},expression:"addform.server"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addform.type,callback:function(t){e.$set(e.addform,"type",t)},expression:"addform.type"}},e._l(e.addform.typeOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveNtp("addform")}}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm()}}},[e._v(e._s(e.$t("lg.cancel")))])],1)],1),e._v(" "),a("loading",{directives:[{name:"show",rawName:"v-show",value:e.userloading,expression:"userloading"}],attrs:{title:e.$t("lg.loading")}})],1)],1)},staticRenderFns:[]},f=a("VU/8")(p,h,!1,null,null,null).exports,m=(a("xrTZ").Base64,{props:{isShow:{type:Boolean},shadownode:{type:String}},data:function(){return{userloading:!1,addform:{server:"",typeOptions:["prefer","iburst"],type:"prefer"},addformRules:{server:[{required:!0,message:this.$t("lg.required"),trigger:"blur"}]}}},methods:{addNtp:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=t.addform.server,s=t.addform.type,r=d.b+"pe/shadow/ntpConf/add/"+t.shadownode,n={newServer:a,newType:s};t.userloading=!0,o.a.put(r,n).then(function(e){0==e.data.responseCode?(t.$emit("hasaddshadow"),t.$message({type:"success",message:t.$t("lg.success")}),t.resetForm()):t.$message.error(t.$t("lg.failed")),t.userloading=!1}).catch(function(e){t.$message.error(e.data),t.userloading=!1})}})},resetForm:function(){this.$refs.addform.resetFields(),this.$emit("addclose")}},components:{loading:r.a}}),v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{width:"40%",title:"增加",visible:e.isShow,"close-on-click-modal":!1,"before-close":e.resetForm},on:{"update:visible":function(t){e.isShow=t}}},[a("el-form",{ref:"addform",attrs:{model:e.addform,rules:e.addformRules,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"时间服务器IP",prop:"server"}},[a("el-input",{model:{value:e.addform.server,callback:function(t){e.$set(e.addform,"server","string"==typeof t?t.trim():t)},expression:"addform.server"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addform.type,callback:function(t){e.$set(e.addform,"type",t)},expression:"addform.type"}},e._l(e.addform.typeOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addNtp("addform")}}},[e._v(e._s(e.$t("lg.add")))]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm()}}},[e._v(e._s(e.$t("lg.cancel")))])],1)],1),e._v(" "),a("loading",{directives:[{name:"show",rawName:"v-show",value:e.userloading,expression:"userloading"}],attrs:{title:e.$t("lg.loading")}})],1)],1)},staticRenderFns:[]},g=a("VU/8")(m,v,!1,null,null,null).exports,w=(a("xrTZ").Base64,{props:{editShow:{type:Boolean},ntpData:{type:Object},allData:{type:Array},editindex:{type:Number},shadownode:{type:String}},watch:{editShow:function(){this.addform.server=this.ntpData.server,this.addform.type=this.ntpData.type,this.editOriginData0=u()(this.allData)}},data:function(){return{userloading:!1,addform:{server:"",typeOptions:["prefer","iburst"],type:""},editOriginData0:"",editOriginData1:"",addformRules:{server:[{required:!0,message:this.$t("lg.required"),trigger:"blur"}]}}},methods:{saveNtp:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=[],s=void 0,r=void 0;JSON.parse(t.editOriginData0).forEach(function(e){s=e.server,r=e.type,a.push({newServer:s,newType:r,oldServer:s,oldType:r})}),t.editOriginData1=a;var n=t.addform.server,i=t.addform.type,l=d.b+"pe/shadow/ntpConf/post/"+t.shadownode;t.editOriginData1[t.editindex]={newServer:n,newType:i,oldServer:t.editOriginData1[t.editindex].oldServer,oldType:t.editOriginData1[t.editindex].oldType},t.userloading=!0,o.a.post(l,t.editOriginData1).then(function(e){0==e.data.responseCode?(t.$emit("haseditshadow"),t.$message({type:"success",message:t.$t("lg.success")}),t.resetForm()):t.$message.error(t.$t("lg.failed")),t.userloading=!1}).catch(function(e){t.$message.error(e.data),t.userloading=!1})}})},resetForm:function(){this.$refs.addform.resetFields(),this.$emit("eidtclose")}},components:{loading:r.a}}),y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{width:"40%",title:"修改",visible:e.editShow,"close-on-click-modal":!1,"before-close":e.resetForm},on:{"update:visible":function(t){e.editShow=t}}},[a("el-form",{ref:"addform",attrs:{model:e.addform,rules:e.addformRules,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"时间服务器IP",prop:"server"}},[a("el-input",{model:{value:e.addform.server,callback:function(t){e.$set(e.addform,"server","string"==typeof t?t.trim():t)},expression:"addform.server"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addform.type,callback:function(t){e.$set(e.addform,"type",t)},expression:"addform.type"}},e._l(e.addform.typeOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveNtp("addform")}}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm()}}},[e._v(e._s(e.$t("lg.cancel")))])],1)],1),e._v(" "),a("loading",{directives:[{name:"show",rawName:"v-show",value:e.userloading,expression:"userloading"}],attrs:{title:e.$t("lg.loading")}})],1)],1)},staticRenderFns:[]},$=a("VU/8")(w,y,!1,null,null,null).exports,_={components:{ntpadd:l,ntpedit:f,loading:r.a,shadowntpadd:g,shadowntpedit:$},created:function(){this.$store.state.contentLoading=!0,this.getCmNtp()},data:function(){return{tabActiveName:"CM",shadownodeVal:"",shadownodeOpts:[],shadownodeData:[],users:[],addShow:!1,shadowaddShow:!1,editShow:!1,ntpData:{},editIndex:0,shadoweditShow:!1,shadowntpData:{},shadoweditIndex:0,distributeDomainShow:!1,currentUser:"",isShowUsDialog:!1,needPostRequest:!1,userSettingform:{pwInterval:null},userSettingformRules:{pwInterval:[{required:!0,message:this.$t("lg.required"),trigger:"blur"},{pattern:/^[1-9]\d*$/,message:"必须为大于0的整数数值",trigger:"change"}]},userSetingloading:!1}},methods:{handleClick:function(e,t){this.getShadownode(),this.getShadownodeData()},getShadownodeData:function(e){var t=this;e=e||this.shadownodeVal;var a=d.b+"pe/shadow/ntpConf/get/"+e;o.a.get(a).then(function(e){if(200==e.status){var a=e.data.data;t.shadownodeData=a,t.$store.state.contentLoading=!1}}).catch(function(e){console.log(e)})},getShadownode:function(){var e=this,t=d.b+"pe/shadow/nodeId/all";o.a.get(t).then(function(t){if(200==t.status){var a=t.data.data;e.shadownodeOpts=a,e.shadownodeOpts.length>0&&(e.shadownodeVal=e.shadownodeOpts[0])}}).catch(function(e){console.log(e)})},getCmNtp:function(){var e=this,t=d.b+"pe/shadow/ntpConf/get";o.a.get(t).then(function(t){if(200==t.status){var a=t.data.data;e.users=a,e.$store.state.contentLoading=!1}}).catch(function(e){console.log(e)})},addCM:function(){this.addShow=!0},addShadow:function(){this.shadownodeVal?this.shadowaddShow=!0:this.$message.error("请选择shadow节点!")},editNtp:function(e,t){this.editIndex=t,this.ntpData=e,this.editShow=!0},shadoweditNtp:function(e,t){this.shadoweditIndex=t,this.shadowntpData=e,this.shadoweditShow=!0},delNtp:function(e){var t=this;this.$confirm("确认删除？",this.$t("lg.tip"),{confirmButtonText:this.$t("lg.yes"),cancelButtonText:this.$t("lg.cancel"),type:"warning"}).then(function(){t.$store.state.contentLoading=!0;var a=d.b+"pe/shadow/ntpConf/delete";o.a.delete(a,{data:{oldServer:e.server,oldType:e.type}}).then(function(e){0==e.data.responseCode?(t.getCmNtp(),t.$message({type:"success",message:t.$t("lg.success")})):t.$message.error(t.$t("lg.failed")+": "+e.data.data.message),t.$store.state.contentLoading=!1}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:t.$t("lg.canceled")})})},shadowdelNtp:function(e){var t=this;this.$confirm("确认删除？",this.$t("lg.tip"),{confirmButtonText:this.$t("lg.yes"),cancelButtonText:this.$t("lg.cancel"),type:"warning"}).then(function(){t.$store.state.contentLoading=!0;var a=d.b+"pe/shadow/ntpConf/delete/"+t.shadownodeVal;o.a.delete(a,{data:{oldServer:e.server,oldType:e.type}}).then(function(e){0==e.data.responseCode?(t.getShadownodeData(),t.$message({type:"success",message:t.$t("lg.success")})):t.$message.error(t.$t("lg.failed")+": "+e.data.data.message),t.$store.state.contentLoading=!1}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:t.$t("lg.canceled")})})},getIntervalPeriod:function(){var e=this,t=d.b+"pe/shadow/kv/uaaIntervalPeriod";o.a.get(t).then(function(t){if(0==t.data.responseCode){var a=t.data.data;e.needPostRequest=!a,e.userSettingform.pwInterval=a?a.value:90,e.isShowUsDialog=!0}else e.$message.error(e.$t("lg.failed")+": "+t.data.data.message)}).catch(function(e){console.log(e)})},setIntervalPeriod:function(){var e=this;this.$refs.userSettingform.validate(function(t){if(t){var a=d.b+"pe/shadow/kv",s=e.needPostRequest?"post":"patch";e.userSetingloading=!0,o.a[s](a,{uaaIntervalPeriod:e.userSettingform.pwInterval-0}).then(function(t){0==t.data.responseCode?(e.$message({type:"success",message:e.$t("lg.success")}),e.usDialogClose()):e.$message.error(e.$t("lg.failed")+": "+t.data.data.message),e.userSetingloading=!1}).catch(function(e){console.log(e)})}})},usDialogClose:function(){this.isShowUsDialog=!1},usDrawerClose:function(e){e()}}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"users-wrapper"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.tabActiveName,callback:function(t){e.tabActiveName=t},expression:"tabActiveName"}},[a("el-tab-pane",{attrs:{label:"CM",name:"CM"}},[a("div",{staticClass:"btn-bg"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addCM}},[e._v("增加")])],1),e._v(" "),a("div",{staticClass:"usersContent"},[0==e.users.length?a("p",{staticClass:"nodata-box"},[e._v(e._s(e.$t("lg.nodata")))]):e._e(),e._v(" "),e.users.length>0?a("table",[a("thead",[a("tr",[a("th",[e._v("时间服务器IP")]),e._v(" "),a("th",[e._v("类型")]),e._v(" "),a("th",{attrs:{width:"280"}})])]),e._v(" "),a("tbody",e._l(e.users,function(t,s){return a("tr",{key:s},[a("td",[e._v(e._s(t.server))]),e._v(" "),a("td",[e._v(" "+e._s(t.type))]),e._v(" "),a("td",{staticClass:"text-center"},[a("a",{staticClass:"edit-del-a",attrs:{href:"javascript:;"},on:{click:function(a){e.editNtp(t,s)}}},[a("i",{staticClass:"el-icon-edit"}),e._v(e._s(e.$t("lg.edit")))]),e._v(" "),a("a",{staticClass:"edit-del-a",attrs:{href:"javascript:;"},on:{click:function(a){e.delNtp(t)}}},[a("i",{staticClass:"el-icon-close"}),e._v(e._s(e.$t("lg.delete")))])])])}))]):e._e()])]),e._v(" "),a("el-tab-pane",{attrs:{label:"SHADOW",name:"SHADOW"}},[a("div",{staticStyle:{"margin-bottom":"12px"}},[a("el-select",{attrs:{placeholder:"请选择shadow节点"},on:{change:e.getShadownodeData},model:{value:e.shadownodeVal,callback:function(t){e.shadownodeVal=t},expression:"shadownodeVal"}},e._l(e.shadownodeOpts,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("div",{staticClass:"btn-bg"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addShadow}},[e._v("增加")])],1),e._v(" "),a("div",{staticClass:"usersContent"},[0==e.shadownodeData.length?a("p",{staticClass:"nodata-box"},[e._v(e._s(e.$t("lg.nodata")))]):e._e(),e._v(" "),e.shadownodeData.length>0?a("table",[a("thead",[a("tr",[a("th",[e._v("时间服务器IP")]),e._v(" "),a("th",[e._v("类型")]),e._v(" "),a("th",{attrs:{width:"280"}})])]),e._v(" "),a("tbody",e._l(e.shadownodeData,function(t,s){return a("tr",{key:s},[a("td",[e._v(e._s(t.server))]),e._v(" "),a("td",[e._v(" "+e._s(t.type))]),e._v(" "),a("td",{staticClass:"text-center"},[a("a",{staticClass:"edit-del-a",attrs:{href:"javascript:;"},on:{click:function(a){e.shadoweditNtp(t,s)}}},[a("i",{staticClass:"el-icon-edit"}),e._v(e._s(e.$t("lg.edit")))]),e._v(" "),a("a",{staticClass:"edit-del-a",attrs:{href:"javascript:;"},on:{click:function(a){e.shadowdelNtp(t)}}},[a("i",{staticClass:"el-icon-close"}),e._v(e._s(e.$t("lg.delete")))])])])}))]):e._e()])])],1),e._v(" "),a("ntpadd",{attrs:{isShow:e.addShow},on:{addclose:function(t){e.addShow=!1},hasadduser:e.getCmNtp}}),e._v(" "),a("ntpedit",{attrs:{editShow:e.editShow,allData:e.users,ntpData:e.ntpData,editindex:e.editIndex},on:{eidtclose:function(t){e.editShow=!1},hasadduser:e.getCmNtp}}),e._v(" "),a("shadowntpadd",{attrs:{shadownode:e.shadownodeVal,isShow:e.shadowaddShow},on:{addclose:function(t){e.shadowaddShow=!1},hasaddshadow:e.getShadownodeData}}),e._v(" "),a("shadowntpedit",{attrs:{shadownode:e.shadownodeVal,editShow:e.shadoweditShow,allData:e.shadownodeData,ntpData:e.shadowntpData,editindex:e.shadoweditIndex},on:{eidtclose:function(t){e.shadoweditShow=!1},haseditshadow:e.getShadownodeData}})],1)},staticRenderFns:[]};var S=a("VU/8")(_,b,!1,function(e){a("uys3")},"data-v-04e54e56",null);t.default=S.exports},uys3:function(e,t){}});
//# sourceMappingURL=45.a181ad9232b0dacdf4c8.js.map