webpackJsonp([13],{"1ox/":function(t,e){},EV1k:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("5reh"),r=s("mtWM"),a=s.n(r),n=s("yJCr"),o=s("wtEF"),h={name:"dragVerify",props:{isPassing:{type:Boolean,default:!1},width:{type:Number,default:380},height:{type:Number,default:40},text:{type:String,default:"swiping to the right side"},successText:{type:String,default:"success"},background:{type:String,default:"#eee"},progressBarBg:{type:String,default:"#76c61d"},completedBg:{type:String,default:"#76c61d"},circle:{type:Boolean,default:!1},radius:{type:String,default:"4px"},handlerIcon:{type:String},successIcon:{type:String},handlerBg:{type:String,default:"#e8e8e8"},textSize:{type:String,default:"14px"},textColor:{type:String,default:"#333"}},mounted:function(){var t=this.$refs.dragVerify;t.style.setProperty("--textColor",this.textColor),t.style.setProperty("--width",Math.floor(this.width/2)+"px"),t.style.setProperty("--pwidth",-Math.floor(this.width/2)+"px")},computed:{handlerStyle:function(){return{left:"0px",width:this.height+"px",height:this.height+"px",background:this.handlerBg}},message:function(){return this.isPassing?this.successText:this.text},dragVerifyStyle:function(){return{width:this.width+"px",height:this.height+"px",lineHeight:this.height+"px",background:this.background,borderRadius:this.circle?this.height/2+"px":this.radius}},progressBarStyle:function(){return{background:this.progressBarBg,height:this.height+"px",borderRadius:this.circle?this.height/2+"px 0 0 "+this.height/2+"px":this.radius}},textStyle:function(){return{height:this.height+"px",width:this.width+"px",fontSize:this.textSize}}},data:function(){return{isMoving:!1,x:0,isOk:!1}},methods:{dragStart:function(t){if(!this.isPassing){this.isMoving=!0;var e=this.$refs.handler;this.x=(t.pageX||t.touches[0].pageX)-parseInt(e.style.left.replace("px",""),10)}this.$emit("handlerMove")},dragMoving:function(t){if(this.isMoving&&!this.isPassing){var e=(t.pageX||t.touches[0].pageX)-this.x,s=this.$refs.handler;e>0&&e<=this.width-this.height?(s.style.left=e+"px",this.$refs.progressBar.style.width=e+this.height/2+"px"):e>this.width-this.height&&(s.style.left=this.width-this.height+"px",this.$refs.progressBar.style.width=this.width-this.height/2+"px",this.passVerify())}},dragFinish:function(t){if(this.isMoving&&!this.isPassing){if((t.pageX||t.changedTouches[0].pageX)-this.x<this.width-this.height){this.isOk=!0;var e=this;setTimeout(function(){e.$refs.handler.style.left="0",e.$refs.progressBar.style.width="0",e.isOk=!1},500)}else{this.$refs.handler.style.left=this.width-this.height+"px",this.$refs.progressBar.style.width=this.width-this.height/2+"px",this.passVerify()}this.isMoving=!1}},passVerify:function(){this.$emit("update:isPassing",!0),this.isMoving=!1,this.$refs.handler.children[0].className=this.successIcon,this.$refs.progressBar.style.background=this.completedBg,this.$refs.message.style["-webkit-text-fill-color"]="unset",this.$refs.message.style.animation="slidetounlock2 3s infinite",this.$refs.message.style.color="#fff",this.$emit("passcallback")},reset:function(){var t=this.$options.data();for(var e in t)t.hasOwnProperty(e)&&this.$set(this,e,t[e]);var s=this.$refs.handler,i=this.$refs.message;s.style.left="0",this.$refs.progressBar.style.width="0",s.children[0].className=this.handlerIcon,i.style["-webkit-text-fill-color"]="transparent",i.style.animation="slidetounlock 3s infinite",i.style.color=this.background}}},l={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"dragVerify",staticClass:"drag_verify",style:this.dragVerifyStyle,on:{mousemove:this.dragMoving,mouseup:this.dragFinish,mouseleave:this.dragFinish,touchmove:this.dragMoving,touchend:this.dragFinish}},[e("div",{ref:"progressBar",staticClass:"dv_progress_bar",class:{goFirst2:this.isOk},style:this.progressBarStyle}),this._v(" "),e("div",{ref:"message",staticClass:"dv_text",style:this.textStyle},[this.$slots.textBefore?this._t("textBefore"):this._e(),this._v("\n        "+this._s(this.message)+"\n        "),this.$slots.textAfter?this._t("textAfter"):this._e()],2),this._v(" "),e("div",{ref:"handler",staticClass:"dv_handler dv_handler_bg",class:{goFirst:this.isOk},style:this.handlerStyle,on:{mousedown:this.dragStart,touchstart:this.dragStart}},[e("i",{class:this.handlerIcon})])])},staticRenderFns:[]};var d=s("VU/8")(h,l,!1,function(t){s("FBd4"),s("1ox/")},"data-v-eaf477f4",null).exports,c=s("xrTZ").Base64,g={created:function(){this.productName||this.getProductname()},components:{slider2:d},data:function(){return{isPassing:!1,productName:o.a.state.productName,loginform:{name:"",pwd:""},loginformRules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{reset:function(){this.isPassing=!1,void 0!=this.$refs.dragVerify&&this.$refs.dragVerify.reset()},passcallback2:function(){this.isPassing=!0},getProductname:function(){var t=this,e=n.c+"pe/shadow/kv/productName";a.a.get(e).then(function(e){if(0==e.data.responseCode){var s=e.data.data;t.productName=s,document.title=t.productName,t.$store.state.productName=s}})},loginSubmit:function(t){var e=this;this.isPassing?this.$refs[t].validate(function(t){if(!t)return!1;var s=c.encode(e.loginform.pwd),r=n.b+"uaa/oauth/token?username="+e.loginform.name+"&password="+s+"&grant_type=password";a.a.create().post(r,{},{headers:{Authorization:"Basic VUk6V0VScU0zWnVORFIxZEhWQw=="}}).then(function(t){var s=e,r=s.loginform.name;s.$store.commit(i.g,t.data),s.$store.commit(i.k,r),s.$store.state.nowTimeVal=[new Date((new Date).getTime()-864e5),new Date];var o=n.b+"uaa/user/"+r;a.a.get(o).then(function(t){if(0==t.data.responseCode){sessionStorage.setItem("myRoles",t.data.data.roles[0]),"ADMIN"==t.data.data.roles[0]||"USER"==t.data.data.roles[0]?s.$router.push({path:"/config"}):s.$router.push({path:"/logs"}),i=1e3*sessionStorage.getItem("expires_in"),s.$store.state.LoginResTime=setTimeout(function(){s.$store.state.loginResShow=!0},i),e.$nextTick(function(){setTimeout(function(){s.getPswdReminder(r)},1e3)})}var i}).catch(function(t){e.reset(),console.log(t)})}).catch(function(t){e.reset(),t.response||e.$message.error("服务器未响应！"),t.response&&400==t.response.status?"User account is locked"==t.response.data.error_description?e.$message.error("该账户已被锁定！"):e.$message.error("用户名或密码错误"):e.$message.error("服务器未响应！")})}):this.$message.error("请按住滑块拖动验证")},getPswdReminder:function(t){var e=this,s=n.b+"uaa/user/"+t+"/pswdreminder";a.a.get(s).then(function(s){0==s.data.responseCode&&s.data.data.recommandPswdChange&&(e.$store.state.pswdreminder=e.$notify({title:"提示",dangerouslyUseHTMLString:!0,message:"您已经很久没有更换密码了，建议<el-button style='color: #409EFF;font-style:italic;text-decoration:underline;'>修改</el-button>",duration:0,offset:155,onClick:function(){e.$store.state.userInfo={userName:t},e.$store.state.showEditUsersPswdDialog=!0}}))}).catch(function(t){console.log(t)})}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login-wrapper"},[s("div",{staticClass:"login-content"},[s("el-form",{ref:"loginform",attrs:{model:t.loginform,rules:t.loginformRules,"label-position":"left","label-width":"0px"}},[s("h3",{staticClass:"title"},[t._v(t._s(t.productName)+"登录")]),t._v(" "),s("el-form-item",{attrs:{prop:"name"}},[s("el-input",{attrs:{placeholder:"请输入用户名"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.loginSubmit("loginform")}},model:{value:t.loginform.name,callback:function(e){t.$set(t.loginform,"name","string"==typeof e?e.trim():e)},expression:"loginform.name"}})],1),t._v(" "),s("el-form-item",{attrs:{prop:"pwd"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.loginSubmit("loginform")}},model:{value:t.loginform.pwd,callback:function(e){t.$set(t.loginform,"pwd","string"==typeof e?e.trim():e)},expression:"loginform.pwd"}})],1),t._v(" "),s("el-form-item",[s("slider2",{ref:"dragVerify",attrs:{width:380,height:40,progressBarBg:"#FFA500",background:"#F5F5F5",text:"请按住滑块拖动",successText:"验证通过",isPassing:t.isPassing,handlerIcon:"el-icon-d-arrow-right",successIcon:"el-icon-circle-check"},on:{"update:isPassing":function(e){t.isPassing=e},passcallback:t.passcallback2}})],1),t._v(" "),s("el-form-item",[s("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(e){t.loginSubmit("loginform")}}},[t._v("登录")])],1)],1)],1)])},staticRenderFns:[]};var f=s("VU/8")(g,u,!1,function(t){s("T24C")},"data-v-2018cbf4",null);e.default=f.exports},FBd4:function(t,e){},T24C:function(t,e){}});
//# sourceMappingURL=13.9411af98b87f413083a5.js.map