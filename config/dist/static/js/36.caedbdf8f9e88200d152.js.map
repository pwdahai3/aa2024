{"version":3,"sources":["webpack:///src/components/home/visitChart.vue","webpack:///./src/components/home/visitChart.vue?9f55","webpack:///./src/components/home/visitChart.vue"],"names":["visitChart","emitter","pienodata","queryPanel","logRebuild","logTables","_this2","this","getCustomHeadData","resize","handleTime","getAllchart","val","_this3","isQuery","domainName","urlArr","isFalg","getRequestNum","attackSum","drawOrgIpLine","drawOrgIpPie","drawDomainLine","drawDomainPie","drawFingerPie","drawAutoToolPie","checkDomain","checkUrl","filterObj","starttime","endtime","sttime","edtime","dateTimeLong","Date","fromTime","endTime","value","access","businessDom","then","res2","j2","doc_count","dataJV2","key","b","push","valData2","indexName","mustOptions","timeinterval","valData","seriesData","getTime","adTstart","adTend","res","name","paramName","org_url","str","must","concat","toConsumableArray_default","prmoSearch","_this","myChartType","aggsUrl","topArrays","labelOption","sdata","getOnepieceFromPie","key2","etype","aggarr","params","codeArr","boolObj","orgIpDom","isLineOrg","i","j","dataJV","legendData","xaxisData","lineTimerFn","isPieOrg","sort","a","searchIp","result","getOrgIpPieData","domainDom","fingerPieLegendShow","series","legendRlt","seriesData1","seriesData2","xAxisData","isRegionBarOrg","cityName","latNum","lonNum","filterGeo","logDialogTitle","getRegionData","isRegionPieOrg","ikeyname","ikeycount","getRegionSunburstData","requestFullscreen","replace","myChart2Str","myChart11Str","myCharArray","myChart10Str","err","pageNum","item","pageSize","clientQueryObj","hits","logResArr","requeryObj","obj","n","d","home_visitChart","render","_vm","_h","$createElement","_c","_self","staticClass","on","click","hideSDURLMenu","directives","rawName","expression","attrs","getAllQuerychart","getChartTypeAllQuery","_v","gutter","staticStyle","padding-left","span","padding","box-sizing","element-loading-spinner","element-loading-background","mystyle","_e","ref","id","_s","wholeCtMax","wholeCtMin","normalCtMax","normalCtMin","padding-top","totalNum","attackSumNum","$t","forFastShow","forfastloadmore","title","visible","logDialogVisible","width","before-close","logDialogClose","update:visible","$event","tableKeyArr","tableKeyArrAccess","dynamicTag","chartLogsHeadData","refilterColBy","refilterColByAccess","requeryRowBy","requeryRowByAccess","chartLogsTotalNum","tabheadData","tabodyData","chartLogsBodyData","isLogLoding","showSDURLMenu","getChangeLogData","src","alt","fullScreen","downLoadPdf","goBackMap","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/36.caedbdf8f9e88200d152.js","sourcesContent":["<template>\r\n  <div class=\"visitChart-wrapper\" @click=\"hideSDURLMenu\">\r\n    <query-panel @getAllQuerychart=\"getAllchart\" @getChartTypeAllQuery='getChartTypeAllQuery' @handleTime=\"handleTime\" :myChartType='myChartType' v-show=\"isShowQueryPanel\"></query-panel><!-- 查询面板 -->\r\n    \r\n    <div class=\"visitChartContent\">\r\n       <el-row :gutter=\"10\" class=\"chartRow chartRowBusi\">\r\n          <el-col :span=\"20\" style=\"padding-left:0px\">\r\n            <div class=\"chart-content\" \r\n                v-loading=\"businessLineLoading\"\r\n                element-loading-spinner=\"el-icon-loading\"\r\n                element-loading-background=\"rgba(0, 0, 0, 0)\" style=\"padding:15px;box-sizing:border-box;\">\r\n              <pienodata mystyle=\"linenodata\" v-if=\"businessNodata\"></pienodata>\r\n              <div ref=\"businessContainer\" id=\"businessContainer\"></div>\r\n            </div>\r\n          </el-col>\r\n          <el-col :span=\"4\" class=\"busiNumBox\">\r\n            <ul class=\"totalList\">\r\n              <li class=\"listTitle\">总请求数：</li>\r\n              <li>\r\n                <i class=\"liLable\">MAX:</i>\r\n                <p class=\"liValue\">{{wholeCtMax}}</p>\r\n              </li>\r\n              <li>\r\n                <i class=\"liLable\">MIN:</i>\r\n                <p class=\"liValue\">{{wholeCtMin}}</p>\r\n              </li>\r\n            </ul>\r\n            <ul class=\"someList\">\r\n              <li class=\"listTitle\">恶意访问：</li>\r\n              <li>\r\n                <i class=\"liLable\">MAX:</i>\r\n                <p class=\"liValue\">{{normalCtMax}}</p>\r\n              </li>\r\n              <li>\r\n                <i class=\"liLable\">MIN:</i>\r\n                <p class=\"liValue\">{{normalCtMin}}</p>\r\n              </li>\r\n            </ul>\r\n          </el-col>\r\n         <!-- <el-col :span=\"6\">\r\n         <div class=\"chart-content numBox txtOverflow\">\r\n            <p class=\"text-center numBoxTitle\">总数据量</p>\r\n            <div class=\"totalBox\">\r\n              <p class='numTitle'>请求总量</p>\r\n              <p class=\"totalNum\">{{totalNum}}<span class=\"uTxt\">次</span></p>\r\n            </div>\r\n            <div class=\"abnormalBox\">\r\n              <p class='numTitle'>恶意访问总量</p>\r\n              <p class=\"abnormalNum\">{{attackSumNum}}<span class=\"uTxt\">次</span></p>\r\n            </div>\r\n          </div>\r\n        </el-col> -->\r\n      </el-row>\r\n      <el-row :gutter=\"10\" class=\"chartRow\">\r\n        <el-col :span=\"16\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"orgIpLineLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <pienodata  mystyle=\"linenodata\" v-if=\"orgIpLineNodata\"></pienodata>\r\n            <div id=\"orgIpLineContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"chart-content numBox txtOverflow\">\r\n            <p class=\"text-center numBoxTitle\" style=\"padding-top:10px\">总数据量</p>\r\n            <div class=\"totalBox\">\r\n              <p class='numTitle'>请求总量</p>\r\n              <p class=\"totalNum\">{{totalNum}}<span class=\"uTxt\">次</span></p>\r\n            </div>\r\n            <div class=\"abnormalBox\">\r\n              <p class='numTitle'>恶意访问总量</p>\r\n              <p class=\"abnormalNum\">{{attackSumNum}}<span class=\"uTxt\">次</span></p>\r\n            </div>\r\n          </div>\r\n          </el-col>\r\n        <!-- <el-col :span=\"8\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"orgIpPieLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"orgIpPieNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>暂无数据</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"orgIpPieContainer\"></div>\r\n          </div>\r\n        </el-col> -->\r\n      </el-row>\r\n\r\n      <el-row :gutter=\"10\" class=\"chartRow\">\r\n        <el-col :span=\"16\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"domainLineLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <pienodata  mystyle=\"linenodata\" v-if=\"domainLineNodata\"></pienodata>\r\n            <div id=\"domainLineContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"domainPieLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"domainPieNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>暂无数据</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"domainPieContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"10\" class=\"chartRow\">\r\n        <el-col :span=\"16\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"eCodeTypeLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"eCodeTypeNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>暂无数据</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"eCodeTypeContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"orgIpPieLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"orgIpPieNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>暂无数据</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"orgIpPieContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <!-- <el-col :span=\"8\" class=\"busiNumBox2 chart-content\">\r\n          <div class=\"chart-content numBox txtOverflow\">\r\n            <p class=\"text-center numBoxTitle\">总数据量</p>\r\n            <div class=\"totalBox\">\r\n              <p class='numTitle'>请求总量</p>\r\n              <p class=\"totalNum\">{{totalNum}}<span class=\"uTxt\">次</span></p>\r\n            </div>\r\n            <div class=\"abnormalBox\">\r\n              <p class='numTitle'>恶意访问总量</p>\r\n              <p class=\"abnormalNum\">{{attackSumNum}}<span class=\"uTxt\">次</span></p>\r\n            </div>\r\n          </div>\r\n          </el-col> -->\r\n      </el-row>\r\n\r\n      <el-row :gutter=\"10\" class=\"chartRow\">\r\n        <el-col :span=\"14\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"fingerPieLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle fingerPie-circle\" v-if=\"fingerPieNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>暂无数据</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"fingerPieContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"10\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"autoToolPieLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"autoToolPieNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>暂无数据</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"autoToolPieContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      \r\n     \r\n        \r\n      <el-row :gutter=\"10\" class=\"chartRow\" v-if=\"forFastShow\">\r\n        <el-col :span=\"24\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"urlVisitCtLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <pienodata mystyle=\"linenodata\" v-if=\"urlVisitCtBarNodata\"></pienodata>\r\n            <div id=\"urlVisitCtBarContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n\r\n        <!-- <el-col :span=\"10\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"eCodeTypeLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"eCodeTypeNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>暂无数据</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"eCodeTypeContainer\"></div>\r\n          </div>\r\n        </el-col> -->\r\n      </el-row>\r\n      <el-row :gutter=\"10\" class=\"chartRow\" v-if=\"forFastShow\">\r\n        <el-col :span=\"12\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"regionBarLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <!-- <pienodata mystyle=\"linenodata\" v-if=\"regionBarNodata\"></pienodata> -->\r\n            <div class=\"adaptive-circle\" v-if=\"regionBarNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>{{$t('lg.nodata')}}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"regionBarContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"10\">\r\n        </el-col>\r\n      </el-row>\r\n      <div>\r\n      <p class=\"fastloadmore\" v-if=\"!forFastShow\" @click=\"forfastloadmore\">点击查看更多图表</p>\r\n    </div>\r\n    </div>\r\n    \r\n\r\n    <!-- 日志弹框 -->\r\n    <el-dialog :title=\"logDialogTitle\" :visible.sync=\"logDialogVisible\" width=\"80%\" :before-close=\"logDialogClose\">\r\n      <log-rebuild :tableKeyArr='tableKeyArrAccess' :dynamicTag='chartLogsHeadData' @refilterColBy='refilterColByAccess' @requeryRowBy='requeryRowByAccess'></log-rebuild>\r\n      <div v-if=\"chartLogsTotalNum==0\" class=\"nodata-box\">暂无数据</div>\r\n      <div v-if=\"chartLogsTotalNum>0\" class=\"logTableHeight\">\r\n        <log-tables ref=\"log_tables\" :tabheadData=\"chartLogsHeadData\" :tabodyData=\"chartLogsBodyData\" :totalNum=\"chartLogsTotalNum\" @getChangeLogData=\"getChangeLogData\" :isLogLoding=\"false\" :showSDURLMenu='showSDURLMenu'></log-tables>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!-- <div title=\"返回地图\" class=\"goBackBtn\">\r\n      <router-link tag=\"a\" to=\"/visit\"><i class=\"fa fa-globe font-blue\"></i> 返回地图</router-link>\r\n    </div> \r\n    <div title=\"导出数据图表\" class=\"downBtn\">\r\n      <a href=\"javascript:;\" @click=\"downLoadPdf\"><i class=\"fa fa-cloud-download font-green\"></i> 导出图表</a>\r\n    </div>  -->\r\n\r\n    <!-- 右侧操作列表 -->\r\n    <ul class=\"operationBtnUl\"\r\n        v-show=\"isShowGridMenu\">\r\n      <li>\r\n        <img src=\"static/icon/fullScreen.png\"\r\n             alt=\"大屏展示\"\r\n             title=\"大屏展示\"\r\n             @click=\"fullScreen\">\r\n      </li>\r\n      \r\n      <li>\r\n        <img src=\"static/icon/downpdfChart.png\"\r\n             alt=\"导出pdf\"\r\n             title=\"导出pdf\"\r\n             @click=\"downLoadPdf\">\r\n      </li>\r\n      <li>\r\n        <img src=\"static/icon/map.png\"\r\n             alt=\"返回地图\"\r\n             title=\"返回地图\"\r\n             @click=\"goBackMap\">\r\n      </li>\r\n    </ul>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport {SERVER_API_URL} from '@/conf/constvar';\r\nimport client from \"@/components/es/connection\";\r\nimport * as types from '@/store/types';\r\nimport pienodata from '@/basecomponents/pienodata';\r\nimport toISO8601 from '@/assets/js/iso8601';\r\nimport echarts from 'echarts';\r\nimport queryPanel from './queryPanel';\r\nimport {logskeys} from '@/assets/js/logskeys';\r\nimport logRebuild from \"@/components/logs/logRebuild\";\r\nimport logTables from '@/components/logs/logTables';\r\nimport Emitter from 'element-ui/src/mixins/emitter';\r\nimport prmoSearchStr from '@/assets/js/prmoSearch.js'//防护模式、监控模式 不同的查询条件 \r\n\r\nimport {handleAccesslogData, getTarResultArr} from '@/assets/js/tool';\r\nimport {errorObj} from '@/assets/js/errorcode';\r\n\r\n\r\nexport default {\r\n  mixins: [Emitter],\r\n  components:{\r\n    pienodata,\r\n    queryPanel,\r\n    logRebuild,\r\n    logTables,\r\n  },\r\n  data(){\r\n    return{\r\n      forFastShow:false,\r\n      mustOptions:[],\r\n      fromTime:0,\r\n      endTime:0,\r\n      timeinterval:'',\r\n\r\n      //两种类型图表 防护模式、监控模式\r\n      myChartType:'protectChart',\r\n\r\n      //顶部查询面板\r\n      isFalg:false,//判断是否通过查询面板来查询的阀门\r\n      checkDomain:'',\r\n      checkUrl:'',\r\n      filterObj:{\"match_all\": {}},//顶部查询面板的查询条件\r\n\r\n      //max min \r\n      wholeCtMax:0,\r\n      wholeCtMin:0,\r\n      normalCtMax:0,\r\n      normalCtMin:0,\r\n\r\n      businessLineLoading:false,\r\n      urlVisitCtLoading:false,\r\n      eCodeTypeLoading:false,\r\n      orgIpLineLoading:false,\r\n      orgIpPieLoading:false,\r\n      domainLineLoading:false,\r\n      domainPieLoading:false,\r\n      fingerPieLoading:false,\r\n      autoToolPieLoading:false,\r\n      regionBarLoading:false,\r\n\r\n      businessLineChart:null,\r\n      urlVisitCtBarChart:null,\r\n      eCodeTypeChart:null,\r\n      orgIpLineChart:null,\r\n      orgIpPieChart:null,\r\n      domainLineChart:null,\r\n      domainPieChart:null,\r\n      fingerPieChart:null,\r\n      autoToolPieChart:null,\r\n      regionBarChart:null,\r\n      \r\n      businessNodata:false,\r\n      urlVisitCtBarNodata:false,\r\n      eCodeTypeNodata:false,\r\n      orgIpLineNodata:false,\r\n      orgIpPieNodata:false,\r\n      domainLineNodata:false,\r\n      domainPieNodata:false,\r\n      fingerPieNodata:false,\r\n      autoToolPieNodata:false,\r\n      regionBarNodata:false,\r\n      \r\n      totalNum:0,\r\n      attackSumNum:0,\r\n\r\n      isRegionBarOrg:false,\r\n      isLineOrg:false,\r\n      isPieOrg:false,\r\n\r\n      fingerPieLegendShow:false,\r\n\r\n      //日志弹框参数\r\n      popQueryObj:{\"bool\":{\"must\":[{\"bool\":{\"should\": []}}]}},\r\n      logDialogVisible:false,\r\n      logDialogTitle:'',\r\n      tableKeyArrAccess:[...logskeys.access], //access.log总共（默认）显示的字段\r\n      chartLogsHeadData:[],//access.log用户自定义显示的字段\r\n      chartLogsBodyData:[],//传入logTables.vue子组件的表体数据\r\n      chartLogsTotalNum:0,\r\n      fromPage:0,\r\n      pageSize:10,\r\n      requeryObj:null,//日志弹框里面的requery子组件的查询条件\r\n\r\n      // 地域信息切换源IP、代理IP\r\n      searchGeoip:'params._source.shadow.access.geoip',\r\n      searchGeoip2:'shadow.access.geoip',\r\n      mapScript:'geoip',\r\n\r\n      searchIp:'',\r\n\r\n      // 被恶意访问的url次数/Top10 触发es查询时做节流，（鼠标触摸时只触发一次查询，否则将产生多次重复查询）\r\n      esSearchTimer:null,\r\n\r\n      //大屏展示\r\n      isShowQueryPanel:true,//上方查询面板大屏展示时要隐藏\r\n      isShowGridMenu:true,//右下角菜单大屏展示时要隐藏\r\n    }\r\n  },\r\n  created(){\r\n    // this.$store.state.isShowTimerate = true;//采样频率选择\r\n    // this.$store.state.mydatedata.interval = '5m';\r\n    // this.$store.state.timerateValue='采样频率';\r\n\r\n    this.getCustomHeadData();\r\n    \r\n    // resize\r\n    window.addEventListener(\"resize\", () => {\r\n      this.eCodeTypeChart.resize();\r\n      this.orgIpLineChart.resize();\r\n      this.orgIpPieChart.resize();\r\n      this.domainLineChart.resize();\r\n      this.domainPieChart.resize();\r\n      this.fingerPieChart.resize();\r\n      this.autoToolPieChart.resize();\r\n      this.businessLineChart.resize();\r\n      if(this.forFastShow){\r\n        this.urlVisitCtBarChart.resize();\r\n        this.regionBarChart.resize();\r\n      }\r\n      \r\n    });\r\n  },\r\n  watch:{\r\n    '$store.state.mydatedata.timestampnow':function(){\r\n      this.handleTime();\r\n      this.getAllchart();\r\n    },\r\n    '$store.state.isMenuShow':function(){\r\n      this.eCodeTypeChart.resize();\r\n      this.orgIpLineChart.resize();\r\n      this.orgIpPieChart.resize();\r\n      this.domainLineChart.resize();\r\n      this.domainPieChart.resize();\r\n      this.fingerPieChart.resize();\r\n      this.autoToolPieChart.resize();\r\n      this.businessLineChart.resize();\r\n      if(this.forFastShow){\r\n        this.urlVisitCtBarChart.resize();\r\n        this.regionBarChart.resize();\r\n      }\r\n    }\r\n  },\r\n  mounted(){\r\n    if(!this.$route.query.timeInterval){\r\n      this.handleTime();\r\n      this.getAllchart();\r\n    }\r\n\r\n    // this.$refs.ipLineBox.oncontextmenu=()=>{\r\n    //   var _this=this;\r\n    //   this.alertTitle=\"恶意访问源IPTop5\";\r\n    //   this.alertMark=\"ipTop5\"\r\n    //   this.alertData=_this.cloneObj(_this.isIpAlertData);\r\n    //   this.alertLine=this.isIpAlertLine;\r\n    //   // console.log(\"ip  alertdata\")\r\n    //   // console.log(this.alertData)\r\n    //   this.isAlertingShow=true;\r\n    //   return false;\r\n    // }\r\n  },\r\n  methods:{\r\n    getChartTypeAllQuery(val){\r\n      this.myChartType=val;\r\n      this.getAllchart();\r\n    },\r\n    forfastloadmore(){\r\n      this.forFastShow=true;\r\n      this.$nextTick(()=>{\r\n          //this.drawBusinessLine();//slow\r\n          this.drawUrlVisitCtBar();//这个图查询语句相对特殊//slow\r\n          this.drawRegionBar();//slow\r\n        }); \r\n    },\r\n    //创建即执行\r\n    getAllchart(querOobj){\r\n      if(querOobj){\r\n        this.isFalg=querOobj.isQuery;\r\n        this.checkDomain=querOobj.domainName;\r\n        this.checkUrl=querOobj.urlArr;\r\n        this.filterObj=this.getFilterObj(this.isFalg);\r\n      }\r\n      this.getRequestNum();\r\n      this.attackSum();\r\n      this.drawECodeTypePie();//这个图查询语句相对特殊\r\n      this.drawOrgIpLine();\r\n      this.drawOrgIpPie();\r\n      this.drawDomainLine();\r\n      this.drawDomainPie();\r\n      this.drawFingerPie();\r\n      this.drawAutoToolPie();\r\n      this.drawBusinessLine();//slow\r\n      if(this.forFastShow){\r\n       this.drawUrlVisitCtBar();//这个图查询语句相对特殊//slow\r\n       this.drawRegionBar();//slow       \r\n      }\r\n    },\r\n    getFilterObj(flag){//输入条件后手动查询，不输入查询条件则查询所有数据\r\n      var _this=this;\r\n      var filterObj ={\"match_all\": {}};\r\n      if(flag){\r\n        var domainVariable = _this.checkDomain;\r\n        var urlVariable = _this.checkUrl;\r\n        filterObj = {\r\n          \"bool\": {\r\n            \"must\":[\r\n              {\"query_string\": {     \r\n                \"query\": \"shadow.access.http_host:\"+'\\\"'+domainVariable+'\\\"'\r\n              }}\r\n            ]\r\n          }\r\n        }\r\n        if(urlVariable){\r\n          var regxpUrl=/(\\/)+/g;\r\n          var regUrlVariable =urlVariable.replace(regxpUrl,'\\\\$1');\r\n          filterObj.bool.must.push({\"query_string\": {\r\n            \"query\": \"shadow.access.org_url:\"+'\\\"'+regUrlVariable+'\\\"'\r\n          }})\r\n        }\r\n      }else{\r\n        filterObj ={\"match_all\": {}};\r\n      }\r\n      return filterObj;\r\n    },\r\n    handleTime(){\r\n      var _this=this;\r\n      var sttime=_this.$store.state.mydatedata.starttime,\r\n          edtime=_this.$store.state.mydatedata.endtime;\r\n      var fromTime2=toISO8601(sttime),\r\n          endTime2=toISO8601(edtime);\r\n      var fromTime=fromTime2 || toISO8601(new Date(Date.now()-_this.$store.state.dateTimeLong)),\r\n          endTime=endTime2 || toISO8601(new Date()); \r\n      _this.fromTime=fromTime;\r\n      _this.endTime=endTime;\r\n      _this.timeinterval=_this.$store.state.mydatedata.interval || '5m';\r\n    },\r\n    getCustomHeadData(){ // 获取恶意访问日志弹框access.log表头（用户自定义的表头）\r\n      var url = SERVER_API_URL + '/pe/shadow/kv/visitChartAccess';\r\n      axios.get(url).then(res =>{\r\n        if(!res.data.data){\r\n          this.chartLogsHeadData = [...logskeys.access]\r\n        }else{\r\n          this.chartLogsHeadData = res.data.data.value;\r\n        }\r\n      })\r\n    },\r\n\r\n    //图表\r\n    drawBusinessLine(){//slow\r\n      var _this=this;\r\n      _this.businessLineLoading=true;\r\n      var businessDom=document.getElementById('businessContainer');\r\n     // var businessDom= _this.$refs.businessContainer;\r\n      _this.businessLineChart = echarts.init(businessDom);\r\n      _this.businessLineChart.off('brushSelected');//一定要清除brush事件\r\n      var brushFalg = false;//设置一个阀值，鼠标弹起时才触发\r\n      businessDom.addEventListener(\"mousedown\", () => {\r\n        brushFalg=false;\r\n      });\r\n      businessDom.addEventListener(\"mouseup\", () => {\r\n        brushFalg=true;\r\n      });\r\n      var options = {\r\n          color:['#27727b','#e87c25'],\r\n          title: {\r\n            text: '恶意访问业务防护',\r\n            x:'left',\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip : {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n              type: 'shadow',\r\n              label: {\r\n                show: true\r\n              }\r\n            }\r\n          },\r\n          legend: {\r\n            top:'20px',\r\n            data:['总请求数','恶意访问'],\r\n            itemGap: 5\r\n          },\r\n          grid: {\r\n            left: '5%',\r\n            right: '3%',\r\n            bottom:'4%',\r\n            top:'20%',\r\n            containLabel: true\r\n          },\r\n          brush: {\r\n            toolbox: ['lineX'],\r\n            xAxisIndex: \"all\",\r\n            transformable:false,\r\n            throttleType:'debounce',\r\n            throttleDelay: 1000,\r\n            brushStyle:{\r\n              borderWidth: 0,\r\n            }\r\n          },\r\n          toolbox: {\r\n            right:'20',\r\n            top:'10'\r\n          },\r\n          xAxis: {\r\n            show:false,\r\n            data : []\r\n          },\r\n          yAxis: {\r\n            show:false,\r\n            name:_this.$t('lg.counts'),\r\n          },\r\n          series : []\r\n        };\r\n      function lineTimerFn(){\r\n        // lineTimer().then((nodes)=>{\r\n        //   var nodeArr=[];\r\n        //   for(var n=0;n<nodes.aggregations.langs.buckets.length;n++){\r\n        //     nodeArr.push(\r\n        //       nodes.aggregations.langs.buckets[n].key\r\n        //     )\r\n        //   }\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body:  {\r\n            \"size\":0,\r\n            \"query\": {\r\n            \"bool\": {\r\n              \"filter\": _this.filterObj,\r\n              \"must\": [\r\n                {\r\n                  \"term\": {\r\n                    \"log.file.path\": \"/usr/local/shadow/logs/access.log\"\r\n                  }\r\n                },\r\n                {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"from\": _this.fromTime,\r\n                      \"to\": _this.endTime,\r\n                      \"include_lower\": true,\r\n                      \"include_upper\": true\r\n                    }\r\n                  }\r\n                },\r\n                {\r\n                  \"exists\": {\r\n                    \"field\": \"shadow.access.method\"\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          \"aggs\":{\"GroupByMe\":{\"date_histogram\":{\"field\":\"@timestamp\",\"interval\":_this.timeinterval,\"extended_bounds\":{\"min\":_this.fromTime,\"max\":_this.endTime}}}}\r\n          }\r\n        }).then((res2)=>{\r\n          var tarResult2=res2.aggregations?res2.aggregations.GroupByMe.buckets:[];\r\n          var valData2=[],xaxisData2=[];\r\n          var legendData=[],seriesData=[];\r\n\r\n          var wholeCtArr=[];\r\n\r\n          for(var j2=0;j2<tarResult2.length;j2++){\r\n            var dataJ2=tarResult2[j2];\r\n            var dataJV2=dataJ2.doc_count;\r\n\r\n            if(dataJV2!=0){\r\n              wholeCtArr.push(dataJV2);\r\n            }\r\n\r\n            if(!dataJV2){\r\n              dataJV2=0\r\n            }\r\n            valData2.push(dataJV2);\r\n            xaxisData2.push(_this.transformMyDate(dataJ2.key));\r\n          }\r\n\r\n          wholeCtArr.sort(function(a,b){//min max\r\n            return a-b;\r\n          });\r\n          _this.wholeCtMin=wholeCtArr[0]||0;\r\n          _this.wholeCtMax=wholeCtArr[wholeCtArr.length-1]||0;\r\n\r\n          seriesData.push(\r\n            {\r\n              name:\"总请求数\",\r\n              type:'bar',\r\n              data:valData2,\r\n              barMaxWidth: 10,\r\n              large: true,\r\n            }\r\n          );\r\n          var indexName=\"shadow-filebeat-*\";\r\n          if(_this.myChartType=='protectChart'){\r\n            indexName=\"shadow-filebeat-warn*\";\r\n            _this.mustOptions=[{\r\n                      \"range\": {\r\n                        \"@timestamp\": {\r\n                          \"from\": _this.fromTime,\r\n                          \"to\": _this.endTime,\r\n                          \"include_lower\": true,\r\n                          \"include_upper\": true\r\n                        }\r\n                      }\r\n                    }]\r\n          }else if(_this.myChartType=='monitorChart'){\r\n            _this.mustOptions=[\r\n              {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.error_code:>0\"\r\n              }\r\n            },\r\n            {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.response_code:200\"\r\n              }\r\n            },\r\n            {\r\n                      \"range\": {\r\n                        \"@timestamp\": {\r\n                          \"from\": _this.fromTime,\r\n                          \"to\": _this.endTime,\r\n                          \"include_lower\": true,\r\n                          \"include_upper\": true\r\n                        }\r\n                      }\r\n                    }\r\n            ]\r\n          };\r\n       \r\n          client.search({////////2\r\n            index: indexName,\r\n            body:  {\r\n              \"size\":0,\r\n              \"query\":{\r\n                \"bool\":{\r\n                  \"filter\": _this.filterObj,\r\n                  \"must\": _this.mustOptions\r\n                }\r\n              },\r\n              \"aggs\":{\r\n                \"GroupByMe\":{\r\n                  \"date_histogram\":{\r\n                    \"field\":\"@timestamp\",\r\n                    \"interval\":_this.timeinterval,\r\n                    \"extended_bounds\":{\r\n                      \"min\":_this.fromTime,\r\n                      \"max\":_this.endTime\r\n                    }\r\n                }}}\r\n              }\r\n            }).then((res)=>{\r\n              //  console.log(res);\r\n              var tarResult=res.aggregations?res.aggregations.GroupByMe.buckets:[];\r\n              var valData=[],normalCtArr=[];\r\n\r\n              if(tarResult.length==0){\r\n                options.xAxis.show=false;\r\n                options.yAxis.show=false;\r\n                _this.businessNodata=true;\r\n              }else{\r\n                options.xAxis.show=true;\r\n                options.yAxis.show=true;\r\n                _this.businessNodata=false;\r\n              }\r\n\r\n              for(var j2=0;j2<tarResult.length;j2++){\r\n                var dataJ2=tarResult[j2];\r\n                var dataJV2=dataJ2.doc_count;\r\n\r\n                if(dataJV2!=0){\r\n                  normalCtArr.push(dataJV2);\r\n                }\r\n\r\n                if(!dataJV2){\r\n                  dataJV2=0\r\n                }\r\n                valData.push(dataJV2);\r\n              }\r\n\r\n              normalCtArr.sort(function(a,b){//最小值\r\n                return a-b;\r\n              });\r\n              _this.normalCtMin=normalCtArr[0]||0;\r\n              _this.normalCtMax=normalCtArr[normalCtArr.length-1]||0;\r\n\r\n              seriesData.push(\r\n                {\r\n                  name:\"恶意访问\",\r\n                  type:'bar',\r\n                  data:valData,\r\n                  large: true,\r\n                  barMaxWidth: 10,\r\n                }\r\n              );\r\n\r\n              // console.log(xaxisData2)\r\n              // console.log( JSON.stringify(seriesData))\r\n\r\n              // options.legend.data=legendData;\r\n              options.xAxis.data=xaxisData2;//x轴\r\n              options.series=seriesData;\r\n              \r\n              _this.businessLineChart.setOption(options,true);\r\n              _this.businessLineLoading=false;\r\n              \r\n              //brush 操作\r\n              _this.businessLineChart.on('brushSelected', function (params) {\r\n                // console.log(params)\r\n                if(brushFalg){\r\n                  if(params.batch && params.batch[0].areas[0]){\r\n                    // console.log(params.batch[0])\r\n                    var startIndex=params.batch[0].areas[0].coordRange[0]=='-0'||params.batch[0].areas[0].coordRange[0]<0?0:params.batch[0].areas[0].coordRange[0];\r\n                    var endIndex=params.batch[0].areas[0].coordRange[1];\r\n                    var tstart=xaxisData2[startIndex],tend=xaxisData2[endIndex]?xaxisData2[endIndex]:xaxisData2[endIndex-1];\r\n                    \r\n                    if(tstart==tend){ //采样频率稍大时（为'5m'时很容易出现这个问题）,如果用户选定的范围只在一个采样点内（只拉动一个阴影格），会导致起始查询时间和截止查询时间一致，这时在这个时间点上可能没有数据（但看起来应该有数据，采样频率导致的），因此遇到这种情况就把起始时间的范围以及截止时间的范围都各自扩大一个采样点，这样保证了用户只选取一个阴影格的时候也会有数据。\r\n                      // console.log(tstart,tend,'相等');\r\n                      var adTstart=new Date(tstart).getTime(),adTend=new Date(tend).getTime();\r\n                      if(_this.$store.state.mydatedata.interval=='5m'){//此时interval=='1d' 或者 '1h'的可能性很小，因此没写了\r\n                        adTstart-=5*60*1000;\r\n                        adTend+=5*60*1000;\r\n                      }else if(_this.$store.state.mydatedata.interval=='10s'){\r\n                        adTstart-=10*1000;\r\n                        adTend+=10*1000;\r\n                      }else if(_this.$store.state.mydatedata.interval=='1s'){ //interval=='1s' 采样频率精确到1s，在往下拉也会一直有数据，因此也没写了\r\n                        // adTstart-=1*1000\r\n                        // adTend+=1*1000\r\n                      }\r\n                      tstart = _this.transformMyDate(adTstart);\r\n                      tend = _this.transformMyDate(adTend);\r\n                    }\r\n                    // console.log(tstart,tend);\r\n\r\n                    _this.$store.state.nowTimeVal=[new Date(tstart),new Date(tend)];//改变右上角时间（跟拉到的时间保持一致）\r\n                    clearTimeout(_this.$store.state.refreshTimeout)//图表轮询定时器 清除按时刷新数据的定时器\r\n                    _this.$store.state.refreshAble=true;//禁用自动刷新\r\n                    setTimeout(()=>{\r\n                      _this.$store.commit(types.MYDATEPICKER);\r\n                    },0)\r\n                  }\r\n                }\r\n              });\r\n            });\r\n          });\r\n        // })\r\n      }\r\n      lineTimerFn();\r\n    },\r\n    getRequestNum(){//请求总量\r\n      var _this=this;\r\n      client.search({\r\n        index:\"shadow-filebeat-*\",\r\n        body:{\r\n          \"track_total_hits\": true, \r\n          // \"sort\": {\r\n          //   \"@timestamp\": \"desc\"\r\n          // },\r\n          \"query\": {\r\n            \"bool\": {\r\n              \"filter\": _this.filterObj,\r\n              \"must\": [{\r\n                \"term\": {\r\n                  \"log.file.path\": \"/usr/local/shadow/logs/access.log\"\r\n                }\r\n              },{\r\n              \"exists\": {\r\n                \"field\": \"shadow.access.method\"\r\n              }\r\n            }, {\r\n                \"range\": {\r\n                  \"@timestamp\": {\r\n                    \"from\": _this.fromTime,\r\n                    \"to\": _this.endTime,\r\n                    \"include_lower\": true,\r\n                    \"include_upper\": true\r\n                  }\r\n                }\r\n              }]\r\n            }\r\n          }\r\n        }\r\n      }).then((res)=>{\r\n        _this.totalNum=res.hits.total.value;\r\n        // console.log(_this.fromTime,_this.endTime)\r\n      })\r\n    },\r\n    attackSum(){//恶意访问总量\r\n      var _this=this;\r\n      var indexName=\"shadow-filebeat-*\";\r\n      if(_this.myChartType=='protectChart'){\r\n        indexName=\"shadow-filebeat-warn*\"\r\n            _this.mustOptions=[{\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }]\r\n          }else if(_this.myChartType=='monitorChart'){\r\n            _this.mustOptions=[\r\n              {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.error_code:>0\"\r\n              }\r\n            },\r\n            {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.response_code:200\"\r\n              }\r\n            },\r\n            {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }\r\n            ]\r\n          };\r\n      client.search({\r\n        index:indexName,\r\n        body:{\r\n          \"track_total_hits\": true, \r\n          \"query\": {\r\n            \"bool\": {\r\n              \"filter\": _this.filterObj,\r\n              \"must\": _this.mustOptions\r\n            }\r\n          }\r\n        }\r\n      }).then((res)=>{\r\n        _this.attackSumNum=res.hits.total.value;\r\n      })\r\n    },\r\n    \r\n    drawUrlVisitCtBar(){//slow\r\n      var _this=this;\r\n      _this.urlVisitCtLoading=true;\r\n      _this.urlVisitCtBarChart = echarts.init(document.getElementById('urlVisitCtBarContainer'));\r\n    \r\n      //设置‘基于错误码统计的恶意访问次数/Top10’图的显示文字\r\n      var labelOption = {\r\n          normal: {\r\n          show: true,\r\n          rotate: 0,\r\n          align: 'left',\r\n          verticalAlign: 'middle',\r\n          position: 'insideLeft',\r\n          distance: 10,\r\n          // color:'#000',\r\n          formatter:function(params){\r\n            // console.log(params)\r\n            const str = params.data.name;               \r\n            return str;\r\n          },\r\n          fontSize: 12,\r\n        }\r\n      };\r\n      var option = {\r\n            color:['#eb8146'],\r\n            title: {\r\n              text: '被恶意访问的url次数/Top10',\r\n              x:'center',\r\n              textStyle: {\r\n                fontSize: '16',\r\n                fontWeight: 'normal'\r\n              }\r\n            },\r\n            tooltip: {\r\n              show:true,\r\n              trigger: 'axis',\r\n              confine:true,\r\n              axisPointer: {\r\n                type: 'shadow'\r\n              },\r\n              // extraCssText:'white-space:pre-wrap',\r\n              extraCssText:'white-space:normal;word-break: break-all',\r\n              formatter: function (params, ticket, callback){\r\n                // console.log(params)\r\n                // console.log(ticket);\r\n                // console.log(callback)\r\n                \r\n                if(_this.myChartType=='protectChart'){//如果为防护模式则要查询密文对应的明文\r\n                  \r\n                  if(_this.esSearchTimer){\r\n                    clearTimeout(_this.esSearchTimer) //进入该分支语句，说明当前正在一个计时过程中，并且又触发了相同事件。所以要取消当前的计时，重新开始计时\r\n                  }\r\n      \r\n                  _this.esSearchTimer = setTimeout(function(){\r\n                    var str = '', name = '', urlTxt='';\r\n                    params.forEach(item=>{\r\n                      name=item.name;\r\n                      str = item.data.name+_this.$t('lg.numaccessis')+':'+item.data.value+_this.$t('lg.count')\r\n                    })\r\n                    var paramName = '\\\"'+name+'\\\"';\r\n                    // console.log(paramName)\r\n\r\n                    client.search({\r\n                      index: \"shadow-filebeat-*\",\r\n                      body: {\r\n                        \"size\": 0,\r\n                        \"query\": {\r\n                          \"bool\": {\r\n                            \"must\": [\r\n                              {\r\n                                \"query_string\": {\r\n                                  \"query\": \"shadow.access.response_code:200\"\r\n                                }\r\n                              },\r\n                              {\r\n                                \"query_string\": {\r\n                                  \"query\": \"shadow.access.response_code:302\"\r\n                                }\r\n                              },\r\n                              {\r\n                                \"query_string\": {\r\n                                  \"query\":\"shadow.access.shadow_url:\"+paramName\r\n                                }\r\n                              }\r\n                            ],\r\n                            \"must_not\": {\r\n                              \"query_string\": {\r\n                                \"query\": \"shadow.access.org_url:\\\\/40*\\\\.html\"\r\n                              }\r\n                            }\r\n                          }\r\n                        },\r\n                        \"_source\": [\"shadow.access.org_url\"]\r\n                      }\r\n                    }).then((res)=>{\r\n                      // console.log(res);\r\n                      if(res.hits.hits[0]){\r\n                        urlTxt=res.hits.hits[0]._source.shadow.access.org_url;\r\n                        var str2='其对应的明文为：'+urlTxt+'</br>'+str\r\n                        callback(ticket, str2);\r\n                      }else{\r\n                        var str2='其对应的明文为：-</br>'+str\r\n                        callback(ticket, str2);\r\n                      }\r\n                    });  \r\n                  },1000)\r\n                  \r\n                  return '<i class=\"el-icon-loading\"></i>Loading...';\r\n                }else{\r\n                  var str = '';\r\n                  params.forEach(item=>{\r\n                    str = item.data.name+_this.$t('lg.numaccessis')+':'+item.data.value+_this.$t('lg.count')\r\n                  })\r\n                  return str;\r\n                }\r\n              }\r\n            },\r\n            // legend: {\r\n            //   data: [],\r\n            //   top:'30px',\r\n            // },\r\n            grid: {\r\n              top:'12%',\r\n              left: '0',\r\n              right: '50',\r\n              bottom: '2%',\r\n              containLabel: true\r\n            },\r\n            xAxis: {\r\n              show:false,\r\n              type: 'value',\r\n              name:_this.$t('lg.counts'),\r\n              boundaryGap: [0,0.01],\r\n              position:'top',\r\n              splitLine:{\r\n                show:false\r\n              },\r\n              minInterval: 1//保持x轴刻度只为整数\r\n            },\r\n            yAxis: { \r\n              show:false,\r\n              type: 'category',\r\n              data: [],//topArrays\r\n              inverse: true,//是否是反向坐标轴 （这里反向后数据降序排列）\r\n            },\r\n            series: []\r\n          };\r\n      \r\n      function getUrlVisitCtData(){\r\n        // console.log(_this.myChartType)\r\n        let aggsUrl = '';//防护模式、监控模式 查询语句的聚合条件不一样\r\n        if(_this.myChartType=='protectChart'){\r\n          aggsUrl='shadow.access.shadow_url'\r\n        }else{//monitorChart\r\n          aggsUrl='shadow.access.org_url'\r\n        }\r\n\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body: {\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": [\r\n                  ...prmoSearchStr[_this.myChartType]['a2'],\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.http_host:*\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.org_url:*\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"range\": {\r\n                      \"@timestamp\": {\r\n                        \"gte\": _this.fromTime,\r\n                        \"lte\": _this.endTime\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"GroupByMe\": {\r\n                \"terms\": {\r\n                  \"field\": aggsUrl,\r\n                  \"size\": 10\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }).then((res)=>{\r\n          // console.log(res);\r\n          var resResult=res.aggregations?res.aggregations.GroupByMe.buckets:[];\r\n          let topArrays=[];              //存 ['top5','top4','top3','top2','top1']\r\n          let topArray=resResult.length;               //取前面10位  top10\r\n          for(var i=0;i<topArray;i++){   //遍历出top 数组\r\n            topArrays.push(`top${i+1}`);\r\n          } \r\n          // topArrays.reverse();//反序\r\n          option.yAxis.data=topArrays;\r\n\r\n          var sdata=[];\r\n          for(var i=0; i<topArrays.length;i++){\r\n            if(resResult[i]){\r\n              sdata.push({\r\n                value:resResult[i].doc_count,\r\n                name:resResult[i].key,\r\n              });\r\n            }\r\n          }\r\n          // sdata.sort(function(a,b){return b.value-a.value});\r\n          // sdata.reverse();//反序\r\n          option.series=[{          \r\n            type: 'bar',\r\n            label: labelOption,\r\n            data:sdata,\r\n            barMaxWidth:30,\r\n          }]\r\n        \r\n          // console.log(option.series)\r\n          if(resResult.length==0){\r\n            option.xAxis.show=false;\r\n            option.yAxis.show=false;\r\n            option.tooltip.show=false;\r\n            _this.urlVisitCtBarNodata=true;\r\n          }else{\r\n            option.xAxis.show=true;\r\n            option.yAxis.show=true;\r\n            option.tooltip.show=true;\r\n            _this.urlVisitCtBarNodata=false;\r\n          }\r\n          _this.urlVisitCtBarChart.setOption(option,true);\r\n          _this.urlVisitCtLoading=false;\r\n        });\r\n\r\n        _this.urlVisitCtBarChart.off(\"click\");\r\n        _this.urlVisitCtBarChart.on(\"click\",(params)=>{\r\n          // console.log(params)\r\n          _this.logDialogVisible=true;\r\n          _this.logDialogTitle=params.name;\r\n          _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n\r\n          _this.popQueryObj.bool.must= JSON.parse(JSON.stringify(prmoSearchStr[_this.myChartType]['a2']));\r\n          _this.popQueryObj.bool.must.push({\r\n            \"query_string\": {\r\n              \"query\":aggsUrl+\":\"+_this.logDialogTitle.replace(/\\//g,'\\\\/')\r\n            } \r\n          });\r\n          _this.getOnepieceFromPie();\r\n        });\r\n      }\r\n      getUrlVisitCtData();\r\n    },\r\n    drawECodeTypePie(){\r\n      var _this=this;\r\n      _this.eCodeTypeLoading=true;\r\n      _this.eCodeTypeChart = echarts.init(document.getElementById('eCodeTypeContainer'));\r\n      var options = {\r\n        color:['#2b821d','#e6b600','#339ca8','#c12e34','#0098d9','#005eaa','#97b552','#cc70af'],\r\n        title : {\r\n          text: '恶意访问类型展示/Top10',\r\n          x:'center',\r\n          textStyle: {\r\n            fontSize: '16',\r\n            fontWeight: 'normal'\r\n          }\r\n        },\r\n        tooltip: {\r\n          trigger: 'item',\r\n          formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n        },\r\n        // legend: {\r\n        //   orient: 'horizontal',\r\n        //   bottom:'0px',\r\n        //   data:[]\r\n        // },\r\n        series: [\r\n          {\r\n            name:'访问类型：',\r\n            type:'pie',\r\n            radius:['25%','35%'],\r\n            // radius:'35%',\r\n            // center: ['50%', '50%'],\r\n            data:[].sort(function (a, b) { return a.value - b.value; }),\r\n            // roseType: 'radius',//area radius\r\n            // avoidLabelOverlap: false,\r\n            label: {\r\n              position:'outside',\r\n              normal: {\r\n                textStyle: {\r\n                  fontSize: '12',  \r\n                },\r\n                formatter: \"{b}: {c}\"\r\n              },\r\n              emphasis: {\r\n                show: true,\r\n                textStyle: {\r\n                  fontSize: '14',\r\n                  fontWeight: 'normal'\r\n                }\r\n              }\r\n            },\r\n            labelLine: {\r\n              normal: {\r\n                smooth: 0,\r\n                length: 10,\r\n                length2: 20,\r\n              },\r\n            },\r\n            animationType: 'scale',\r\n            animationEasing: 'elasticOut',\r\n            animationDelay: function (idx) {\r\n              return Math.random() * 200;\r\n            }\r\n          }\r\n        ]\r\n      };\r\n      function getECodeTypeData(){\r\n        var indexName=\"shadow-filebeat-*\";\r\n      if(_this.myChartType=='protectChart'){\r\n        indexName=\"shadow-filebeat-warn*\"\r\n            _this.mustOptions=[{\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }]\r\n          }else if(_this.myChartType=='monitorChart'){\r\n            _this.mustOptions=[\r\n              {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.error_code:>0\"\r\n              }\r\n            },\r\n            {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.response_code:200\"\r\n              }\r\n            },\r\n            {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }\r\n            ]\r\n          };\r\n        client.search({\r\n          index: indexName,\r\n          body: {\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\":_this.mustOptions\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"groupbyerrorcode\":{\r\n                \"terms\": {\r\n                  \"field\": \"shadow.access.error_code\", \r\n                  \"size\": 10\r\n                },\r\n                \"aggs\": {\r\n                  \"groupbyresp\": {\r\n                    \"terms\": {\r\n                      \"field\": \"shadow.access.response_code\",\r\n                      \"size\": 10\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n        }\r\n        }).then((res)=>{\r\n          var tarResult=res.aggregations?res.aggregations.groupbyerrorcode.buckets:[];\r\n          // var tarResultArr = getTarResultArr(tarResult,1);\r\n          // console.log(tarResultArr)\r\n          // let result=[];\r\n          // for(var i=0;i<tarResultArr.length;i++){\r\n          //   var dataI=tarResultArr[i];\r\n          //   result.push(\r\n          //     { \r\n          //       code:dataI[\"codeList\"],\r\n          //       value:dataI[\"doc_count\"],\r\n          //       name:dataI[\"key\"]\r\n          //     }\r\n          //   );\r\n          // }\r\n\r\n          var aggarr=[];\r\n          tarResult.forEach(item=>{\r\n            var key=item.key;\r\n            var etype=\"\"\r\n            if(key==\"0\"){\r\n              item.groupbyresp.buckets.forEach(item2=>{\r\n                var key2=item2.key;\r\n                if(!errorObj[0].hasOwnProperty(key2)){\r\n                    etype=\"其他异常\";\r\n                }else{\r\n                  etype=errorObj[0][key2];\r\n                }\r\n                aggarr.push({\r\n                  \"key\":[key,key2],\r\n                  \"name\":etype,\r\n                  \"value\":item2.doc_count\r\n                })\r\n              })\r\n            }else{\r\n              if(!errorObj.hasOwnProperty(key)){\r\n                etype=\"其他异常\";\r\n              }else{\r\n                etype=errorObj[key];\r\n              }\r\n              aggarr.push({\r\n                \"key\":[key],\r\n                \"name\":etype,\r\n                \"value\":item.doc_count\r\n              })\r\n            }\r\n          });\r\n          options.series[0].data=aggarr;\r\n          // options.legend.data=legendRlt;\r\n          if(aggarr.length==0){\r\n            _this.eCodeTypeNodata=true;\r\n          }else{\r\n            _this.eCodeTypeNodata=false;\r\n          }\r\n          _this.eCodeTypeChart.setOption(options,true);\r\n          _this.eCodeTypeLoading=false;\r\n\r\n          _this.eCodeTypeChart.off(\"click\");\r\n          _this.eCodeTypeChart.on(\"click\",(params)=>{//恶意访问类型展示图表，点出日志弹框特殊处理\r\n             console.log(params);\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n\r\n            //let codeArr=params.data.code;\r\n            var paramsCode=params.data.key;\r\n            let codeArr=paramsCode[0];\r\n            let boolObj={\r\n                  \"bool\":{\r\n                    \"filter\":{\"match_all\": {}},\r\n                    \"must\":[\r\n                      {\r\n                        \"bool\":{\"should\": []}\r\n                      }\r\n                    ]\r\n                  }\r\n                };\r\n\r\n            if(codeArr==\"0\"){//单防护模式，监控模式不会有errorCode=0这种情况\r\n                boolObj.bool.must[0].bool.should.push({\r\n                  \"bool\":{\r\n                    \"must\": [\r\n                      {\r\n                        \"query_string\": {\r\n                          \"query\": \"shadow.access.error_code:0\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"query_string\": {\r\n                          \"query\": \"shadow.access.response_code:\"+paramsCode[1]\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                })\r\n                if(paramsCode[1]==\"200\"){\r\n                  boolObj.bool.must[0].bool.should[0].bool.must.push({\r\n                    \"query_string\": {\r\n                      \"query\": \"shadow.access.org_url:\\\\/402\\\\.html\"\r\n                    }\r\n                  })\r\n                }\r\n            }else{//既有防护模式又有监控模式\r\n\r\n                if(_this.myChartType=='protectChart'){\r\n                  boolObj.bool.must[0].bool.should.push({\r\n                    \"bool\":{\r\n                      \"must\": [\r\n                        {\r\n                          \"query_string\": {\r\n                            \"query\": \"shadow.access.error_code:\"+codeArr\r\n                          }\r\n                        },\r\n                        {\r\n                          \"query_string\": {\r\n                            \"query\": \"shadow.access.response_code:(400 OR 444 OR 404 OR 405)\"\r\n                          }\r\n                        }\r\n                      ]\r\n                    }\r\n                  })\r\n                }\r\n                \r\n                if(_this.myChartType=='monitorChart'){\r\n                  boolObj.bool.must[0].bool.should.push({\r\n                    \"bool\":{\r\n                      \"must\": [\r\n                        {\r\n                          \"query_string\": {\r\n                            \"query\": \"shadow.access.error_code:\"+codeArr\r\n                          }\r\n                        },\r\n                        {\r\n                          \"query_string\": {\r\n                            \"query\": \"shadow.access.response_code:200\"\r\n                          }\r\n                        }\r\n                      ]\r\n                    }\r\n                  })\r\n                }\r\n            }\r\n\r\n            boolObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n            _this.popQueryObj=boolObj;\r\n            _this.getOnepieceFromPie();\r\n          });\r\n        });\r\n      }\r\n      getECodeTypeData();\r\n    },\r\n    drawOrgIpLine(){\r\n      var _this=this;\r\n      _this.orgIpLineLoading=true;\r\n      var orgIpDom=document.getElementById('orgIpLineContainer');\r\n      _this.orgIpLineChart = echarts.init(orgIpDom);\r\n\r\n      _this.orgIpLineChart.off('brushSelected');//一定要清除brush事件\r\n      var brushFalg = false;//设置一个阀值，鼠标弹起时才触发\r\n      orgIpDom.addEventListener(\"mousedown\", () => {\r\n        brushFalg=false;\r\n      });\r\n      orgIpDom.addEventListener(\"mouseup\", () => {\r\n        brushFalg=true;\r\n      });\r\n\r\n      var options = {\r\n          color:['#4ea397','#22c3aa','#7bd9a5','#d0648a','#f58db2'],\r\n          title: {\r\n            text: '恶意访问源IP次数/Top5',\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip: {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n              type: 'shadow',\r\n              label: {\r\n                show: true\r\n              }\r\n            }\r\n          },\r\n          legend: {\r\n            top:'20px',\r\n            data:[],\r\n          },\r\n          grid: {\r\n            left: '5%',\r\n            right: '3%',\r\n            bottom:'4%',\r\n            top:'25%',\r\n            containLabel: true\r\n          },\r\n          brush: {\r\n            toolbox: ['switchOrg'],\r\n            xAxisIndex: \"all\",\r\n            transformable:false,\r\n            throttleType:'debounce',\r\n            throttleDelay: 1000,\r\n            brushStyle:{\r\n              borderWidth: 0,\r\n            }\r\n          },\r\n          toolbox: {\r\n            right:'10',\r\n            top:'10',\r\n            feature: {\r\n              myTool1: {\r\n                name:'switchOrg',\r\n                show: true,\r\n                title: '代理IP',\r\n                icon: 'image://static/icon/switch.png',\r\n                onclick: function (){\r\n                  lineTimerFn(_this.isLineOrg)\r\n                }\r\n              }\r\n            }\r\n          },\r\n          xAxis: {\r\n            show:false,\r\n            type: 'category',\r\n            //data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\r\n            data: [],\r\n          },\r\n          yAxis: {\r\n            show:false,\r\n            type: 'value',\r\n            name:_this.$t('lg.counts'),\r\n            minInterval: 1//保持y轴刻度只为整数\r\n          },\r\n          series: [\r\n            // {\r\n            //     name:'Step Start',\r\n            //     type:'line',\r\n            //     step: 'start',\r\n            //     data:[120, 132, 101, 134, 90, 230, 210]\r\n            // },\r\n            // {\r\n            //     name:'Step Middle',\r\n            //     type:'line',\r\n            //     step: 'middle',\r\n            //     data:[220, 282, 201, 234, 290, 430, 410]\r\n            // },\r\n          ]\r\n        };\r\n      function lineTimerFn(type){\r\n        if(type){\r\n          _this.isLineOrg=false;\r\n          _this.searchIp=\"shadow.access.org_remote_ip\";//查代理IP\r\n          options.title.text='恶意访问代理IP次数/Top5';\r\n          options.toolbox.feature.myTool1.title='源IP';\r\n        }else{\r\n          _this.isLineOrg=true;\r\n          _this.searchIp=\"shadow.access.remote_ip\";//查源IP\r\n          options.title.text='恶意访问源IP次数/Top5';\r\n          options.toolbox.feature.myTool1.title='代理IP';\r\n        }\r\n        \r\n        // lineTimer().then((nodes)=>{\r\n        //   var nodeArr=[];\r\n        //   for(var n=0;n<nodes.aggregations.langs.buckets.length;n++){\r\n        //     nodeArr.push(\r\n        //       nodes.aggregations.langs.buckets[n].key\r\n        //     )\r\n        //   }\r\n        var indexName=\"shadow-filebeat-*\";\r\n      if(_this.myChartType=='protectChart'){\r\n        indexName=\"shadow-filebeat-warn*\"\r\n            _this.mustOptions=[{\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }]\r\n          }else if(_this.myChartType=='monitorChart'){\r\n            _this.mustOptions=[\r\n              {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.error_code:>0\"\r\n              }\r\n            },\r\n            {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.response_code:200\"\r\n              }\r\n            },\r\n            {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }\r\n            ]\r\n          };\r\n\r\n        client.search({\r\n          index: indexName,\r\n          body: {\r\n          \"size\": 0,\r\n          \"query\": {\r\n            \"bool\": {\r\n              \"filter\": _this.filterObj,\r\n              \"must\":_this.mustOptions\r\n            }\r\n          },\r\n          \"aggs\": {\r\n            \"ip\": {\r\n              \"terms\": {\r\n                \"field\": _this.searchIp,//shadow.access.org_remote_ip\r\n                \"size\": 5\r\n              },\r\n              \"aggs\": {\r\n                \"time_his\": {                  \r\n                  \"date_histogram\": {\r\n                    \"field\": \"@timestamp\",\r\n                    \"interval\": _this.timeinterval,\r\n                    \"extended_bounds\": {\r\n                      \"min\": _this.fromTime,\r\n                      \"max\": _this.endTime\r\n                    }\r\n                  }\r\n                }        \r\n              }\r\n            }\r\n          }\r\n        }\r\n        }).then((res)=>{\r\n          // console.log(res)\r\n          var tarResult=res.aggregations?res.aggregations.ip.buckets:[];\r\n          var legendData=[],seriesData=[];\r\n          if(tarResult.length==0){\r\n            options.xAxis.show=false;\r\n            options.yAxis.show=false;\r\n            options.brush.toolbox=['switchOrg'];\r\n            _this.orgIpLineNodata=true;\r\n          }else{\r\n            options.xAxis.show=true;\r\n            options.yAxis.show=true;\r\n            options.brush.toolbox=['lineX','switchOrg'];\r\n            _this.orgIpLineNodata=false;\r\n          }\r\n          for(var i=0;i<tarResult.length;i++){\r\n            var xaxisData=[],valData=[];\r\n            var dataI=tarResult[i];\r\n            legendData.push(dataI.key);\r\n            for(var j=0;j<dataI.time_his.buckets.length;j++){\r\n              var dataJ=dataI.time_his.buckets[j];\r\n              var dataJV=dataJ.doc_count;\r\n              if(!dataJV){\r\n                dataJV=0\r\n              }\r\n              xaxisData.push(_this.transformMyDate(dataJ.key));\r\n              valData.push(dataJV);\r\n            }\r\n            seriesData.push(\r\n              {\r\n                name:dataI.key,\r\n                type:'line',\r\n                data:valData,\r\n              }\r\n            );\r\n          }\r\n\r\n          // if(hasline.iptopline){\r\n          //   seriesData=seriesData.map((item)=>{\r\n          //     item.markLine= {\r\n          //           symbol:\"none\",\r\n          //           silent: true,\r\n          //           lineStyle:{\r\n          //               type:'dashed',\r\n          //               color:'#893448'\r\n          //           },\r\n          //           data: [{\r\n          //               yAxis: _this.ipConditionData\r\n          //           }]\r\n          //       }\r\n          //     return item;\r\n          //   })\r\n          // }\r\n\r\n          options.legend.data=legendData;\r\n          options.xAxis.data=xaxisData;\r\n          options.series=seriesData;\r\n          _this.orgIpLineChart.setOption(options,true);\r\n          _this.orgIpLineLoading=false;\r\n\r\n          //brush 操作\r\n          _this.orgIpLineChart.on('brushSelected', function (params) {\r\n            // console.log(params)\r\n            if(brushFalg){\r\n              if(params.batch && params.batch[0].areas[0]){\r\n                // console.log(params.batch[0])\r\n                var startIndex=params.batch[0].areas[0].coordRange[0]=='-0'||params.batch[0].areas[0].coordRange[0]<0?0:params.batch[0].areas[0].coordRange[0];\r\n                var endIndex=params.batch[0].areas[0].coordRange[1];\r\n                var tstart=xaxisData[startIndex],tend=xaxisData[endIndex]?xaxisData[endIndex]:xaxisData[endIndex-1];\r\n\r\n                if(tstart==tend){ //采样频率稍大时（为'5m'时很容易出现这个问题）,如果用户选定的范围只在一个采样点内（只拉动一个阴影格），会导致起始查询时间和截止查询时间一致，这时在这个时间点上可能没有数据（但看起来应该有数据，采样频率导致的），因此遇到这种情况就把起始时间的范围以及截止时间的范围都各自扩大一个采样点，这样保证了用户只选取一个阴影格的时候也会有数据。\r\n                  // console.log(tstart,tend,'相等');\r\n                  var adTstart=new Date(tstart).getTime(),adTend=new Date(tend).getTime();\r\n                  if(_this.$store.state.mydatedata.interval=='5m'){//此时interval=='1d' 或者 '1h'的可能性很小，因此没写了\r\n                    adTstart-=5*60*1000;\r\n                    adTend+=5*60*1000;\r\n                  }else if(_this.$store.state.mydatedata.interval=='10s'){\r\n                    adTstart-=10*1000;\r\n                    adTend+=10*1000;\r\n                  }else if(_this.$store.state.mydatedata.interval=='1s'){ //interval=='1s' 采样频率精确到1s，在往下拉也会一直有数据，因此也没写了\r\n                    // adTstart-=1*1000\r\n                    // adTend+=1*1000\r\n                  }\r\n                  tstart = _this.transformMyDate(adTstart);\r\n                  tend = _this.transformMyDate(adTend);\r\n                }\r\n                // console.log(tstart,tend);\r\n\r\n                _this.$store.state.nowTimeVal=[new Date(tstart),new Date(tend)];//改变右上角时间（跟拉到的时间保持一致）\r\n                clearTimeout(_this.$store.state.refreshTimeout)//图表轮询定时器 清除按时刷新数据的定时器\r\n                _this.$store.state.refreshAble=true;//禁用自动刷新\r\n                setTimeout(()=>{\r\n                  _this.$store.commit(types.MYDATEPICKER);\r\n                },0)\r\n              }\r\n            }\r\n          });\r\n        });\r\n      }\r\n      lineTimerFn();\r\n    },\r\n    drawOrgIpPie(){\r\n      var _this=this;\r\n      _this.orgIpPieLoading=true;\r\n      _this.orgIpPieChart = echarts.init(document.getElementById('orgIpPieContainer'));\r\n      var options={\r\n          color:['#516b91','#59c4e6','#edafda','#93b7e3','#a5e7f0','#4ea397','#22c3aa','#7bd9a5','#d0648a','#f58db2'],\r\n          title : {\r\n            text: '恶意访问源IP次数/Top10',\r\n            x:'center',\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip: {\r\n            trigger: 'item',\r\n            formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n          },\r\n          toolbox: {\r\n            right:'10',\r\n            top:'10',\r\n            feature: {\r\n              myTool1: {\r\n                show: true,\r\n                title: '代理IP',\r\n                icon: 'image://static/icon/switch.png',\r\n                onclick: function (){\r\n                  getOrgIpPieData(_this.isPieOrg)\r\n                  // console.log(_this.isPieOrg)\r\n                }\r\n              }\r\n            }\r\n          },\r\n          series: [\r\n            {\r\n              name:'访问来源：',\r\n              type:'pie',\r\n              radius:['25%','35%'],\r\n              // radius: '40%',\r\n              // center: ['50%', '50%'],\r\n              data:[\r\n                // {value:335, name:'直接访问'},\r\n                // {value:310, name:'邮件营销'},\r\n              ].sort(function (a, b) { return a.value - b.value; }),\r\n              // roseType: 'radius',//area radius\r\n              label: {\r\n                position:'outside',\r\n                normal: {\r\n                  textStyle: {\r\n                    fontSize: '12',  \r\n                  },\r\n                  formatter: \"{b}: {c}\"\r\n                },\r\n                emphasis: {\r\n                  show: true,\r\n                  textStyle: {\r\n                    fontSize: '14',\r\n                    fontWeight: 'normal',\r\n                  },\r\n                }\r\n              },\r\n              labelLine: {\r\n                normal: {\r\n                  smooth: 0,\r\n                  length: 10,\r\n                  length2: 20,\r\n                },\r\n              },\r\n              animationType: 'scale',\r\n              animationEasing: 'elasticOut',\r\n              animationDelay: function (idx) {\r\n                return Math.random() * 200;\r\n              }\r\n            }\r\n          ],\r\n        };\r\n      function getOrgIpPieData(type){// 绘制图表\r\n       // let searchIp = '';\r\n        if(type){\r\n          _this.isPieOrg=false;\r\n          _this.searchIp=\"shadow.access.org_remote_ip\";\r\n          options.title.text='恶意访问代理IP次数/Top10';\r\n          options.toolbox.feature.myTool1.title='源IP';\r\n        }else{\r\n          _this.isPieOrg=true;\r\n          _this.searchIp=\"shadow.access.remote_ip\";\r\n          options.title.text='恶意访问源IP次数/Top10';\r\n          options.toolbox.feature.myTool1.title='代理IP';\r\n        }\r\n        var indexName=\"shadow-filebeat-*\";\r\n      if(_this.myChartType=='protectChart'){\r\n        indexName=\"shadow-filebeat-warn*\"\r\n            _this.mustOptions=[{\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }]\r\n          }else if(_this.myChartType=='monitorChart'){\r\n            _this.mustOptions=[\r\n              {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.error_code:>0\"\r\n              }\r\n            },\r\n            {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.response_code:200\"\r\n              }\r\n            },\r\n            {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }\r\n            ]\r\n          };\r\n        client.search({\r\n          index: indexName,\r\n          body: {\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": _this.mustOptions\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"ip\": {\r\n                \"terms\": {\r\n                  \"field\": _this.searchIp,\r\n                  \"size\": 10\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }).then((res)=>{\r\n          // console.log(res);\r\n          var tarResult=res.aggregations?res.aggregations.ip.buckets:[];\r\n          var result=[],legendRlt=[];\r\n          for(var i=0;i<tarResult.length;i++){\r\n            var dataI=tarResult[i];\r\n            result.push(\r\n              {\r\n                value:dataI[\"doc_count\"],\r\n                name:dataI[\"key\"]\r\n              }\r\n            );\r\n            legendRlt.push(dataI[\"key\"])\r\n          }\r\n          options.series[0].data=result;\r\n          // options.legend.data=legendRlt;\r\n          if(result.length==0){\r\n            _this.orgIpPieNodata=true;\r\n          }else{\r\n            _this.orgIpPieNodata=false;\r\n          }\r\n          _this.orgIpPieChart.setOption(options,true);\r\n          _this.orgIpPieLoading=false;\r\n\r\n          _this.orgIpPieChart.off(\"click\");\r\n          _this.orgIpPieChart.on(\"click\",(params)=>{\r\n            //console.log(params);\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            //{\"bool\":{\"must\":[{\"bool\":{\"should\": []}}]}}\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n\r\n            _this.popQueryObj.bool.must=JSON.parse(JSON.stringify(prmoSearchStr[_this.myChartType]['a1']));\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                \"query\": _this.searchIp+\":\"+'\\\"'+_this.logDialogTitle+'\\\"'\r\n              }\r\n            });\r\n            _this.getOnepieceFromPie();\r\n          })\r\n        });\r\n      }\r\n      getOrgIpPieData(); \r\n    },\r\n    drawDomainLine(){\r\n      var _this=this;\r\n      _this.domainLineLoading=true;\r\n      var domainDom=document.getElementById('domainLineContainer');\r\n      _this.domainLineChart = echarts.init(domainDom);\r\n\r\n      _this.domainLineChart.off('brushSelected');//一定要清除brush事件\r\n      var brushFalg = false;//设置一个阀值，鼠标弹起时才触发\r\n      domainDom.addEventListener(\"mousedown\", () => {\r\n        brushFalg=false;\r\n      });\r\n      domainDom.addEventListener(\"mouseup\", () => {\r\n        brushFalg=true;\r\n      });\r\n\r\n      var options = {\r\n          color:['#c1232b','#27727b','#fcce10','#e87c25','#b5c334'],\r\n          title: {\r\n            text: '恶意访问域名次数/Top5',\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip: {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n              type: 'shadow',\r\n              label: {\r\n                show: true\r\n              }\r\n            }\r\n          },\r\n          legend: {\r\n            top:'20px',\r\n            data:[],\r\n          },\r\n          grid: {\r\n            left: '5%',\r\n            right: '3%',\r\n            bottom:'4%',\r\n            top:'25%',\r\n            containLabel: true\r\n          },\r\n          brush: {\r\n            toolbox: ['lineX'],\r\n            xAxisIndex: \"all\",\r\n            transformable:false,\r\n            throttleType:'debounce',\r\n            throttleDelay: 1000,\r\n            brushStyle:{\r\n              borderWidth: 0,\r\n            }\r\n          },\r\n          toolbox: {\r\n            show:false,\r\n            right:'10',\r\n            top:'10'\r\n          },\r\n          xAxis: {\r\n            show:false,\r\n            type: 'category',\r\n            data: [],\r\n          },\r\n          yAxis: {\r\n            show:false,\r\n            type: 'value',\r\n            name:_this.$t('lg.counts'),\r\n            minInterval: 1//保持y轴刻度只为整数\r\n          },\r\n          series: [\r\n            // {\r\n            //     name:'Step Start',\r\n            //     type:'line',\r\n            //     step: 'start',\r\n            //     data:[120, 132, 101, 134, 90, 230, 210]\r\n            // },\r\n            // {\r\n            //     name:'Step Middle',\r\n            //     type:'line',\r\n            //     step: 'middle',\r\n            //     data:[220, 282, 201, 234, 290, 430, 410]\r\n            // },\r\n          ]\r\n      };\r\n      var indexName=\"shadow-filebeat-*\";\r\n      if(_this.myChartType=='protectChart'){\r\n        indexName=\"shadow-filebeat-warn*\"\r\n            _this.mustOptions=[{\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }]\r\n          }else if(_this.myChartType=='monitorChart'){\r\n            _this.mustOptions=[\r\n              {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.error_code:>0\"\r\n              }\r\n            },\r\n            {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.response_code:200\"\r\n              }\r\n            },\r\n            {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }\r\n            ]\r\n          };\r\n      client.search({\r\n        index: indexName,\r\n        body:  {\r\n          \"size\": 0,\r\n          \"query\": {\r\n            \"bool\": {\r\n              \"filter\": _this.filterObj,\r\n              \"must\": _this.mustOptions\r\n            }\r\n          },\r\n          \"aggs\": {\r\n            \"host\": {\r\n              \"terms\": {\r\n                \"field\": \"shadow.access.http_host\",\r\n                \"size\": 5\r\n              },\r\n              \"aggs\": {\r\n                \"time_his\": {                  \r\n                  \"date_histogram\": {\r\n                    \"field\": \"@timestamp\",\r\n                    \"interval\": _this.timeinterval,\r\n                    \"extended_bounds\": {\r\n                      \"min\": _this.fromTime,\r\n                      \"max\": _this.endTime\r\n                    }\r\n                  }\r\n                }        \r\n              }\r\n            }\r\n          }\r\n        }\r\n      }).then((res)=>{\r\n        // console.log(res)\r\n        var tarResult=res.aggregations?res.aggregations.host.buckets:[];\r\n        var legendData=[],seriesData=[];\r\n        if(tarResult.length==0){\r\n          options.xAxis.show=false;\r\n          options.yAxis.show=false;\r\n          options.toolbox.show=false;\r\n          _this.domainLineNodata=true;\r\n        }else{\r\n          options.xAxis.show=true;\r\n          options.yAxis.show=true;\r\n          options.toolbox.show=true;\r\n          _this.domainLineNodata=false;\r\n        }\r\n        for(var i=0;i<tarResult.length;i++){\r\n          var xaxisData=[],valData=[];\r\n          var dataI=tarResult[i];\r\n          legendData.push(dataI.key);\r\n          for(var j=0;j<dataI.time_his.buckets.length;j++){\r\n            var dataJ=dataI.time_his.buckets[j];\r\n            var dataJV=dataJ.doc_count;\r\n            if(!dataJV){\r\n              dataJV=0\r\n            }\r\n            xaxisData.push(_this.transformMyDate(dataJ.key));\r\n            valData.push(dataJV);\r\n          }\r\n          seriesData.push(\r\n            {\r\n              name:dataI.key,\r\n              type:'line',\r\n              // markLine: {\r\n              //     silent: true,\r\n              //     lineStyle:{\r\n              //         type:'solid'\r\n              //     },\r\n              //     data: [{\r\n              //         yAxis: 2\r\n              //     }]\r\n              // },\r\n              data:valData\r\n            }\r\n          );\r\n        }\r\n\r\n        // if(hasline.domiantopline){\r\n        //   seriesData=seriesData.map((item)=>{\r\n        //     item.markLine= {\r\n        //           symbol:\"none\",\r\n        //           silent: true,\r\n        //           lineStyle:{\r\n        //               type:'dashed',\r\n        //               color:'#893448'\r\n        //           },\r\n        //           data: [{\r\n        //               yAxis: _this.domainConditionData\r\n        //           }]\r\n        //       }\r\n        //     return item;\r\n        //   })\r\n        // }\r\n\r\n        options.legend.data=legendData;\r\n        options.xAxis.data=xaxisData;\r\n        options.series=seriesData;\r\n\r\n        //console.log(JSON.stringify(options))\r\n        _this.domainLineChart.setOption(options,true);\r\n        _this.domainLineLoading=false;\r\n\r\n        //brush 操作\r\n        _this.domainLineChart.on('brushSelected', function (params) {\r\n          // console.log(params)\r\n          if(brushFalg){\r\n            if(params.batch && params.batch[0].areas[0]){\r\n              // console.log(params.batch[0])\r\n              var startIndex=params.batch[0].areas[0].coordRange[0]=='-0'||params.batch[0].areas[0].coordRange[0]<0?0:params.batch[0].areas[0].coordRange[0];\r\n              var endIndex=params.batch[0].areas[0].coordRange[1];\r\n              var tstart=xaxisData[startIndex],tend=xaxisData[endIndex]?xaxisData[endIndex]:xaxisData[endIndex-1];\r\n\r\n              if(tstart==tend){ //采样频率稍大时（为'5m'时很容易出现这个问题）,如果用户选定的范围只在一个采样点内（只拉动一个阴影格），会导致起始查询时间和截止查询时间一致，这时在这个时间点上可能没有数据（但看起来应该有数据，采样频率导致的），因此遇到这种情况就把起始时间的范围以及截止时间的范围都各自扩大一个采样点，这样保证了用户只选取一个阴影格的时候也会有数据。\r\n                // console.log(tstart,tend,'相等');\r\n                var adTstart=new Date(tstart).getTime(),adTend=new Date(tend).getTime();\r\n                if(_this.$store.state.mydatedata.interval=='5m'){//此时interval=='1d' 或者 '1h'的可能性很小，因此没写了\r\n                  adTstart-=5*60*1000;\r\n                  adTend+=5*60*1000;\r\n                }else if(_this.$store.state.mydatedata.interval=='10s'){\r\n                  adTstart-=10*1000;\r\n                  adTend+=10*1000;\r\n                }else if(_this.$store.state.mydatedata.interval=='1s'){ //interval=='1s' 采样频率精确到1s，在往下拉也会一直有数据，因此也没写了\r\n                  // adTstart-=1*1000\r\n                  // adTend+=1*1000\r\n                }\r\n                tstart = _this.transformMyDate(adTstart);\r\n                tend = _this.transformMyDate(adTend);\r\n              }\r\n              // console.log(tstart,tend);\r\n\r\n              _this.$store.state.nowTimeVal=[new Date(tstart),new Date(tend)];//改变右上角时间（跟拉到的时间保持一致）\r\n              clearTimeout(_this.$store.state.refreshTimeout)//图表轮询定时器 清除按时刷新数据的定时器\r\n              _this.$store.state.refreshAble=true;//禁用自动刷新\r\n              setTimeout(()=>{\r\n                _this.$store.commit(types.MYDATEPICKER);\r\n              },0)\r\n            }\r\n          }\r\n        });\r\n      });        \r\n    },\r\n    drawDomainPie(){\r\n      var _this=this;\r\n      _this.domainPieLoading=true;\r\n      _this.domainPieChart = echarts.init(document.getElementById('domainPieContainer'));\r\n      var options = {\r\n            color:['#27727b','#fcce10','#e87c25','#b5c334','#60c0dd','#d7504b','#c6e579','#f0805a','#26c0c0','#c1232b'],\r\n            title : {\r\n              text: '恶意访问域名次数/Top10',\r\n              // subtext: 'TOP10',\r\n              // top:'20px',\r\n              x:'center',\r\n              textStyle: {\r\n                fontSize: '16',\r\n                fontWeight: 'normal'\r\n              }\r\n            },\r\n            tooltip: {\r\n              trigger: 'item',\r\n              formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n            },\r\n            // legend: {\r\n            //   orient: 'horizontal',\r\n            //   bottom:'0px',\r\n            //   data:[]\r\n            // },\r\n            series: [\r\n              {\r\n                name:'访问来源：',\r\n                type:'pie',\r\n                radius:['25%','35%'],\r\n                // radius:'40%',\r\n                // center: ['50%', '50%'],\r\n                data:[].sort(function (a, b) { return a.value - b.value; }),\r\n                // roseType: 'radius',//area radius\r\n                label: {\r\n                  position:'outside',\r\n                  normal: {\r\n                    textStyle: {\r\n                      fontSize: '12',  \r\n                    },\r\n                    formatter: \"{b}: {c}\"\r\n                  },\r\n                  emphasis: {\r\n                    show: true,\r\n                    textStyle: {\r\n                      fontSize: '14',\r\n                      fontWeight: 'normal'\r\n                    }\r\n                  }\r\n                },\r\n                labelLine: {\r\n                  normal: {\r\n                    smooth: 0,\r\n                    length: 10,\r\n                    length2: 20,\r\n                  },\r\n                },\r\n                animationType: 'scale',\r\n                animationEasing: 'elasticOut',\r\n                animationDelay: function (idx) {\r\n                  return Math.random() * 200;\r\n                }\r\n              }\r\n            ]\r\n          };\r\n      function getDomainPieData(){\r\n        var indexName=\"shadow-filebeat-*\";\r\n      if(_this.myChartType=='protectChart'){\r\n        indexName=\"shadow-filebeat-warn*\"\r\n            _this.mustOptions=[{\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }]\r\n          }else if(_this.myChartType=='monitorChart'){\r\n            _this.mustOptions=[\r\n              {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.error_code:>0\"\r\n              }\r\n            },\r\n            {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.response_code:200\"\r\n              }\r\n            },\r\n            {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }\r\n            ]\r\n          };\r\n        client.search({\r\n          index: indexName,\r\n          body: {\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": _this.mustOptions\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"url\": {\r\n                \"terms\": {\r\n                  \"field\": \"shadow.access.http_host\",\r\n                  \"size\": 10\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }).then((res)=>{\r\n          // console.log(res);\r\n          var tarResult=res.aggregations?res.aggregations.url.buckets:[];\r\n          var result=[],legendRlt=[];\r\n          for(var i=0;i<tarResult.length;i++){\r\n            var dataI=tarResult[i];\r\n            result.push(\r\n              {\r\n                value:dataI[\"doc_count\"],\r\n                name:dataI[\"key\"]\r\n              }\r\n            );\r\n            legendRlt.push(dataI[\"key\"])\r\n          }\r\n          options.series[0].data=result;\r\n          // options.legend.data=legendRlt;\r\n          \r\n          // console.log(tarResult)\r\n          // console.log(result)\r\n\r\n          if(result.length==0){\r\n            _this.domainPieNodata=true;\r\n          }else{\r\n            _this.domainPieNodata=false;\r\n          }\r\n          _this.domainPieChart.setOption(options,true);\r\n          _this.domainPieLoading=false;\r\n         \r\n          _this.domainPieChart.off(\"click\");\r\n          _this.domainPieChart.on(\"click\",(params)=>{\r\n            // console.log(params);\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n\r\n            _this.popQueryObj.bool.must=JSON.parse(JSON.stringify(prmoSearchStr[_this.myChartType]['a1']));\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                  \"query\":\"shadow.access.http_host:\"+'\\\"'+_this.logDialogTitle.replace(/:/g,'\\\\:')+'\\\"'\r\n                }\r\n            });\r\n            _this.getOnepieceFromPie();\r\n          })\r\n        });\r\n      }\r\n      getDomainPieData();\r\n    },\r\n    drawFingerPie(){\r\n      var _this=this;\r\n      _this.fingerPieLoading=true;\r\n      _this.fingerPieChart = echarts.init(document.getElementById('fingerPieContainer'));\r\n      var option = {\r\n        // color:['#9a7fd1','#588dd5','#f5994e','#c05050','#59678c','#c9ab00','#7eb00a','#6f5553','#c14089','#07a2a4'],\r\n        color:['#b6a2de','#5ab1ef','#ffb980','#d87a80','#8d98b3','#e5cf0d','#97b552','#95706d','#dc69aa','#07a2a4'],\r\n        title : {\r\n          text: '指纹访问记录/Top10',\r\n          x:'center',\r\n          textStyle: {\r\n          fontSize: '16',\r\n          fontWeight: 'normal'\r\n          }\r\n        }, \r\n        tooltip : {    \r\n          trigger: 'item',\r\n          formatter: \"{a} <br/>{b} : {c} ({d}%)\"\r\n        },\r\n        legend: {\r\n          show:_this.fingerPieLegendShow,\r\n          backgroundColor:'#fff',\r\n          orient: 'vertical',\r\n          top:'30',\r\n          right:'right',\r\n          data: []//['视频广告']\r\n        },\r\n        series: \r\n          {\r\n            name: '访问来源',\r\n            type: 'pie',\r\n            radius : '40%',\r\n            center: ['50%', '50%'],\r\n            data:[],//[{value:135, name:'视频广告'}],\r\n            itemStyle: {\r\n              emphasis: {\r\n                shadowBlur: 10,\r\n                shadowOffsetX: 0,\r\n                shadowColor: 'rgba(0, 0, 0, 0.5)'\r\n              }\r\n            },\r\n            label: {\r\n              position:'outside',\r\n              normal: {\r\n                textStyle: {\r\n                  fontSize: '12',  \r\n                },\r\n                formatter: \"{b}: {c}\"\r\n              },\r\n              emphasis: {\r\n                show: true,\r\n                textStyle: {\r\n                  fontSize: '14',\r\n                  fontWeight: 'normal'\r\n                }\r\n              }\r\n            },\r\n            labelLine: {\r\n              normal: {\r\n                smooth: 0,\r\n                length: 10,\r\n                length2: 20,\r\n              },\r\n            },\r\n          }\r\n        };\r\n\r\n      function getFingerPieData(){\r\n        var indexName=\"shadow-filebeat-*\";\r\n      if(_this.myChartType=='protectChart'){\r\n        indexName=\"shadow-filebeat-warn*\"\r\n            _this.mustOptions=[{\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }]\r\n          }else if(_this.myChartType=='monitorChart'){\r\n            _this.mustOptions=[\r\n              {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.error_code:>0\"\r\n              }\r\n            },\r\n            {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.response_code:200\"\r\n              }\r\n            },\r\n            {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }\r\n            ]\r\n          };\r\n        client.search({\r\n          index: indexName,\r\n          body:{\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": _this.mustOptions\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"tokenName\": {\r\n                \"terms\": {\"field\" : \"shadow.access.token\",\"size\": 10}\r\n              }\r\n            }\r\n          }\r\n        }).then((res)=>{\r\n          var tarResult=[],\r\n          tarResult=res.aggregations?res.aggregations.tokenName.buckets:[];\r\n          if(tarResult.length==0){\r\n            _this.fingerPieNodata=true;\r\n          }else{\r\n            _this.fingerPieNodata=false;\r\n          }\r\n          var result=[],legendRlt=[]; \r\n          for(var i=0;i<tarResult.length;i++){\r\n            var dataI=tarResult[i];\r\n              result.push(\r\n              {\r\n                value:dataI[\"doc_count\"],\r\n                name:dataI[\"key\"]\r\n              }\r\n            );\r\n           legendRlt.push(dataI[\"key\"])\r\n          }\r\n          \r\n          option.series.data=result;\r\n          option.legend.data=legendRlt;\r\n          _this.fingerPieChart.setOption(option,true);\r\n          _this.fingerPieLoading=false;\r\n         \r\n          _this.fingerPieChart.off(\"click\");\r\n          _this.fingerPieChart.on(\"click\",(params)=>{\r\n            // console.log(params)\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n           \r\n            _this.popQueryObj.bool.must=JSON.parse(JSON.stringify(prmoSearchStr[_this.myChartType]['a1']));\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                \"query\":\"shadow.access.token:\"+'\\\"'+_this.logDialogTitle+'\\\"'\r\n              }\r\n            });\r\n            _this.getOnepieceFromPie();\r\n          })\r\n        });\r\n      }\r\n      getFingerPieData();\r\n    },\r\n    drawAutoToolPie(){\r\n      var _this=this;\r\n      _this.autoToolPieLoading=true;\r\n      _this.autoToolPieChart = echarts.init(document.getElementById('autoToolPieContainer'));\r\n      var option = {\r\n          title : {\r\n            text: '自动化工具类型/Top10',\r\n            x:'center',\r\n            textStyle: {\r\n            fontSize: '16',\r\n            fontWeight: 'normal'\r\n            }\r\n          }, \r\n          tooltip: {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n              type: 'none'\r\n            },\r\n            formatter: function (params) {\r\n              return params[0].name + ': ' + params[0].value;\r\n            }\r\n          },\r\n          grid: {\r\n            top:'12%',\r\n            left: '-10',\r\n            right: '5%',\r\n            bottom: '10%',\r\n            containLabel: true\r\n          },\r\n          xAxis: {\r\n            show:false,\r\n            data: [],\r\n            axisTick: {show: true},\r\n            axisLine: {show: true},\r\n            axisLabel: {\r\n              textStyle: {\r\n                color: '#e54035',\r\n              },\r\n              interval:0,//横轴信息全部显示  \r\n              rotate:-30,//-30度角倾斜显示  \r\n              // align:'right',\r\n\r\n              // formatter:function(value,index)  \r\n              //   {  \r\n              //       debugger  \r\n              //       if (index % 2 != 0) {  \r\n              //           return '\\n\\n' + value;  \r\n              //       }  \r\n              //       else {  \r\n              //           return value;  \r\n              //       }  \r\n              //   }  \r\n            }\r\n          },\r\n          yAxis: {\r\n            show:false,\r\n          },\r\n          color: ['#e54035'],\r\n          series: [{\r\n            name: 'hill',\r\n            type: 'pictorialBar',\r\n            barCategoryGap: '-5%',\r\n            symbol: 'path://M0,10 L10,10 C5.5,10 5.5,5 5,0 C4.5,5 4.5,10 0,10 z',\r\n            itemStyle: {\r\n              normal: {\r\n                opacity: 0.6\r\n              },\r\n              emphasis: {\r\n                opacity: 1\r\n              }\r\n            },\r\n            data: [],\r\n            // label:{\r\n            //   normal: {\r\n            //     show: true,\r\n            //     position:'top',\r\n            //     color:'#e54035'\r\n            //   }\r\n            // },\r\n            z: 10\r\n          }, {\r\n            name: 'glyph',\r\n            type: 'pictorialBar',\r\n            barGap: '-100%',\r\n            symbolPosition: 'end',\r\n            symbolSize: 5,\r\n            symbolOffset: [0, '-120%'],\r\n            data: []\r\n          }]\r\n        };\r\n\r\n       function getAutoToolPieData(){\r\n         var indexName=\"shadow-filebeat-*\";\r\n      if(_this.myChartType=='protectChart'){\r\n        indexName=\"shadow-filebeat-warn*\"\r\n            _this.mustOptions=[{\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }]\r\n          }else if(_this.myChartType=='monitorChart'){\r\n            _this.mustOptions=[\r\n              {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.error_code:>0\"\r\n              }\r\n            },\r\n            {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.response_code:200\"\r\n              }\r\n            },\r\n            {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }\r\n            ]\r\n          };\r\n        client.search({\r\n          index: indexName,\r\n          body:{\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": _this.mustOptions\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"user_agent\": {\r\n                \"terms\": {\"field\" : \"shadow.access.user_agent.name\",\"size\": 10}\r\n              }\r\n            }\r\n          }\r\n\r\n        }).then((res)=>{\r\n          // console.log(res);\r\n          var tarResult=res.aggregations?res.aggregations.user_agent.buckets:[];\r\n          // tarResult=[\r\n          //   {key: \"Chrome\", doc_count: 778},{key: \"aws\", doc_count: 199},\r\n          //   {key: \"IE\", doc_count: 19},{key: \"OP\", doc_count: 1918},\r\n          //   {key: \"BAI\", doc_count: 879},{key: \"fox\", doc_count: 198},\r\n          // ];\r\n          var seriesData1=[],seriesData2=[],xAxisData=[];\r\n          \r\n          if(tarResult.length>0){\r\n            _this.autoToolPieNodata=false;\r\n            option.xAxis.show=true;\r\n            \r\n            tarResult.forEach(element => {\r\n              xAxisData.push(element.key);\r\n              seriesData1.push(element.doc_count)\r\n              seriesData2.push({value:element.doc_count})\r\n            });\r\n\r\n          }else{\r\n            _this.autoToolPieNodata=true;\r\n            option.xAxis.show=false;\r\n          }\r\n\r\n          option.series[0].data=seriesData1;\r\n          option.series[1].data=seriesData2;\r\n          option.xAxis.data=xAxisData;\r\n\r\n          _this.autoToolPieChart.setOption(option,true);\r\n          _this.autoToolPieLoading=false;\r\n         \r\n          _this.autoToolPieChart.off(\"click\");\r\n          _this.autoToolPieChart.on(\"click\",(params)=>{\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n         \r\n            _this.popQueryObj.bool.must=JSON.parse(JSON.stringify(prmoSearchStr[_this.myChartType]['a1']));\r\n            _this.popQueryObj.bool.must.push({\r\n                  \"query_string\": {\r\n                      \"query\":\"shadow.access.user_agent.name:\"+'\\\"'+_this.logDialogTitle+'\\\"'  \r\n                    }\r\n                });\r\n            _this.getOnepieceFromPie();\r\n          })\r\n\r\n        });\r\n      }\r\n      getAutoToolPieData();\r\n    },\r\n    drawRegionBar2(){//slow\r\n      var _this=this;\r\n      _this.regionBarLoading=true;\r\n      _this.regionBarChart = echarts.init(document.getElementById('regionBarContainer'));\r\n\r\n      //设置‘基于错误码统计的恶意攻击次数/Top10’图的显示文字\r\n      var labelOption = {\r\n            normal: {\r\n              show: true,\r\n              rotate: 0,\r\n              align: 'left',\r\n              verticalAlign: 'middle',\r\n              position: 'insideLeft',\r\n              distance: 10,\r\n              // color:'#000',\r\n              formatter:function(params){\r\n                // console.log(params)\r\n                const str = params.data.name;               \r\n                return str;\r\n              },\r\n              fontSize: 12,\r\n            }\r\n          };\r\n      var option = {\r\n            color:['#e6b600'],\r\n            title: {\r\n              text: _this.$t('lg.geographicinfosourceip'),\r\n              x:'center',\r\n              textStyle: {\r\n                fontSize: '16',\r\n                fontWeight: 'normal'\r\n              }\r\n            },\r\n            tooltip: {\r\n              show:false,\r\n              trigger: 'axis',\r\n              confine:true,\r\n              axisPointer: {\r\n                type: 'shadow'\r\n              },\r\n              extraCssText:'white-space:normal;word-break: break-all',\r\n              formatter:function(params, ticket, callback){\r\n                var str = '';\r\n                params.forEach(item=>{\r\n                  str = item.data.name+'发起恶意访问的次数为:'+item.data.value+_this.$t('lg.count')\r\n                })\r\n                return str;\r\n              }\r\n            },\r\n            toolbox: {\r\n              right:'10',\r\n              top:'10',\r\n              feature: {\r\n                myTool1: {\r\n                  show: true,\r\n                  title: '代理IP',\r\n                  icon: 'image://static/icon/switch.png',\r\n                  onclick: function (){\r\n                    getRegionData(_this.isRegionBarOrg)\r\n                    console.log(_this.isRegionBarOrg)\r\n                  }\r\n                }\r\n              }\r\n            },\r\n            // legend: {\r\n            //   data: [],\r\n            //   top:'30px',\r\n            // },\r\n            grid: {\r\n              top:'12%',\r\n              left: '0',\r\n              right: '50',\r\n              bottom: '2%',\r\n              containLabel: true\r\n            },\r\n            xAxis: {\r\n              show:false,\r\n              type: 'value',\r\n              name:_this.$t('lg.counts'),\r\n              boundaryGap: [0,0.01],\r\n              position:'top',\r\n              splitLine:{\r\n                show:false\r\n              },\r\n              minInterval: 1//保持x轴刻度只为整数\r\n            },\r\n            yAxis: { \r\n              show:false,\r\n              type: 'category',\r\n              data: [],//['top5','top4','top3','top2','top1']\r\n              inverse: true,//是否是反向坐标轴 （这里反向后数据降序排列）\r\n            },\r\n            series: []\r\n          };\r\n          function getRegionData(type){\r\n            if(type){\r\n              _this.isRegionBarOrg=false;\r\n              _this.searchGeoip=\"params._source.shadow.access.org_geoip\";\r\n              _this.mapScript='org_geoip';\r\n              option.title.text=_this.$t('lg.geographicinfoproxyip');\r\n              option.toolbox.feature.myTool1.title=_this.$t('lg.sourceip');\r\n            }else{\r\n              _this.isRegionBarOrg=true;\r\n              _this.searchGeoip=\"params._source.shadow.access.geoip\";\r\n              _this.mapScript='geoip';\r\n              option.title.text=_this.$t('lg.geographicinfosourceip');\r\n              option.toolbox.feature.myTool1.title=_this.$t('lg.agentip');\r\n            }\r\nvar indexName=\"shadow-filebeat-*\";\r\n      if(_this.myChartType=='protectChart'){\r\n        indexName=\"shadow-filebeat-warn*\"\r\n            _this.mustOptions=[{\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }]\r\n          }else if(_this.myChartType=='monitorChart'){\r\n            _this.mustOptions=[\r\n              {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.error_code:>0\"\r\n              }\r\n            },\r\n            {\r\n              \"query_string\": {\r\n                \"query\": \"shadow.access.response_code:200\"\r\n              }\r\n            },\r\n            {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }\r\n            ]\r\n          };\r\n            client.search({\r\n              index: indexName,\r\n              body: {\r\n                \"size\": 0,\r\n                \"query\": {\r\n                  \"bool\": {\r\n                    \"filter\": _this.filterObj,\r\n                    \"must\": _this.mustOptions\r\n                  }\r\n                },\r\n                \"aggs\": {\r\n                  \"GroupByGeo\": {\r\n                    \"terms\": {\r\n                      \"script\": {\r\n                        \"inline\": _this.searchGeoip,//params._source.shadow.access.org_geoip\r\n                        \"lang\": \"painless\"\r\n                      },\r\n                      \"size\": 10\r\n                    },\r\n                    \"aggs\": {\r\n                      \"total_count\": {\r\n                        \"scripted_metric\": {\r\n                          \"init_script\": \"params._agg.count = []\",\r\n                          \"map_script\": \"Map cnt = new HashMap();cnt.put('loc',params['_source']['shadow']['access']['\"+_this.mapScript+\"']);params._agg.count.add(cnt)\",\r\n                          \"combine_script\": \"return params._agg.count.get(0)\",\r\n                          \"reduce_script\": \"return params._aggs.get(0)\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }).then((res)=>{\r\n              // console.log(res);\r\n              var resResult=res.aggregations?res.aggregations.GroupByGeo.buckets:[];\r\n\r\n              let topArrays=[]              //存 ['top5','top4','top3','top2','top1']\r\n              let topArray=resResult.length;               //取前面10位  top10\r\n              for(var i=0;i<topArray;i++){   //遍历出top 数组\r\n                topArrays.push(`top${i+1}`);\r\n              } \r\n              option.yAxis.data=topArrays;\r\n\r\n              var sdata=[];\r\n              for(var i=0; i<topArrays.length;i++){\r\n                if(resResult[i]){\r\n                  const cityName = resResult[i].total_count.value.loc.city_name?resResult[i].total_count.value.loc.city_name:'['+resResult[i].total_count.value.loc.location.lon+','+resResult[i].total_count.value.loc.location.lat+']';\r\n                  sdata.push({\r\n                    value:resResult[i].doc_count,\r\n                    name:cityName,\r\n                  });\r\n                }\r\n              }\r\n              option.series=[{          \r\n                type: 'bar',\r\n                label: labelOption,\r\n                data:sdata,\r\n                barMaxWidth:30,\r\n              }]\r\n              // console.log(option.series)\r\n              if(resResult.length==0){\r\n                option.xAxis.show=false;\r\n                option.yAxis.show=false;\r\n                option.tooltip.show=false;\r\n                _this.regionBarNodata=true;\r\n              }else{\r\n                option.xAxis.show=true;\r\n                option.yAxis.show=true;\r\n                option.tooltip.show=true;\r\n                _this.regionBarNodata=false;\r\n              }\r\n              _this.regionBarChart.setOption(option,true);\r\n              _this.regionBarLoading=false;\r\n\r\n              _this.regionBarChart.off(\"click\");\r\n              _this.regionBarChart.on(\"click\",(params)=>{\r\n                // console.log(params)\r\n                _this.logDialogVisible=true;\r\n                _this.logDialogTitle=params.name;\r\n                _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n              \r\n                _this.popQueryObj.bool.must=JSON.parse(JSON.stringify(prmoSearchStr[_this.myChartType]['a1']));\r\n\r\n                if(/^\\[.+\\]$/.test(params.name)){//没有city_name 就用经纬度查\r\n                  var locationArr = JSON.parse(params.name)\r\n                  var lonNum = locationArr[0],latNum = locationArr[1];\r\n                  var mapScriptStr = \"shadow.access.\"+_this.mapScript+\".location\";\r\n\r\n                  var filterGeo ={};\r\n                  filterGeo.distance=\"1mm\";\r\n                  filterGeo[mapScriptStr]={\r\n                    \"lat\" : latNum,\r\n                    \"lon\" : lonNum\r\n                  }\r\n\r\n                  if(!_this.popQueryObj.bool.filter.bool){//如果没有查询面板的过滤条件\r\n                    _this.popQueryObj.bool.filter={\"bool\":{\"must\":[]}}\r\n                    _this.popQueryObj.bool.filter.bool.must.push({\r\n                      \"geo_distance\" : filterGeo\r\n                    });\r\n                  }else{\r\n                    _this.popQueryObj.bool.filter.bool.must.push({\r\n                      \"geo_distance\" : filterGeo\r\n                    });\r\n                  }\r\n                }else{\r\n                  _this.popQueryObj.bool.must.push({//有city_name 就用city_name查\r\n                  \"query_string\": {\r\n                      \"query\":\"shadow.access.\"+_this.mapScript+\".city_name:\"+_this.logDialogTitle\r\n                    }\r\n                  });\r\n                }\r\n\r\n                _this.getOnepieceFromPie();\r\n              });\r\n            });\r\n          }\r\n      getRegionData();\r\n    },\r\n\r\n    drawRegionBar(){//地域信息\r\n      var _this=this;\r\n      _this.regionBarLoading=true;\r\n      _this.regionBarChart = echarts.init(document.getElementById('regionBarContainer'));\r\n      var options = {\r\n          color:['#3fb1e3','#6be6c1','#626c91','#a0a7e6','#91ca8c','#96dee8','#4ea397','#22c3aa','#97b552','#9a7fd1'],\r\n          title: {\r\n            text: _this.$t('lg.geographicinfosourceip'),\r\n            x:'center',\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip: {\r\n            trigger: 'item',\r\n            formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n          },\r\n          toolbox: {\r\n            right:'10',\r\n            top:'10',\r\n            feature: {\r\n              myTool1: {\r\n                show: true,\r\n                title: _this.$t('lg.agentip'),\r\n                icon: 'image://static/icon/switch.png',\r\n                onclick: function (){\r\n                  getRegionSunburstData(_this.isRegionPieOrg)\r\n                }\r\n              }\r\n            }\r\n          },\r\n          series: {\r\n            type:'pie',\r\n            radius:['25%','35%'],\r\n            data: [].sort(function (a, b) { return a.value - b.value; }),\r\n            label: {\r\n              position:'outside',\r\n              normal: {\r\n                textStyle: {\r\n                  fontSize: '12',  \r\n                },\r\n                formatter: \"{b}: {c}\"\r\n              },\r\n              emphasis: {\r\n                show: true,\r\n                textStyle: {\r\n                  fontSize: '14',\r\n                  fontWeight: 'normal'\r\n                }\r\n              }\r\n            },\r\n            labelLine: {\r\n              normal: {\r\n                smooth: 0,\r\n                length: 10,\r\n                length2: 20,\r\n              },\r\n            },\r\n            animationType: 'scale',\r\n            animationEasing: 'elasticOut',\r\n            animationDelay: function (idx) {\r\n              return Math.random() * 200;\r\n            }\r\n          }\r\n        };\r\n\r\n      function getRegionSunburstData(type){\r\n        if(type){\r\n          _this.isRegionPieOrg=false;\r\n          _this.searchGeoip=\"params._source.shadow.access.org_geoip\";\r\n          _this.mapScript='org_geoip';\r\n          options.title.text=_this.$t('lg.geographicinfoproxyip');\r\n          options.toolbox.feature.myTool1.title=_this.$t('lg.sourceip');\r\n        }else{\r\n          _this.isRegionPieOrg=true;\r\n          _this.searchGeoip=\"params._source.shadow.access.geoip\";\r\n          _this.mapScript='geoip';\r\n          options.title.text=_this.$t('lg.geographicinfosourceip');\r\n          options.toolbox.feature.myTool1.title=_this.$t('lg.agentip');\r\n        }\r\n        client.search({\r\n           index: \"shadow-filebeat-warn*\",\r\n           body:{\r\n             \"track_total_hits\": true, \r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": [ {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": _this.fromTime,\r\n                      \"lte\": _this.endTime\r\n                    }\r\n                  }\r\n                }]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n                \"GroupByGeo\": {\r\n                  \"terms\": {\r\n                    \"script\": {\r\n                      \"lang\": \"painless\",\r\n                    //\"source\": \"params._source.shadow.access.geoip.city_name+';'+params._source.shadow.access.geoip.location.lon+', '+params._source.shadow.access.geoip.location.lat\"\r\n                      \"source\": _this.searchGeoip+\".city_name+';'+\"+_this.searchGeoip+\".location.lon+', '+\"+_this.searchGeoip+\".location.lat\"\r\n                    }, \r\n                    \"field\": _this.searchGeoip2+\".city_name\"\r\n                  }//,\r\n                  // \"aggs\": {\r\n                  //   \"GroupByIp\": {\r\n                  //     \"terms\": {\r\n                  //       \"field\": _this.searchIp,\r\n                  //       \"size\": 10\r\n                  //     }\r\n                  //   }\r\n                  // }\r\n                }\r\n              }\r\n          }\r\n\r\n        }).then((res)=>{\r\n          var buckets=res.aggregations?res.aggregations.GroupByGeo.buckets:[];\r\n          var seriesData=[];\r\n          buckets.forEach(element=>{//过滤掉没返回city_name的数据\r\n              var ikeynamearr=element.key.split(\";\");\r\n              var ikeyname=ikeynamearr[0];\r\n              var ikey=ikeynamearr[1].split(\",\").map(keyitem=>{return parseInt(keyitem,10)});\r\n              var ikeycount=element.doc_count;\r\n             // var ikey=element.key.match(/-*\\d+(\\.\\d+)*/g).map(keyitem=>{return parseInt(keyitem,10)});\r\n              seriesData.push({\r\n               // \"name\":JSON.stringify(ikey),\r\n                \"name\":ikeyname,\r\n                \"value\":ikeycount\r\n              });\r\n             \r\n            });\r\n          if(seriesData.length==0){\r\n            _this.regionBarNodata=true;\r\n          }else{\r\n            _this.regionBarNodata=false;\r\n          }\r\n\r\n          options.series.data=seriesData;\r\n          _this.regionBarChart.setOption(options,true);\r\n          _this.regionBarLoading=false;\r\n\r\n          _this.regionBarChart.off(\"click\");\r\n          _this.regionBarChart.on(\"click\",(params)=>{\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n            // _this.popQueryObj.bool.must.push({\r\n            //   \"query_string\": {\r\n            //           \"query\":\"shadow.access.error_code:0\"  \r\n            //         }\r\n            // });\r\n            // _this.popQueryObj.bool.must.push({\r\n            //   \"query_string\": {\r\n            //           \"query\":\"shadow.access.response_code:200\"\r\n            //         }\r\n            // });\r\n            // _this.popQueryObj.bool.must.push({\r\n            //   \"query_string\": {\r\n            //           \"query\": \"shadow.access.decrypted:1\"\r\n            //         }\r\n            // });\r\n\r\n            // console.log(_this.logDialogTitle)\r\n            if(/^\\[.+\\]$/.test(params.name)){//没有city_name 就用经纬度查\r\n              var locationArr = JSON.parse(params.name)\r\n              var lonNum = locationArr[0],latNum = locationArr[1];\r\n              var mapScriptStr = \"shadow.access.\"+_this.mapScript+\".location\";\r\n\r\n              var filterGeo ={};\r\n              filterGeo.distance=\"1mm\";\r\n              filterGeo[mapScriptStr]={\r\n                \"lat\" : latNum,\r\n                \"lon\" : lonNum\r\n              }\r\n\r\n              if(!_this.popQueryObj.bool.filter.bool){//如果没有查询面板的过滤条件\r\n                _this.popQueryObj.bool.filter={\"bool\":{\"must\":[]}}\r\n                _this.popQueryObj.bool.filter.bool.must.push({\r\n                  \"geo_distance\" : filterGeo\r\n                });\r\n              }else{\r\n                _this.popQueryObj.bool.filter.bool.must.push({\r\n                  \"geo_distance\" : filterGeo\r\n                });\r\n              }\r\n            }else{\r\n              _this.popQueryObj.bool.must.push({//有city_name 就用city_name查\r\n              \"query_string\": {\r\n                  \"query\":\"shadow.access.\"+_this.mapScript+\".city_name:\"+_this.logDialogTitle\r\n                }\r\n              });\r\n            }\r\n            _this.getOnepieceFromPie();\r\n          })\r\n\r\n        });\r\n      }\r\n      getRegionSunburstData();\r\n\r\n    },\r\n\r\n    fullScreen(){//大屏展示\r\n      var chartGridDom = document.getElementsByClassName('visitChart-wrapper');\r\n      chartGridDom[0].requestFullscreen();\r\n\r\n      window.addEventListener(\"fullscreenchange\", (e) => {\r\n        if (document.fullscreenElement) {\r\n          // console.log('进入全屏')\r\n          this.isShowQueryPanel = false;\r\n          this.isShowGridMenu = false;\r\n        } else {\r\n          // console.log('退出全屏')\r\n          this.isShowQueryPanel = true;\r\n          this.isShowGridMenu = true;\r\n        }\r\n      })\r\n    },\r\n    downLoadPdf(){//导出数据图为pdf文件\r\n      if(this.attackSumNum!=0){\r\n        const myChart1Str = this.businessLineChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        let myChart2Str;\r\n        let myChart11Str;\r\n        if(this.forFastShow){\r\n          myChart2Str = this.urlVisitCtBarChart.getDataURL({\r\n            type:'jpeg',\r\n            pixelRatio: 2,\r\n            backgroundColor: '#fff',\r\n          }).replace(\"data:image/jpeg;base64,\",\"\");\r\n          myChart11Str = this.regionBarChart.getDataURL({\r\n            type:'jpeg',\r\n            pixelRatio: 2,\r\n            backgroundColor: '#fff',\r\n          }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        }\r\n\r\n        const myChart3Str = this.eCodeTypeChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart5Str = this.orgIpLineChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart6Str = this.orgIpPieChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart7Str = this.domainLineChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart8Str = this.domainPieChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart9Str = this.fingerPieChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart10Str = this.autoToolPieChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        \r\n        let myCharArray;\r\n        if(myChart2Str && myChart11Str){\r\n          myCharArray = [myChart1Str,myChart2Str,myChart3Str,myChart5Str,myChart6Str,myChart7Str,myChart8Str,myChart9Str,myChart10Str,myChart11Str]; \r\n        }else{\r\n          myCharArray = [myChart1Str,myChart3Str,myChart5Str,myChart6Str,myChart7Str,myChart8Str,myChart9Str,myChart10Str]; \r\n        }\r\n        const url = SERVER_API_URL + 'pe/download/conversion/jpg2pdf';\r\n        axios.post(url,{\r\n          base64StringList:myCharArray\r\n        },{\r\n          responseType:'blob'\r\n        }).then((res)=>{\r\n          //  console.log(res)\r\n          if(res.status==200){\r\n            var filename = '恶意访问数据图表.pdf';\r\n            this.$store.commit(types.MAKEPDF,{'pdfdata':res.data,'pdfname':filename});\r\n          }\r\n        }).catch((err)=>{\r\n          console.log(err);\r\n        });\r\n      }else{\r\n        this.$message.error('暂无可导出数据');\r\n      }\r\n    },\r\n    goBackMap(){//返回地图\r\n      this.$router.push('/visit')\r\n    },\r\n    \r\n    //日志弹框\r\n    getChangeLogData(pageObj){ //改变分页返回数据\r\n      this.fromPage = pageObj.curPage-1;\r\n      this.pageSize= pageObj.pageNum;\r\n      this.requeryObj?this.getOnepieceFromPie(this.requeryObj):this.getOnepieceFromPie();\r\n    },\r\n    getOnepieceFromPie(requeryObj){//恶意访问 获取access.log表体数据\r\n      var _this=this;\r\n      // console.log(_this.popQueryObj);\r\n\r\n      let clientQueryObj = JSON.parse(JSON.stringify(_this.popQueryObj));//清空（清空方法本身加的查询条件，但同时保存了外部查询条件）\r\n      clientQueryObj.bool.must.push(\r\n        {\r\n          \"range\": {\r\n            \"@timestamp\": {\r\n              \"gte\": _this.fromTime,\r\n              \"lte\": _this.endTime\r\n            }\r\n          }\r\n        }\r\n      );\r\n      if(requeryObj){//双重过滤（顶部查询面板以及日志弹框里面的requery子组件查询。要把这两者的查询语句融汇在一起）\r\n        // console.log(requeryObj);\r\n        const requeryArr = requeryObj.bool.must;\r\n        // _this.popQueryObj.bool.filter={..._this.popQueryObj.bool.filter,...requeryObj}\r\n\r\n        if(clientQueryObj.bool.filter.bool){\r\n          requeryArr.forEach((item)=>{\r\n            clientQueryObj.bool.filter.bool.must.push(item);\r\n          })\r\n        }else{\r\n          clientQueryObj.bool.filter={\"bool\":{\"must\":[]}}\r\n          requeryArr.forEach((item)=>{\r\n            clientQueryObj.bool.filter.bool.must.push(item);\r\n          })\r\n        }\r\n      }\r\n      // console.log(clientQueryObj)\r\n      client.search({\r\n        index:\"shadow-filebeat*\",\r\n        body:{\r\n          \"from\":_this.fromPage*_this.pageSize,\r\n          \"size\": _this.pageSize,\r\n          \"sort\": {\r\n            \"@timestamp\": \"desc\"\r\n          },\r\n          \"query\": clientQueryObj\r\n        }\r\n      }).then((res2)=>{\r\n        _this.chartLogsTotalNum=res2.hits.total.value;\r\n        let logResArr = res2.hits.hits;\r\n\r\n        // 获取access.log表体数据\r\n        _this.chartLogsBodyData = handleAccesslogData(logResArr);\r\n      })\r\n    },\r\n    requeryRowByAccess(obj){ //用户通过requery孙组件筛选access.log显示的行\r\n      this.requeryObj=obj.requeryObj; //记录用户再次查询日志的 查询语句\r\n      this.fromPage=0;\r\n      this.getOnepieceFromPie(this.requeryObj);\r\n      if(this.$refs.log_tables) this.$refs.log_tables.tabCurPage=1;//当用户点击查询后，查询结果的页码要回到第一页\r\n    },\r\n    refilterColByAccess(obj){  //用户通过refilter孙组件筛选access.log显示的列，删除或者增加字段显示的时候变化头部，发送用户增删请求\r\n      var url = SERVER_API_URL + '/pe/shadow/kv';\r\n      axios.post(url,{visitChartAccess:obj}).then(res=>{\r\n        if(Object.keys(res.data.data.Failure)){\r\n          axios.patch(url,{visitChartAccess:obj}).then(res=>{\r\n          })\r\n        }\r\n      })\r\n      this.chartLogsHeadData = obj;\r\n    },\r\n    showSDURLMenu(index) { //右键点击对应字段 显示 表里面该字段的菜单\r\n      this.chartLogsBodyData.forEach(items => {\r\n        items.showUMenuList = false;\r\n      });\r\n      // this.accesslogsData[index].showUMenuList=true;\r\n      this.$set(this.chartLogsBodyData[index], \"showUMenuList\", true);\r\n    },\r\n    hideSDURLMenu() { //左键任意点击全局 隐藏 表里面字段的菜单\r\n      this.chartLogsBodyData.forEach(items => {\r\n        items.showUMenuList = false;\r\n      });\r\n    },\r\n    logDialogClose(){//关闭日志弹框\r\n      this.logDialogVisible=false;\r\n      this.logDialogTitle='';\r\n      this.fromPage=0;\r\n      this.chartLogsTotalNum=0;\r\n      this.popQueryObj={\"bool\":{\"must\":[{\"bool\":{\"should\": []}}]}};\r\n      this.broadcast('logRequery',\"clearData\");//清空孙组件里logRequry的查询条件输入框里的内容，要引入Emitter\r\n      this.requeryObj=null;//清空孙组件里logRequry的被带入日志查询语句的查询条件\r\n    },\r\n    //数据处理函数\r\n    transformMyDate(d){\r\n      d=new Date(d);\r\n      function pad(n){\r\n        return n<10 ? '0'+n : n\r\n      }\r\n      return pad(d.getFullYear())+\"-\"+pad(parseInt(d.getMonth())+1)+\"-\"+pad(d.getDate())+\" \"+pad(d.getHours())+':' + pad(d.getMinutes())+':' + pad(d.getSeconds());//+':' + pad(d.getSeconds())\r\n    },\r\n  },\r\n  beforeDestroy(){\r\n    window.removeEventListener('resize',function(){});\r\n  }\r\n}\r\n</script>\r\n<style>\r\n.fastloadmore{text-align:center; background-color:#f5f5f5; padding:10px; cursor:pointer}\r\n.visitChart-wrapper{\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  padding: 15px;\r\n  box-sizing: border-box;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.visitChartContent{\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n  padding-right: 10px;\r\n}\r\n\r\n/*图表*/\r\n.chartRow{\r\n  margin-bottom: 10px;\r\n}\r\n.chartRowBusi{\r\n  margin-left: 0px!important;\r\n}\r\n#urlVisitCtBarContainer,#eCodeTypeContainer,#orgIpLineContainer,#domainLineContainer,#orgIpPieContainer,#domainPieContainer,#fingerPieContainer,#autoToolPieContainer,#regionBarContainer{\r\n  width: 100%;\r\n  height: 310px;\r\n  padding: 10px;\r\n  box-sizing: border-box;\r\n}\r\n/*业务表 max min*/\r\n.busiChartBox{\r\n  padding: 10px;\r\n  box-sizing: border-box;\r\n  background: #f7f7f7;\r\n}\r\n#businessContainer{\r\n  width: 100%;\r\n  height: 290px;\r\n}\r\n.busiNumBox{\r\n  background: #fff;\r\n  height: 290px;\r\n  padding: 30px 10px !important;\r\n  box-sizing: border-box;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n.busiNumBox2{\r\n  background: #f7f7f7;\r\n  height: 310px;\r\n  padding: 30px !important;\r\n  box-sizing: border-box;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n.totalList{\r\n  margin-bottom: 20px;\r\n}\r\n.totalList li{\r\n  color: #27727b;\r\n  margin-bottom: 10px;\r\n  line-height: 15px;\r\n}\r\n.someList li{\r\n  color: #e87c25;\r\n  margin-bottom: 10px;\r\n  line-height: 15px;\r\n}\r\n.totalList .listTitle,.someList .listTitle{\r\n  color: #606266;\r\n  margin-bottom: 15px;\r\n  padding-left: 0px;\r\n}\r\n.liLable{\r\n  font-size: 12px;\r\n  font-style:italic;\r\n  padding-left: 10px;\r\n}\r\n.liValue{\r\n  text-align: center;\r\n  font-size: 1.2vw;\r\n}\r\n/*次数显示&业务表*/\r\n.numBox{\r\n  width: 100%;\r\n  height: 310px;\r\n  padding: 10px;\r\n  box-sizing: border-box;\r\n  /* box-shadow: 2px 2px 5px #ccc; */\r\n}\r\n.numBoxTitle{\r\n  font-size: 16px;\r\n  color: #333;\r\n}\r\n.totalBox {\r\n  margin-top: 20px;\r\n  height: 80px;\r\n}\r\n.abnormalBox{\r\n  margin-top: 30px;\r\n  height: 100px;\r\n}\r\n.numTitle{\r\n  padding-left: 10px;\r\n  color: #606266; \r\n}\r\n.totalNum{\r\n  margin-left: 20%;\r\n  font-size: 2.5vw;\r\n  color: #516b91;\r\n  line-height: 60px;\r\n}\r\n.abnormalNum{\r\n  text-align: center;\r\n  font-size: 4vw;\r\n  color: #d95850;\r\n  line-height: 90px;\r\n}\r\n.uTxt{\r\n  font-size: 14px;\r\n  color: #606266;\r\n}\r\n\r\n/*pei图暂无数据*/\r\n.adaptive-circle {\r\n  margin: 50px auto 0;\r\n  width: 22%;\r\n  height: 0;\r\n  padding-top: 22%;\r\n  border-radius: 100%;\r\n  box-sizing: border-box;\r\n  background:#fff;\r\n  position:absolute;\r\n  top:15%;\r\n  left:40%;\r\n}\r\n.fingerPie-circle{\r\n  margin: 0;\r\n  width: 15%;\r\n  left:42%;\r\n  top:30%;\r\n  padding-top: 15%;\r\n}\r\n.adaptive-circle .layout {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  text-align: center;\r\n}\r\n.adaptive-circle .layout.middle:before {\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n  content: '';\r\n  height: 100%;\r\n  width: 0;\r\n  overflow: hidden;\r\n}\r\n.adaptive-circle .layout.middle div:first-child {\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n}\r\n\r\n/*导出数据图表*/\r\n/* .downBtn{\r\n  position: fixed;\r\n  bottom: 20px;\r\n  right: 50px;\r\n  padding: 5px;\r\n}\r\n.goBackBtn{\r\n  position: fixed;\r\n  bottom: 50px;\r\n  right: 50px;\r\n  padding: 5px;\r\n}\r\n.downBtn a,.goBackBtn a{\r\n  font-size: 15px;\r\n} */\r\n\r\n/* loading 主要针对‘自定义图表’的loading */\r\n.visitChart-wrapper .el-loading-spinner{\r\n  padding: 3px;\r\n  box-sizing: border-box;\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  text-align: right;\r\n  margin-top: 0;\r\n}\r\n.visitChart-wrapper .el-loading-spinner i{\r\n  color: #242222;\r\n  font-size: 18px;\r\n}\r\n</style>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/home/visitChart.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"visitChart-wrapper\",on:{\"click\":_vm.hideSDURLMenu}},[_c('query-panel',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowQueryPanel),expression:\"isShowQueryPanel\"}],attrs:{\"myChartType\":_vm.myChartType},on:{\"getAllQuerychart\":_vm.getAllchart,\"getChartTypeAllQuery\":_vm.getChartTypeAllQuery,\"handleTime\":_vm.handleTime}}),_vm._v(\" \"),_c('div',{staticClass:\"visitChartContent\"},[_c('el-row',{staticClass:\"chartRow chartRowBusi\",attrs:{\"gutter\":10}},[_c('el-col',{staticStyle:{\"padding-left\":\"0px\"},attrs:{\"span\":20}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.businessLineLoading),expression:\"businessLineLoading\"}],staticClass:\"chart-content\",staticStyle:{\"padding\":\"15px\",\"box-sizing\":\"border-box\"},attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.businessNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{ref:\"businessContainer\",attrs:{\"id\":\"businessContainer\"}})],1)]),_vm._v(\" \"),_c('el-col',{staticClass:\"busiNumBox\",attrs:{\"span\":4}},[_c('ul',{staticClass:\"totalList\"},[_c('li',{staticClass:\"listTitle\"},[_vm._v(\"总请求数：\")]),_vm._v(\" \"),_c('li',[_c('i',{staticClass:\"liLable\"},[_vm._v(\"MAX:\")]),_vm._v(\" \"),_c('p',{staticClass:\"liValue\"},[_vm._v(_vm._s(_vm.wholeCtMax))])]),_vm._v(\" \"),_c('li',[_c('i',{staticClass:\"liLable\"},[_vm._v(\"MIN:\")]),_vm._v(\" \"),_c('p',{staticClass:\"liValue\"},[_vm._v(_vm._s(_vm.wholeCtMin))])])]),_vm._v(\" \"),_c('ul',{staticClass:\"someList\"},[_c('li',{staticClass:\"listTitle\"},[_vm._v(\"恶意访问：\")]),_vm._v(\" \"),_c('li',[_c('i',{staticClass:\"liLable\"},[_vm._v(\"MAX:\")]),_vm._v(\" \"),_c('p',{staticClass:\"liValue\"},[_vm._v(_vm._s(_vm.normalCtMax))])]),_vm._v(\" \"),_c('li',[_c('i',{staticClass:\"liLable\"},[_vm._v(\"MIN:\")]),_vm._v(\" \"),_c('p',{staticClass:\"liValue\"},[_vm._v(_vm._s(_vm.normalCtMin))])])])])],1),_vm._v(\" \"),_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":16}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.orgIpLineLoading),expression:\"orgIpLineLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.orgIpLineNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"orgIpLineContainer\"}})],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":8}},[_c('div',{staticClass:\"chart-content numBox txtOverflow\"},[_c('p',{staticClass:\"text-center numBoxTitle\",staticStyle:{\"padding-top\":\"10px\"}},[_vm._v(\"总数据量\")]),_vm._v(\" \"),_c('div',{staticClass:\"totalBox\"},[_c('p',{staticClass:\"numTitle\"},[_vm._v(\"请求总量\")]),_vm._v(\" \"),_c('p',{staticClass:\"totalNum\"},[_vm._v(_vm._s(_vm.totalNum)),_c('span',{staticClass:\"uTxt\"},[_vm._v(\"次\")])])]),_vm._v(\" \"),_c('div',{staticClass:\"abnormalBox\"},[_c('p',{staticClass:\"numTitle\"},[_vm._v(\"恶意访问总量\")]),_vm._v(\" \"),_c('p',{staticClass:\"abnormalNum\"},[_vm._v(_vm._s(_vm.attackSumNum)),_c('span',{staticClass:\"uTxt\"},[_vm._v(\"次\")])])])])])],1),_vm._v(\" \"),_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":16}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.domainLineLoading),expression:\"domainLineLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.domainLineNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"domainLineContainer\"}})],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":8}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.domainPieLoading),expression:\"domainPieLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.domainPieNodata)?_c('div',{staticClass:\"adaptive-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(\"暂无数据\")])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"domainPieContainer\"}})])])],1),_vm._v(\" \"),_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":16}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.eCodeTypeLoading),expression:\"eCodeTypeLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.eCodeTypeNodata)?_c('div',{staticClass:\"adaptive-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(\"暂无数据\")])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"eCodeTypeContainer\"}})])]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":8}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.orgIpPieLoading),expression:\"orgIpPieLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.orgIpPieNodata)?_c('div',{staticClass:\"adaptive-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(\"暂无数据\")])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"orgIpPieContainer\"}})])])],1),_vm._v(\" \"),_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":14}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.fingerPieLoading),expression:\"fingerPieLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.fingerPieNodata)?_c('div',{staticClass:\"adaptive-circle fingerPie-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(\"暂无数据\")])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"fingerPieContainer\"}})])]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":10}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.autoToolPieLoading),expression:\"autoToolPieLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.autoToolPieNodata)?_c('div',{staticClass:\"adaptive-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(\"暂无数据\")])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"autoToolPieContainer\"}})])])],1),_vm._v(\" \"),(_vm.forFastShow)?_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":24}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.urlVisitCtLoading),expression:\"urlVisitCtLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.urlVisitCtBarNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"urlVisitCtBarContainer\"}})],1)])],1):_vm._e(),_vm._v(\" \"),(_vm.forFastShow)?_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":12}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.regionBarLoading),expression:\"regionBarLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.regionBarNodata)?_c('div',{staticClass:\"adaptive-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(_vm._s(_vm.$t('lg.nodata')))])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"regionBarContainer\"}})])]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":10}})],1):_vm._e(),_vm._v(\" \"),_c('div',[(!_vm.forFastShow)?_c('p',{staticClass:\"fastloadmore\",on:{\"click\":_vm.forfastloadmore}},[_vm._v(\"点击查看更多图表\")]):_vm._e()])],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":_vm.logDialogTitle,\"visible\":_vm.logDialogVisible,\"width\":\"80%\",\"before-close\":_vm.logDialogClose},on:{\"update:visible\":function($event){_vm.logDialogVisible=$event}}},[_c('log-rebuild',{attrs:{\"tableKeyArr\":_vm.tableKeyArrAccess,\"dynamicTag\":_vm.chartLogsHeadData},on:{\"refilterColBy\":_vm.refilterColByAccess,\"requeryRowBy\":_vm.requeryRowByAccess}}),_vm._v(\" \"),(_vm.chartLogsTotalNum==0)?_c('div',{staticClass:\"nodata-box\"},[_vm._v(\"暂无数据\")]):_vm._e(),_vm._v(\" \"),(_vm.chartLogsTotalNum>0)?_c('div',{staticClass:\"logTableHeight\"},[_c('log-tables',{ref:\"log_tables\",attrs:{\"tabheadData\":_vm.chartLogsHeadData,\"tabodyData\":_vm.chartLogsBodyData,\"totalNum\":_vm.chartLogsTotalNum,\"isLogLoding\":false,\"showSDURLMenu\":_vm.showSDURLMenu},on:{\"getChangeLogData\":_vm.getChangeLogData}})],1):_vm._e()],1),_vm._v(\" \"),_c('ul',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowGridMenu),expression:\"isShowGridMenu\"}],staticClass:\"operationBtnUl\"},[_c('li',[_c('img',{attrs:{\"src\":\"static/icon/fullScreen.png\",\"alt\":\"大屏展示\",\"title\":\"大屏展示\"},on:{\"click\":_vm.fullScreen}})]),_vm._v(\" \"),_c('li',[_c('img',{attrs:{\"src\":\"static/icon/downpdfChart.png\",\"alt\":\"导出pdf\",\"title\":\"导出pdf\"},on:{\"click\":_vm.downLoadPdf}})]),_vm._v(\" \"),_c('li',[_c('img',{attrs:{\"src\":\"static/icon/map.png\",\"alt\":\"返回地图\",\"title\":\"返回地图\"},on:{\"click\":_vm.goBackMap}})])])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-550bbc7e\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/home/visitChart.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-550bbc7e\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./visitChart.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./visitChart.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./visitChart.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-550bbc7e\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./visitChart.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/home/visitChart.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}