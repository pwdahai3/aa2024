webpackJsonp([39],{"Mk+W":function(a,t){},OZwX:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=e("mvHQ"),i=e.n(s),r=e("mtWM"),l=e.n(r),m=e("yJCr"),o={data:function(){return{noEmaildata:!1,eidtDisabled:!0,mailid:"",mailParamForm:{enabled:!0,smtpHost:"",smtpPort:"",smtpUsername:"",smtpPassword:"",recipient:{defaultRecipient:[{defaultAdress:""}]}},mailParamFormRules:{smtpUsername:[{required:!0,message:this.$t("lg.required"),trigger:"blur"},{pattern:/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/,message:"邮箱格式有误",trigger:"blur"}],smtpPassword:[{required:!0,message:this.$t("lg.required"),trigger:"blur"}],smtpHost:[{required:!0,message:this.$t("lg.required"),trigger:"blur"}],smtpPort:[{required:!0,message:this.$t("lg.required"),trigger:"blur"},{pattern:/^([0-9]|[1-9]\d{1,3}|[1-5]\d{4}|6[0-5]{2}[0-3][0-5])$/,message:"非合法端口号",trigger:"change"}]}}},created:function(){this.$store.state.contentLoading=!0,this.roMailnotify()},methods:{roMailnotify:function(){var a=this,t=m.b+"monitoring/mailparam";l.a.get(t).then(function(t){if(0==t.data.responseCode){var e=t.data.data.mailParam;a.mailid=t.data.data.id,a.mailParamForm.smtpHost=e.smtpHost,a.mailParamForm.smtpPort=e.smtpPort,a.mailParamForm.smtpPassword=e.smtpPassword,a.mailParamForm.smtpUsername=e.smtpUsername;var s=[];(e.recipient.defaultRecipient||[]).forEach(function(a,t){s.push({defaultAdress:a})}),0==s.length&&(s=[{defaultAdress:""}]),a.mailParamForm.recipient.defaultRecipient=s,a.mailParamForm.smtpHost||a.mailParamForm.smtpPort||a.mailParamForm.smtpPassword||a.mailParamForm.smtpUsername||0!=a.mailParamForm.recipient.defaultRecipient.length?a.noEmaildata=!1:a.noEmaildata=!0}else a.$message.error(a.$t("lg.failed")+": "+t.data.data.message);a.$store.state.contentLoading=!1,a.eidtDisabled=!0}).catch(function(a){console.log(a)})},addRecipients:function(){this.mailParamForm.recipient.defaultRecipient.push({defaultAdress:""})},delRecipients:function(a){this.mailParamForm.recipient.defaultRecipient.length>1&&this.mailParamForm.recipient.defaultRecipient.splice(a,1)},editEmail:function(){this.eidtDisabled=!1},saveMailparams:function(){var a=this;this.$refs.mailParamForm.validate(function(t){if(t){a.$store.state.contentLoading=!0;var e=m.b+"monitoring/mailparam",s=[];a.mailParamForm.recipient.defaultRecipient.forEach(function(a,t){s.push(a.defaultAdress)});var r={};r.mailParam=JSON.parse(i()(a.mailParamForm)),r.mailParam.recipient.defaultRecipient=s,r.id=a.mailid,l.a.post(e,r).then(function(t){0==t.data.responseCode?(a.roMailnotify(),a.$message({type:"success",message:a.$t("lg.success")}),a.eidtDisabled=!0):a.$message.error(a.$t("lg.failed")+": "+t.data.data.message),a.$store.state.contentLoading=!1}).catch(function(a){console.log(a)})}})}}},n={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"mailnotify-wrapper"},[e("div",{staticClass:"mailnotifyBox"},[e("p",{staticClass:"maillable"},[e("i",{staticClass:"fa fa-envelope-o"}),a._v(" "+a._s(a.$t("lg.emailparams")))]),a._v(" "),e("el-form",{ref:"mailParamForm",attrs:{model:a.mailParamForm,rules:a.mailParamFormRules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:a.$t("lg.senderemail"),prop:"smtpUsername"}},[e("el-input",{staticStyle:{width:"70%"},attrs:{disabled:a.eidtDisabled},model:{value:a.mailParamForm.smtpUsername,callback:function(t){a.$set(a.mailParamForm,"smtpUsername",t)},expression:"mailParamForm.smtpUsername"}})],1),a._v(" "),e("el-form-item",{attrs:{label:a.$t("lg.password"),prop:"smtpPassword"}},[e("el-input",{attrs:{type:"password",disabled:a.eidtDisabled,"show-password":""},model:{value:a.mailParamForm.smtpPassword,callback:function(t){a.$set(a.mailParamForm,"smtpPassword",t)},expression:"mailParamForm.smtpPassword"}})],1),a._v(" "),a._l(a.mailParamForm.recipient.defaultRecipient,function(t,s){return e("div",{key:s},[e("el-form-item",{attrs:{label:0==s?"接收人邮箱":"",prop:"recipient.defaultRecipient."+s+".defaultAdress",rules:[{required:!0,message:a.$t("lg.required"),trigger:"blur"},{pattern:/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/,message:"邮箱格式有误",trigger:"blur"}]}},[e("el-input",{staticStyle:{width:"70%"},attrs:{disabled:a.eidtDisabled},model:{value:t.defaultAdress,callback:function(e){a.$set(t,"defaultAdress","string"==typeof e?e.trim():e)},expression:"item.defaultAdress"}}),a._v(" "),e("span",{staticClass:"cursor-pointer",attrs:{title:"增加更多收件人"},on:{click:function(t){!a.eidtDisabled&&a.addRecipients()}}},[e("i",{staticClass:"el-icon-circle-plus-outline"})]),a._v(" "),e("span",{staticClass:"cursor-pointer",attrs:{title:"删除收件人"},on:{click:function(t){!a.eidtDisabled&&a.delRecipients(s)}}},[e("i",{staticClass:"el-icon-close"})])],1)],1)}),a._v(" "),e("el-form-item",{attrs:{label:a.$t("lg.smtp"),prop:"smtpHost"}},[e("el-input",{attrs:{disabled:a.eidtDisabled},model:{value:a.mailParamForm.smtpHost,callback:function(t){a.$set(a.mailParamForm,"smtpHost",t)},expression:"mailParamForm.smtpHost"}})],1),a._v(" "),e("el-form-item",{attrs:{label:a.$t("lg.port"),prop:"smtpPort"}},[e("el-input",{attrs:{disabled:a.eidtDisabled},model:{value:a.mailParamForm.smtpPort,callback:function(t){a.$set(a.mailParamForm,"smtpPort",t)},expression:"mailParamForm.smtpPort"}})],1),a._v(" "),a.eidtDisabled?e("div",{staticClass:"text-right"},[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:a.editEmail}},[a.noEmaildata?e("span",[a._v(a._s(a.$t("lg.add")))]):e("span",[a._v(a._s(a.$t("lg.edit")))])])],1):e("div",{staticClass:"text-right"},[e("el-button",{attrs:{type:"success",size:"small"},on:{click:a.saveMailparams}},[a._v(a._s(a.$t("lg.save")))]),a._v(" "),e("el-button",{attrs:{size:"small"},on:{click:a.roMailnotify}},[a._v(a._s(a.$t("lg.cancel")))])],1)],2)],1)])},staticRenderFns:[]};var d=e("VU/8")(o,n,!1,function(a){e("Mk+W")},"data-v-4590ba50",null);t.default=d.exports}});
//# sourceMappingURL=39.0fe6b6d56f3963eb712b.js.map