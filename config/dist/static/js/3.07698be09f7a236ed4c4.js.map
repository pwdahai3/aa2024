{"version":3,"sources":["webpack:///src/components/dataVisualization/dataTabPic.vue","webpack:///./src/components/dataVisualization/dataTabPic.vue?7da2","webpack:///./src/components/dataVisualization/dataTabPic.vue","webpack:///src/components/dataVisualization/heatmapPic.vue","webpack:///./src/components/dataVisualization/heatmapPic.vue?8478","webpack:///./src/components/dataVisualization/heatmapPic.vue","webpack:///src/components/dataVisualization/piePic.vue","webpack:///./src/components/dataVisualization/piePic.vue?48f9","webpack:///./src/components/dataVisualization/piePic.vue","webpack:///src/components/dataVisualization/chartHistory.vue","webpack:///./src/components/dataVisualization/chartHistory.vue?65f6","webpack:///./src/components/dataVisualization/chartHistory.vue","webpack:///src/components/dataVisualization/linePic.vue","webpack:///./src/components/dataVisualization/linePic.vue?af7b","webpack:///./src/components/dataVisualization/linePic.vue","webpack:///src/components/dataVisualization/areaPic.vue","webpack:///./src/components/dataVisualization/areaPic.vue?f2d2","webpack:///./src/components/dataVisualization/areaPic.vue","webpack:///src/components/dataVisualization/verticalBarPic.vue","webpack:///./src/components/dataVisualization/verticalBarPic.vue?650e","webpack:///./src/components/dataVisualization/verticalBarPic.vue"],"names":["dataTabPic","Boolean","Object","getDataTableData","this","itemParams","then","res","buckets","aggs","field","_getListArray","arr","headArry","obj","i","key","timeKey","doc_count","mapTableHeadArray","tableBodyArray","length","message","err","curPage","pageSize","getTime","prop","n","d","getSeconds","dataVisualization_dataTabPic","render","_vm","_h","$createElement","_c","_self","staticClass","_v","attrs","height","empty-text","chartLoadingShow","$t","data","tableBody","slice","on","sort-change","sort_change","_l","items","min-width","label","sortable","current-page","page-size","layout","total","tableDataTotal","current-change","handleCurrentChange","update:currentPage","$event","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","heatmapPic","getHeatmapChartData","drawChart","_this2","resize","xAxisVal","yAxisVal","xAxisArray","yAxisArray","resValues","dom","xAxisData","yAxisData","myChartData","params","hours","days","clear","option","str","dataVisualization_heatmapPic","_s","_e","id","piePic","getPieChartData","_this3","element","listObj","children","arrays","name","dataVisualization_piePic","chartHistory","getchartHistoryList","resArray","item","starttime","endtime","fromTime","endTime","chartType","areaPic","linePic","verticalBarPic","dataVisualization_chartHistory","chartHistoryList","_m","description","x","agg","interval","index","order","size","href","click","getChartData","deleteChart","visible","isMyChartShow","width","before-close","myChartClose","update:visible","isShow","staticStyle","max-width","getLineChartData","value","val","yAxisObj","legendValues","countArr","dataVisualization_linePic","getAreaChartData","dataVisualization_areaPic","getVerticalBarChartData","dataVisualization_verticalBarPic"],"mappings":"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","file":"static/js/3.07698be09f7a236ed4c4.js","sourcesContent":["<template>\r\n  <div>\r\n    <p class=\"chartName\">Data Table</p>\r\n    <!-- <p class=\"nodataTxt\"><span v-if=\"chartLoadingShow\"><i class=\"el-icon-loading\"></i> 数据加载中...</span><span v-if=\"tableHead.length==0 && !chartLoadingShow\">暂无数据</span></p> -->\r\n    <div class=\"tableBox\">  \r\n      <el-table height=\"560\" :empty-text=\"chartLoadingShow?$t('lg.loading2'):$t('lg.nodata')\" :data=\"tableBody.slice((curPage-1)*pageSize,curPage*pageSize)\" @sort-change=\"sort_change\"><!-- element 表格 每列自带排序功能 、暂无数据功能-->\r\n        <template v-for=\"items in tableHead\">\r\n          <el-table-column min-width=\"340\" :prop=\"items\" :label=\"items\" sortable=\"custom\"></el-table-column>\r\n        </template>\r\n      </el-table>\r\n      <div class=\"mypage\">\r\n        <el-pagination @current-change=\"handleCurrentChange\" :current-page.sync=\"curPage\" :page-size=\"pageSize\" layout=\"prev, pager, next, jumper\" :total=\"tableDataTotal\"></el-pagination>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nimport * as types from '@/store/types';\r\nimport { SERVER_API_URL } from \"@/conf/constvar\";\r\nimport echarts from 'echarts';\r\nexport default {\r\n  props:{\r\n    isShow:{\r\n      type:Boolean\r\n    },\r\n    isDataTable:{\r\n      type:Boolean\r\n    },\r\n    itemParams:{\r\n      type:Object\r\n    }\r\n  },\r\n  data(){\r\n    return{\r\n      chartLoadingShow:false,\r\n      tableHead:[],\r\n      tableBody:[],\r\n\r\n      curPage:1,\r\n      pageSize:10,\r\n      tableDataTotal:0,\r\n    }\r\n  },\r\n  created(){\r\n    if(!this.isDataTable){//！！！如果父组件不是dataTable才触发\r\n      this.getDataTableData();\r\n    }\r\n  },\r\n  watch:{\r\n    'isShow':function(){\r\n      if(this.isShow){\r\n        this.getDataTableData();\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    getDataTableData(){\r\n      const _this=this;\r\n      _this.tableHead=[];//清空\r\n      _this.tableBody=[];\r\n      _this.chartLoadingShow = true;\r\n      const url = SERVER_API_URL+\"dp/es/datachart/process\"; \r\n      console.log(_this.itemParams)\r\n      axios.post(url,{\r\n        chartType:'dataTable',\r\n        description:\"\",\r\n        params:_this.itemParams,\r\n        title:'dataTable'\r\n      }).then(res=>{\r\n        console.log(res);\r\n        if(res.data.responseCode==0){\r\n          let buckets = res.data.data.aggregations[2].buckets;\r\n          let tableHeadArray = [],tableHeadIndexArray=[], tableBodyArray = [];\r\n\r\n          //表头\r\n          const splitRows = _this.itemParams.aggs;\r\n          splitRows.forEach((element,index)=>{\r\n            if(element.agg=='date_histogram'){\r\n              switch(element.interval.match(/(\\d*)(\\w*)/)[2]){\r\n                case \"s\":\r\n                tableHeadArray.push(\"@timestamp per \"+ element.interval.match(/(\\d*)(\\w*)/)[1] +\" seconds\")\r\n                break;\r\n                case \"m\":\r\n                tableHeadArray.push(\"@timestamp per \"+ element.interval +\" minutes\")\r\n                break;\r\n                case \"h\":\r\n                tableHeadArray.push(\"@timestamp per \"+ element.interval +\" hours\")\r\n                break;\r\n                case \"d\":\r\n                tableHeadArray.push(\"@timestamp per \"+ element.interval + \" days\")\r\n                break;\r\n                case \"w\":\r\n                tableHeadArray.push(\"@timestamp per \"+ element.interval + \" weeks\")\r\n                break;\r\n                case \"M\":\r\n                tableHeadArray.push(\"@timestamp per \" + element.interval + \" months\")\r\n                break;\r\n                default:\r\n                tableHeadArray.push(\"@timestamp per \" + element.interval + \" years\")\r\n              }\r\n            }else if(element.agg=='terms'){\r\n              tableHeadArray.push(element.field);\r\n            }\r\n          })\r\n          tableHeadArray.push('count');\r\n\r\n          //表体\r\n          function getListArray(arr,headArry,obj,i){\r\n            if(arr.length!=0){\r\n              arr.forEach((element,index) => {\r\n                obj=Object.assign({},obj);\r\n                var flag=false;\r\n                Object.keys(element).forEach(key=>{\r\n                  if(!isNaN(key)){\r\n                    flag=true;\r\n                    if(element.key_as_string){//有key_as_string,表示key值是时间，需要转换时间戳\r\n                      var timeKey = _this.transformMyDate(element.key);\r\n                      obj[headArry[i++]]=timeKey;\r\n                    }else{\r\n                      obj[headArry[i++]]=element.key;\r\n                    }\r\n                    getListArray(element[key].buckets,headArry,obj,i)\r\n                    i--;\r\n                  }\r\n                })\r\n                if(!flag){\r\n                    obj=Object.assign({},obj);\r\n                    if(element.key_as_string){//转换时间戳\r\n                      var timeKey = _this.transformMyDate(element.key);\r\n                      obj[headArry[i]]=timeKey;\r\n                    }else{\r\n                      obj[headArry[i]]=element.key;\r\n                    }\r\n                    obj['count']=element.doc_count;\r\n                    tableBodyArray.push(obj);\r\n                  }\r\n              });\r\n            }\r\n          }\r\n          var mapTableHeadArray=tableHeadArray.map(item=>{//elelmnet 组件 <el-table> prop 不识别'.'符号（被认为对象属性）\r\n            if(item.indexOf('.')){\r\n              return item.split('.').join(' ');\r\n            }\r\n          })\r\n\r\n          getListArray(buckets,mapTableHeadArray,{},0);\r\n\r\n          // console.log(tableBodyArray)\r\n          _this.tableHead = mapTableHeadArray;\r\n          _this.tableBody=tableBodyArray;\r\n          _this.tableDataTotal=tableBodyArray.length;\r\n          _this.chartLoadingShow = false;\r\n\r\n        }else{\r\n          _this.$message.error(_this.$t('lg.failed')+': '+res.data.data.message);\r\n          _this.chartLoadingShow = false;\r\n        }\r\n      }).catch(err=>{\r\n        console.log(err);\r\n        _this.chartLoadingShow = false;\r\n      });\r\n      _this.$emit('changeFlag',false);//如果dataTable是父组件，在父组件里点击生成视图，要把myChartFlag 的值重新变成false，（以便Watch做监视 isShow变动才能触发getDataTableData）\r\n    },\r\n    handleCurrentChange(){\r\n      console.log(this.curPage)\r\n      console.log(this.pageSize)\r\n    },\r\n    sort_change(column,prop,order){//整体数据排序\r\n      if(column.order==\"descending\"){\r\n        this.tableBody.sort(function(a,b){\r\n          if(isNaN(a[column.prop])){\r\n            return new Date(a[column.prop]).getTime() - new Date(b[column.prop]).getTime();\r\n          }else{\r\n            return a[column.prop] - b[column.prop];\r\n          }\r\n        });\r\n      }else if(column.order==\"ascending\"){\r\n        this.tableBody.sort(function(a,b){\r\n          if(isNaN(a[column.prop])){\r\n            return Date.parse(new Date(b[column.prop])) - Date.parse(new Date(a[column.prop]));\r\n          }else{\r\n            return b[column.prop] - a[column.prop];\r\n          }\r\n        });\r\n      }\r\n    },\r\n    transformMyDate(d){\r\n      d=new Date(d);\r\n      function pad(n){\r\n        return n<10 ? '0'+n : n\r\n      }\r\n      return d.getFullYear()+\"-\"+pad(parseInt(d.getMonth())+1)+\"-\"+pad(d.getDate())+\" \"+pad(d.getHours())+':' + pad(d.getMinutes())+':' + pad(d.getSeconds());\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.chartContainer{\r\n  width: 100%;\r\n  height: 650px;\r\n}\r\n.chartName{\r\n  font-size: 16px;\r\n  color: #606266;\r\n  padding-left: 10px;\r\n  margin-bottom: 20px;\r\n}\r\n.tableBox{\r\n  overflow-x: auto;\r\n  height: 650px;\r\n}\r\n.mypage{\r\n  padding-top: 30px;\r\n  float: right;\r\n}\r\n.backBtn{\r\n  float: right;\r\n}\r\n/* .nodataTxt{\r\n  position: absolute;\r\n  top: 40%;\r\n  left: 48%;\r\n  color:#888;\r\n} */\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/dataVisualization/dataTabPic.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('p',{staticClass:\"chartName\"},[_vm._v(\"Data Table\")]),_vm._v(\" \"),_c('div',{staticClass:\"tableBox\"},[_c('el-table',{attrs:{\"height\":\"560\",\"empty-text\":_vm.chartLoadingShow?_vm.$t('lg.loading2'):_vm.$t('lg.nodata'),\"data\":_vm.tableBody.slice((_vm.curPage-1)*_vm.pageSize,_vm.curPage*_vm.pageSize)},on:{\"sort-change\":_vm.sort_change}},[_vm._l((_vm.tableHead),function(items){return [_c('el-table-column',{attrs:{\"min-width\":\"340\",\"prop\":items,\"label\":items,\"sortable\":\"custom\"}})]})],2),_vm._v(\" \"),_c('div',{staticClass:\"mypage\"},[_c('el-pagination',{attrs:{\"current-page\":_vm.curPage,\"page-size\":_vm.pageSize,\"layout\":\"prev, pager, next, jumper\",\"total\":_vm.tableDataTotal},on:{\"current-change\":_vm.handleCurrentChange,\"update:currentPage\":function($event){_vm.curPage=$event}}})],1)],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1f7f4971\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/dataVisualization/dataTabPic.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1f7f4971\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./dataTabPic.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./dataTabPic.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./dataTabPic.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1f7f4971\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./dataTabPic.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-1f7f4971\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/dataVisualization/dataTabPic.vue\n// module id = null\n// module chunks = ","<template>\r\n  <div>\r\n    <p class=\"nodataTxt\"><span v-if=\"chartLoadingShow\"><i class=\"el-icon-loading\"></i> {{$t('lg.loading2')}}</span><span v-if=\"yAxisData.length==0 && !chartLoadingShow\">{{$t('lg.nodata')}}</span></p>\r\n    <div id=\"chartContainer\" class=\"chartContainer\"></div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nimport * as types from '@/store/types';\r\nimport { SERVER_API_URL } from \"@/conf/constvar\";\r\nimport echarts from 'echarts';\r\nexport default {\r\n  props:{\r\n    isShow:{\r\n      type:Boolean\r\n    },\r\n    isHeatmapChart:{\r\n      type:Boolean\r\n    },\r\n    itemParams:{\r\n      type:Object\r\n    }\r\n  },\r\n  data(){\r\n    return{\r\n      chartLoadingShow:false,\r\n      myChart:null,\r\n      legendData:[],\r\n      xAxisData:[],\r\n      yAxisData:[],\r\n    }\r\n  },\r\n  created(){\r\n    if(!this.isHeatmapChart){//！！！如果父组件不是heatmapChart才触发\r\n      this.getHeatmapChartData();\r\n    }\r\n  },\r\n  mounted(){//父组件为heatmapChart，预先画一下图,不然作图区域为空白的\r\n    if(this.isHeatmapChart){\r\n      this.drawChart();\r\n    }\r\n  },\r\n  watch:{\r\n    'isShow':function(){\r\n      if(this.isShow){\r\n        this.getHeatmapChartData();\r\n        if(this.myChart){\r\n          this.myChart.resize();//关闭弹框后窗口大小改变又再次打开弹框，视图还要做一次resize\r\n          window.addEventListener(\"resize\", () => {//弹框打开，监视浏览器窗口大小改变，视图resize\r\n            this.myChart.resize();\r\n          });\r\n        }\r\n      }else{\r\n        if(this.myChart){\r\n          this.myChart.clear();//关闭视图时清空视图，解决前一次数据闪现问题\r\n        }\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    getHeatmapChartData(){\r\n      const _this=this;\r\n      _this.chartLoadingShow = true;\r\n      const url = SERVER_API_URL+\"dp/es/datachart/process\"; \r\n      console.log(_this.itemParams)\r\n      axios.post(url,{\r\n        chartType:'heatmapChart',\r\n        description:\"\",\r\n        params:_this.itemParams,\r\n        title:'heatmapChart'\r\n      }).then(res=>{\r\n        if(res.data.responseCode==0){\r\n          console.log(res.data.data);\r\n          let buckets = res.data.data.aggregations[2].buckets;\r\n          let xAxisArray=[];\r\n          let yAxisArray=[];\r\n          let resValues=[];\r\n          buckets.forEach(element=>{\r\n            var  xAxisVal= _this.transformMyDate(element.key);\r\n            if(xAxisArray.indexOf(xAxisVal)==-1){\r\n              xAxisArray.push(xAxisVal);\r\n            }\r\n            element[3].buckets.forEach(item=>{\r\n              var yAxisVal = item.key;\r\n              if(item.key_as_string){\r\n                yAxisVal = _this.transformMyDate(yAxisVal);\r\n              }\r\n              if(yAxisArray.indexOf(yAxisVal)==-1){\r\n                yAxisArray.push(yAxisVal);\r\n              }\r\n              resValues.push([_this.findIndex(yAxisVal,yAxisArray),_this.findIndex(xAxisVal,xAxisArray),item.doc_count])\r\n            })\r\n          })\r\n         \r\n          _this.xAxisData=xAxisArray;\r\n          _this.yAxisData=yAxisArray;\r\n          _this.myChartData=resValues;\r\n          _this.drawChart();\r\n          _this.chartLoadingShow = false;\r\n        }else{\r\n          _this.$message.error(_this.$t('lg.failed')+': '+res.data.data.message);\r\n          _this.chartLoadingShow = false;\r\n        }\r\n      }).catch(err=>{\r\n        console.log(err);\r\n        _this.chartLoadingShow = false;\r\n      })\r\n      _this.$emit('changeFlag',false);//如果heatmapChart是父组件，在父组件里点击生成视图，要把myChartFlag 的值重新变成false，（以便Watch做监视 isShow变动才能触发getHeatmapChartData）\r\n    },\r\n    drawChart(){\r\n      const _this = this;\r\n      const dom = document.getElementById(\"chartContainer\");\r\n      _this.myChart = echarts.init(dom);\r\n\r\n      var hours = _this.xAxisData;\r\n      var days = _this.yAxisData;\r\n      var data = _this.myChartData;\r\n      if(data){\r\n        data = data.map(function (item) {\r\n          return [item[1], item[0], item[2] || '-'];\r\n        });\r\n      }\r\n\r\n      let option = {\r\n        title: {\r\n          text: 'Heatmap Chart',\r\n          left:'20',\r\n          textStyle:{\r\n            fontSize:'16',\r\n            fontWeight:'normal',\r\n            color:'#606266'\r\n          }\r\n        },\r\n        tooltip: {\r\n          trigger: 'item',\r\n          // formatter: \"{b}: {c}\",\r\n          formatter:function(params, ticket, callback){\r\n            // console.log(params);\r\n            var str='';\r\n            // params.forEach((ele,index)=>{\r\n            //   console.log(index)\r\n            //   str = ele.axisValue + ele.value[2];\r\n            // })\r\n            str = _this.itemParams.y[0].field+ ': ' +_this.itemParams.y[0].order['_count'] +'</br> '+\r\n            'Count: ' + params.data[2];\r\n            return str\r\n          },\r\n          axisPointer: {\r\n            type: 'cross',\r\n            label: {\r\n              backgroundColor: '#6a7985'\r\n            }\r\n          }\r\n        },\r\n        animation: false,\r\n        grid: {\r\n          left: '7%',\r\n          right: '5%',\r\n          top:'6%',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          type: 'category',\r\n          data: hours,\r\n          splitArea: {\r\n            show: true\r\n          }\r\n        },\r\n        yAxis: {\r\n          type: 'category',\r\n          data: days,\r\n          splitArea: {\r\n              show: true\r\n          }\r\n        },\r\n        // dataZoom: [\r\n        //   {\r\n        //     type: 'slider',\r\n        //     show: true,\r\n        //     xAxisIndex: [0],\r\n        //     start: 0,\r\n        //     end: 100,\r\n        //     bottom:'8%'\r\n        //   },\r\n        //   {\r\n        //     type: 'slider',\r\n        //     show: true,\r\n        //     yAxisIndex: [0],\r\n        //     left: '96%',\r\n        //     start: 0,\r\n        //     end: 100\r\n        //   },\r\n        //   {\r\n        //     type: 'inside',\r\n        //     xAxisIndex: [0],\r\n        //     start: 0,\r\n        //     end: 100\r\n        //   },\r\n        //   {\r\n        //     type: 'inside',\r\n        //     yAxisIndex: [0],\r\n        //     start: 0,\r\n        //     end: 100\r\n        //   }\r\n        // ],\r\n        visualMap: {\r\n          type:'piecewise',\r\n          maxOpen:'single',\r\n          min: 0,\r\n          max: 500,\r\n          // itemHeight:400,\r\n          calculable: true,\r\n          orient: 'horizontal',\r\n          left: 'center',\r\n          bottom: '0%'\r\n        },\r\n        series: [{\r\n          name: 'Punch Card',\r\n          type: 'heatmap',\r\n          data: data,\r\n          label: {\r\n            // normal: {\r\n            //     show: true\r\n            // }\r\n            show:false\r\n          },\r\n          itemStyle: {\r\n            emphasis: {\r\n              shadowBlur: 10,\r\n              shadowColor: 'rgba(0, 0, 0, 0.5)'\r\n            }\r\n          }\r\n        }]\r\n      };\r\n      _this.myChart.clear();\r\n      _this.myChart.setOption(option);\r\n    },\r\n    transformMyDate(d){\r\n      d=new Date(d);\r\n      function pad(n){\r\n        return n<10 ? '0'+n : n\r\n      }\r\n      return d.getFullYear()+\"-\"+pad(parseInt(d.getMonth())+1)+\"-\"+pad(d.getDate())+\" \"+pad(d.getHours())+':' + pad(d.getMinutes())+':' + pad(d.getSeconds());\r\n    },\r\n    findIndex(str,arr){\r\n      return  arr.findIndex((item)=>{\r\n        return item==str;\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.chartContainer{\r\n  width: 100%;\r\n  height: 650px;\r\n}\r\n.nodataTxt{\r\n  position: absolute;\r\n  top: 40%;\r\n  left: 48%;\r\n  color:#888;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/dataVisualization/heatmapPic.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('p',{staticClass:\"nodataTxt\"},[(_vm.chartLoadingShow)?_c('span',[_c('i',{staticClass:\"el-icon-loading\"}),_vm._v(\" \"+_vm._s(_vm.$t('lg.loading2')))]):_vm._e(),(_vm.yAxisData.length==0 && !_vm.chartLoadingShow)?_c('span',[_vm._v(_vm._s(_vm.$t('lg.nodata')))]):_vm._e()]),_vm._v(\" \"),_c('div',{staticClass:\"chartContainer\",attrs:{\"id\":\"chartContainer\"}})])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-07e4a798\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/dataVisualization/heatmapPic.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-07e4a798\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./heatmapPic.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./heatmapPic.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./heatmapPic.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-07e4a798\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./heatmapPic.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-07e4a798\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/dataVisualization/heatmapPic.vue\n// module id = null\n// module chunks = ","<template>\r\n  <div>\r\n    <p class=\"nodataTxt\"><span v-if=\"chartLoadingShow\"><i class=\"el-icon-loading\"></i> {{$t('lg.loading2')}}</span><span v-if=\"arrays.length==0 && !chartLoadingShow\">{{$t('lg.nodata')}}</span></p>\r\n    <div id=\"chartContainer\" class=\"chartContainer\"></div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nimport * as types from '@/store/types';\r\nimport { SERVER_API_URL } from \"@/conf/constvar\";\r\nimport echarts from 'echarts';\r\nexport default {\r\n  props:{\r\n    isShow:{\r\n      type:Boolean\r\n    },\r\n    isPieChart:{\r\n      type:Boolean\r\n    },\r\n    itemParams:{\r\n      type:Object\r\n    }\r\n  },\r\n  data(){\r\n    return{\r\n      chartLoadingShow:false,\r\n      myChart:null,\r\n      arrays:[]\r\n    }\r\n  },\r\n  created(){\r\n    if(!this.isPieChart){//！！！如果父组件不是pieChart才触发\r\n      this.getPieChartData();\r\n    }\r\n  },\r\n  mounted(){//父组件为pieChart，预先画一下图,不然作图区域为空白的\r\n    if(this.isPieChart){\r\n      this.drawChart();\r\n    }\r\n  },\r\n  watch:{\r\n    'isShow':function(){\r\n      if(this.isShow){\r\n        this.getPieChartData();\r\n        if(this.myChart){\r\n          this.myChart.resize();//关闭弹框后窗口大小改变又再次打开弹框，视图还要做一次resize\r\n          window.addEventListener(\"resize\", () => {//弹框打开，监视浏览器窗口大小改变，视图resize\r\n            this.myChart.resize();\r\n          });\r\n        }\r\n      }else{\r\n        if(this.myChart){\r\n          this.myChart.clear();//关闭视图时清空视图，解决前一次数据闪现问题\r\n        }\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    getPieChartData(){\r\n      const _this=this;\r\n      _this.arrays=[];//!!!清空,不然数据会叠加\r\n      _this.chartLoadingShow = true;\r\n      const url = SERVER_API_URL+\"dp/es/datachart/process\"; \r\n      console.log(_this.itemParams)\r\n      axios.post(url,{\r\n        chartType:'pieChart',\r\n        description:\"\",\r\n        params:_this.itemParams,\r\n        title:'pieChart'\r\n      }).then(res=>{\r\n        console.log(res);\r\n        if(res.data.responseCode==0){\r\n          let buckets = res.data.data.aggregations[2].buckets;\r\n          listArray(buckets,this.arrays)\r\n          _this.drawChart();\r\n          _this.chartLoadingShow=false;\r\n        }else{\r\n          _this.$message.error(_this.$t('lg.failed')+': '+res.data.data.message);\r\n          _this.chartLoadingShow=false;\r\n        }\r\n      }).catch(err=>{\r\n        console.log(err);\r\n        _this.chartLoadingShow=false;\r\n      });\r\n\r\n      function objModule(obj){\r\n        this.children=[];\r\n        this.value=obj.doc_count;\r\n        this.name=obj.key;\r\n        this.key_as_string=obj.key_as_string||'';\r\n        this.AB=obj.key_as_string?'A':'b';\r\n      }\r\n      function listArray(arr,toArr){\r\n        arr.forEach(element => {\r\n          var listObj=new objModule(element);\r\n          toArr.push(listObj);\r\n          Object.keys(element).forEach(item=>{\r\n            if(!isNaN(item)){\r\n              if(element[item].buckets.length){\r\n                listArray(element[item].buckets,listObj.children)\r\n              }\r\n            }\r\n          })\r\n        })\r\n      }\r\n      _this.$emit('changeFlag',false);//如果pieChart是父组件，在父组件里点击生成视图，要把myChartFlag 的值重新变成false，（以便Watch做监视 isShow变动才能触发getPieChartData）\r\n    },\r\n    drawChart(){\r\n      const _this = this;\r\n      const dom = document.getElementById(\"chartContainer\");\r\n      _this.myChart = echarts.init(dom);\r\n      // console.log(_this.arrays)\r\n      let option = {\r\n        title: {\r\n          text: 'Pie Chart',\r\n          left:'20',\r\n          textStyle:{\r\n            fontSize:'16',\r\n            fontWeight:'normal',\r\n            color:'#606266'\r\n          }\r\n        },\r\n        tooltip: {\r\n          trigger: 'item',\r\n          // formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n          formatter:function(params, ticket, callback){\r\n            var str = '';\r\n            params.treePathInfo.forEach((ele,index)=>{\r\n              var name = ele.name;\r\n              if(index!=0){\r\n                if(String(name).length==13){\r\n                  name=_this.transformMyDate(name);\r\n                }\r\n                str+='<tr style=\"background:transparent;\"><td style=\"border:none;padding:0 10px;\">'+_this.itemParams.aggs[index-1].field+'</td><td style=\"border:none;padding:0 10px;\">'+ name +'</td><td style=\"border:none;padding:0 10px;\">'+ ele.value +'('+(ele.value/params.treePathInfo[index-1].value*100).toFixed(2) +'%)</td></tr>'\r\n              }\r\n            })\r\n            var myHtml = '<table style=\"border:none;color:#fff;\">'+\r\n                          '<thead style=\"color:#fff\">'+\r\n                          '<th style=\"border:none;padding:0 10px;\">field</th>'+ \r\n                          '<th style=\"border:none;padding:0 10px;\">value</th>'+ \r\n                          '<th style=\"border:none;padding:0 10px;\">Count</th>'+ \r\n                          '</thead>'+\r\n                          '<tbody>'+\r\n                            str+\r\n                          '</tbody>'+\r\n                         '</table>'\r\n            return myHtml;\r\n          }\r\n        },\r\n        series: {\r\n          type: 'sunburst',\r\n          data: _this.arrays,\r\n          radius: [0, '80%'],\r\n          label: {\r\n            show: false\r\n          }\r\n        }\r\n      };\r\n      _this.myChart.clear();\r\n      _this.myChart.setOption(option);\r\n    },\r\n    transformMyDate(d){\r\n      d=new Date(d);\r\n      function pad(n){\r\n        return n<10 ? '0'+n : n\r\n      }\r\n      return d.getFullYear()+\"-\"+pad(parseInt(d.getMonth())+1)+\"-\"+pad(d.getDate())+\" \"+pad(d.getHours())+':' + pad(d.getMinutes())+':' + pad(d.getSeconds());\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.chartContainer{\r\n  width: 100%;\r\n  height: 650px;\r\n}\r\n.nodataTxt{\r\n  position: absolute;\r\n  top: 40%;\r\n  left: 48%;\r\n  color:#888;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/dataVisualization/piePic.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('p',{staticClass:\"nodataTxt\"},[(_vm.chartLoadingShow)?_c('span',[_c('i',{staticClass:\"el-icon-loading\"}),_vm._v(\" \"+_vm._s(_vm.$t('lg.loading2')))]):_vm._e(),(_vm.arrays.length==0 && !_vm.chartLoadingShow)?_c('span',[_vm._v(_vm._s(_vm.$t('lg.nodata')))]):_vm._e()]),_vm._v(\" \"),_c('div',{staticClass:\"chartContainer\",attrs:{\"id\":\"chartContainer\"}})])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-0e608ded\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/dataVisualization/piePic.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0e608ded\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./piePic.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./piePic.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./piePic.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0e608ded\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./piePic.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-0e608ded\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/dataVisualization/piePic.vue\n// module id = null\n// module chunks = ","<template>\r\n  <div class=\"chartHistory-wrapper\">\r\n    <div v-if=\"chartHistoryList.length==0\" class=\"nodata-box\">暂无视图记录</div>\r\n    <table v-if=\"chartHistoryList.length>0\">\r\n      <thead>\r\n        <tr>\r\n          <th>视图ID</th>\r\n          <th>视图类型</th>\r\n          <th>视图描述</th>\r\n          <th style=\"max-width:260px\">视图参数</th>\r\n          <th style=\"min-width:30px\"></th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"item in chartHistoryList\" :key=\"item.id\">\r\n          <td>{{item.id}}</td>\r\n          <td>{{item.chartType}}</td>\r\n          <td>{{item.description}}</td>\r\n          <td class=\"chartParamsTd\" v-if=\"item.chartType=='areaChart' || item.chartType=='lineChart' || item.chartType=='verticalBarChart' || item.chartType=='heatmapChart'\">\r\n            <p class=\"paramTitle\">X-Axis</p>\r\n            <p><span>Aggregation: </span>{{item.params.x.agg}}</p>\r\n            <p><span>Field: </span>{{item.params.x.field}}</p>\r\n            <p><span>Interval: </span>{{item.params.x.interval}}</p>\r\n            <p class=\"paramTitle\">Y-Axis</p>\r\n            <div class=\"innerLoop\" v-for=\"(items,index) in item.params.y\" :key=\"index\">\r\n              <p><span>Aggregation: </span>{{items.agg}}</p>\r\n              <p v-if=\"items.field\"><span>Field: </span>{{items.field}}</p>\r\n            </div>\r\n          </td>\r\n          <td class=\"chartParamsTd\" v-if=\"item.chartType=='pieChart' || item.chartType=='dataTable'\">\r\n            <p v-if=\"item.chartType=='pieChart'\" class=\"paramTitle\">Slice Size</p>\r\n            <p v-else class=\"paramTitle\">Metric</p>\r\n            <p><span>Aggregation: </span>Count</p>\r\n            <p v-if=\"item.chartType=='pieChart'\" class=\"paramTitle\">Split Slice</p>\r\n            <p v-else class=\"paramTitle\">Split Rows</p>\r\n            <div class=\"innerLoop\" v-for=\"(items,index) in item.params.aggs\" :key=\"index\">\r\n              <p><span>Aggregation: </span>{{items.agg}}</p>\r\n              <p><span>Field: </span>{{items.field}}</p>\r\n              <p v-if=\"items.interval\"><span>Interval: </span>{{items.interval}}</p>\r\n              <p v-if=\"items.order\"><span>Order: </span>{{items.order['_count']}}</p>\r\n              <p v-if=\"items.size\"><span>Size: </span>{{items.size}}</p>\r\n            </div>\r\n          </td>\r\n          <td class=\"text-center\">\r\n            <a href=\"javascript:;\" class=\"edit-del-a\" @click=\"getChartData(item)\"><i class=\"fa fa-play font-blue\"> 生成视图</i></a>\r\n            <a href=\"javascript:;\" class=\"edit-del-a\" @click=\"deleteChart(item.id)\"><i class=\"el-icon-delete\"> 删除</i></a>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n    <el-dialog :visible.sync=\"isMyChartShow\" width=\"65%\" :before-close=\"myChartClose\"><!--视图弹框-->\r\n      <area-pic v-if=\"chartType=='areaChart'\" :isShow=\"isMyChartShow\" :itemParams=\"itemParams\"></area-pic>\r\n      <line-pic v-if=\"chartType=='lineChart'\" :isShow=\"isMyChartShow\" :itemParams=\"itemParams\"></line-pic>\r\n      <vertical-bar-pic v-if=\"chartType=='verticalBarChart'\" :isShow=\"isMyChartShow\" :itemParams=\"itemParams\"></vertical-bar-pic>\r\n      <heatmap-pic v-if=\"chartType=='heatmapChart'\" :isShow=\"isMyChartShow\" :itemParams=\"itemParams\"></heatmap-pic>\r\n      <pie-pic v-if=\"chartType=='pieChart'\" :isShow=\"isMyChartShow\" :itemParams=\"itemParams\"></pie-pic>\r\n      <data-tab-pic v-if=\"chartType=='dataTable'\" :isShow=\"isMyChartShow\" :itemParams=\"itemParams\"></data-tab-pic>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nimport * as types from '@/store/types';\r\nimport { SERVER_API_URL } from \"@/conf/constvar\";\r\n//视图组件\r\nimport areaPic from '@/components/dataVisualization/areaPic';\r\nimport linePic from '@/components/dataVisualization/linePic';\r\nimport verticalBarPic from '@/components/dataVisualization/verticalBarPic';\r\nimport heatmapPic from '@/components/dataVisualization/heatmapPic';\r\nimport piePic from '@/components/dataVisualization/piePic';\r\nimport dataTabPic from '@/components/dataVisualization/dataTabPic';\r\nexport default {\r\n  data(){\r\n    return{\r\n      chartHistoryList:[],\r\n      isMyChartShow:false,//视图弹框显隐\r\n      chartType:'',//视图类型\r\n      itemParams:{},//存储视图参数传给areaPic子组件\r\n    }\r\n  },\r\n  created(){\r\n    this.$store.state.contentLoading=true;\r\n    this.getchartHistoryList();\r\n  },\r\n  methods:{\r\n    getchartHistoryList(){\r\n      const _this = this;\r\n      const url = SERVER_API_URL + \"dp/es/datachart\";\r\n      axios.get(url).then(res=>{\r\n        console.log(res)\r\n        if(res.data.responseCode==0){\r\n          const resArray = res.data.data;\r\n          console.log(resArray);\r\n          _this.chartHistoryList=resArray;\r\n          _this.$store.state.contentLoading=false;\r\n        }else{\r\n          _this.$message.error(_this.$t('lg.failed')+': ' + res.data.data.message);\r\n        }\r\n      }).catch(err=>{\r\n        console.log(err);\r\n      })\r\n    },\r\n    myChartClose(){\r\n      this.isMyChartShow=false;\r\n    },\r\n    getChartData(item){//生成视图    \r\n      const _this = this;\r\n      console.log(item);\r\n      const sttime=_this.$store.state.mydatedata.starttime,\r\n            edtime=_this.$store.state.mydatedata.endtime;\r\n      const fromTime=sttime.getTime(),\r\n            endTime=edtime.getTime();\r\n\r\n      let paramsObj = item.params;//替换一下视图参数里面的查询时间，替换成右上角的时间段\r\n      paramsObj.timeRange.from = fromTime;\r\n      paramsObj.timeRange.to = endTime;\r\n      _this.itemParams=paramsObj;//传入视图组件，作为参数调用视图数据webSocket接口。以便作图\r\n      _this.chartType=item.chartType;\r\n      _this.isMyChartShow=true;\r\n    },\r\n    deleteChart(id){//删除一条记录\r\n      const _this = this;\r\n      _this.$confirm(_this.$t('lg.isdelete'),_this.$t('lg.tips'),{\r\n        confirmButtonText: _this.$t('lg.yes'),\r\n        cancelButtonText: _this.$t('lg.cancel'),\r\n        type: 'warning'\r\n      }).then(()=>{\r\n        const url = SERVER_API_URL + \"dp/es/datachart/\" + id;\r\n        axios.delete(url).then(res => {\r\n          if(res.data.responseCode == 0){\r\n            _this.$message({\r\n              type: \"success\",\r\n              message: _this.$t('lg.success')\r\n            });\r\n            _this.getchartHistoryList();\r\n          }else{\r\n            _this.$message.error(_this.$t('lg.failed')+': ' + res.data.data.message);\r\n          }\r\n        }).catch(err => {\r\n          console.log(err);\r\n        });\r\n      }).catch(()=>{\r\n        _this.$message({\r\n          type: 'info',\r\n          message: _this.$t('lg.canceled')\r\n        });\r\n      })\r\n    }\r\n  },\r\n  components:{\r\n    areaPic,\r\n    linePic,\r\n    verticalBarPic,\r\n    heatmapPic,\r\n    piePic,\r\n    dataTabPic\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.chartHistory-wrapper{\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  padding:20px;\r\n  box-sizing: border-box;\r\n}\r\n.chartParamsTd p{\r\n  padding: 3px 0px;\r\n  line-height: 18px;\r\n}\r\n.paramTitle{\r\n  font-weight: 700;\r\n}\r\n.innerLoop{\r\n  border-bottom: 1px dashed #ccc;\r\n  padding: 5px 0;\r\n}\r\n.innerLoop:nth-last-of-type(1){\r\n  border: none\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/dataVisualization/chartHistory.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"chartHistory-wrapper\"},[(_vm.chartHistoryList.length==0)?_c('div',{staticClass:\"nodata-box\"},[_vm._v(\"暂无视图记录\")]):_vm._e(),_vm._v(\" \"),(_vm.chartHistoryList.length>0)?_c('table',[_vm._m(0),_vm._v(\" \"),_c('tbody',_vm._l((_vm.chartHistoryList),function(item){return _c('tr',{key:item.id},[_c('td',[_vm._v(_vm._s(item.id))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(item.chartType))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(item.description))]),_vm._v(\" \"),(item.chartType=='areaChart' || item.chartType=='lineChart' || item.chartType=='verticalBarChart' || item.chartType=='heatmapChart')?_c('td',{staticClass:\"chartParamsTd\"},[_c('p',{staticClass:\"paramTitle\"},[_vm._v(\"X-Axis\")]),_vm._v(\" \"),_c('p',[_c('span',[_vm._v(\"Aggregation: \")]),_vm._v(_vm._s(item.params.x.agg))]),_vm._v(\" \"),_c('p',[_c('span',[_vm._v(\"Field: \")]),_vm._v(_vm._s(item.params.x.field))]),_vm._v(\" \"),_c('p',[_c('span',[_vm._v(\"Interval: \")]),_vm._v(_vm._s(item.params.x.interval))]),_vm._v(\" \"),_c('p',{staticClass:\"paramTitle\"},[_vm._v(\"Y-Axis\")]),_vm._v(\" \"),_vm._l((item.params.y),function(items,index){return _c('div',{key:index,staticClass:\"innerLoop\"},[_c('p',[_c('span',[_vm._v(\"Aggregation: \")]),_vm._v(_vm._s(items.agg))]),_vm._v(\" \"),(items.field)?_c('p',[_c('span',[_vm._v(\"Field: \")]),_vm._v(_vm._s(items.field))]):_vm._e()])})],2):_vm._e(),_vm._v(\" \"),(item.chartType=='pieChart' || item.chartType=='dataTable')?_c('td',{staticClass:\"chartParamsTd\"},[(item.chartType=='pieChart')?_c('p',{staticClass:\"paramTitle\"},[_vm._v(\"Slice Size\")]):_c('p',{staticClass:\"paramTitle\"},[_vm._v(\"Metric\")]),_vm._v(\" \"),_vm._m(1,true),_vm._v(\" \"),(item.chartType=='pieChart')?_c('p',{staticClass:\"paramTitle\"},[_vm._v(\"Split Slice\")]):_c('p',{staticClass:\"paramTitle\"},[_vm._v(\"Split Rows\")]),_vm._v(\" \"),_vm._l((item.params.aggs),function(items,index){return _c('div',{key:index,staticClass:\"innerLoop\"},[_c('p',[_c('span',[_vm._v(\"Aggregation: \")]),_vm._v(_vm._s(items.agg))]),_vm._v(\" \"),_c('p',[_c('span',[_vm._v(\"Field: \")]),_vm._v(_vm._s(items.field))]),_vm._v(\" \"),(items.interval)?_c('p',[_c('span',[_vm._v(\"Interval: \")]),_vm._v(_vm._s(items.interval))]):_vm._e(),_vm._v(\" \"),(items.order)?_c('p',[_c('span',[_vm._v(\"Order: \")]),_vm._v(_vm._s(items.order['_count']))]):_vm._e(),_vm._v(\" \"),(items.size)?_c('p',[_c('span',[_vm._v(\"Size: \")]),_vm._v(_vm._s(items.size))]):_vm._e()])})],2):_vm._e(),_vm._v(\" \"),_c('td',{staticClass:\"text-center\"},[_c('a',{staticClass:\"edit-del-a\",attrs:{\"href\":\"javascript:;\"},on:{\"click\":function($event){_vm.getChartData(item)}}},[_c('i',{staticClass:\"fa fa-play font-blue\"},[_vm._v(\" 生成视图\")])]),_vm._v(\" \"),_c('a',{staticClass:\"edit-del-a\",attrs:{\"href\":\"javascript:;\"},on:{\"click\":function($event){_vm.deleteChart(item.id)}}},[_c('i',{staticClass:\"el-icon-delete\"},[_vm._v(\" 删除\")])])])])}))]):_vm._e(),_vm._v(\" \"),_c('el-dialog',{attrs:{\"visible\":_vm.isMyChartShow,\"width\":\"65%\",\"before-close\":_vm.myChartClose},on:{\"update:visible\":function($event){_vm.isMyChartShow=$event}}},[(_vm.chartType=='areaChart')?_c('area-pic',{attrs:{\"isShow\":_vm.isMyChartShow,\"itemParams\":_vm.itemParams}}):_vm._e(),_vm._v(\" \"),(_vm.chartType=='lineChart')?_c('line-pic',{attrs:{\"isShow\":_vm.isMyChartShow,\"itemParams\":_vm.itemParams}}):_vm._e(),_vm._v(\" \"),(_vm.chartType=='verticalBarChart')?_c('vertical-bar-pic',{attrs:{\"isShow\":_vm.isMyChartShow,\"itemParams\":_vm.itemParams}}):_vm._e(),_vm._v(\" \"),(_vm.chartType=='heatmapChart')?_c('heatmap-pic',{attrs:{\"isShow\":_vm.isMyChartShow,\"itemParams\":_vm.itemParams}}):_vm._e(),_vm._v(\" \"),(_vm.chartType=='pieChart')?_c('pie-pic',{attrs:{\"isShow\":_vm.isMyChartShow,\"itemParams\":_vm.itemParams}}):_vm._e(),_vm._v(\" \"),(_vm.chartType=='dataTable')?_c('data-tab-pic',{attrs:{\"isShow\":_vm.isMyChartShow,\"itemParams\":_vm.itemParams}}):_vm._e()],1)],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('thead',[_c('tr',[_c('th',[_vm._v(\"视图ID\")]),_vm._v(\" \"),_c('th',[_vm._v(\"视图类型\")]),_vm._v(\" \"),_c('th',[_vm._v(\"视图描述\")]),_vm._v(\" \"),_c('th',{staticStyle:{\"max-width\":\"260px\"}},[_vm._v(\"视图参数\")]),_vm._v(\" \"),_c('th',{staticStyle:{\"min-width\":\"30px\"}})])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_c('span',[_vm._v(\"Aggregation: \")]),_vm._v(\"Count\")])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-06ff88f2\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/dataVisualization/chartHistory.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-06ff88f2\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./chartHistory.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./chartHistory.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./chartHistory.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-06ff88f2\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./chartHistory.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-06ff88f2\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/dataVisualization/chartHistory.vue\n// module id = null\n// module chunks = ","<template>\r\n  <div>\r\n    <p class=\"nodataTxt\"><span v-if=\"chartLoadingShow\"><i class=\"el-icon-loading\"></i> {{$t('lg.loading2')}}</span><span v-if=\"yAxisData.length==0 && !chartLoadingShow\">{{$t('lg.nodata')}}</span></p>\r\n    <div id=\"chartContainer\" class=\"chartContainer\"></div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nimport * as types from '@/store/types';\r\nimport { SERVER_API_URL } from \"@/conf/constvar\";\r\nimport echarts from 'echarts';\r\nexport default {\r\n  props:{\r\n    isShow:{\r\n      type:Boolean\r\n    },\r\n    isLineChart:{\r\n      type:Boolean\r\n    },\r\n    itemParams:{\r\n      type:Object\r\n    }\r\n  },\r\n  data(){\r\n    return{\r\n      chartLoadingShow:false,\r\n      myChart:null,\r\n      legendData:[],\r\n      xAxisData:[],\r\n      yAxisData:[],\r\n    }\r\n  },\r\n  created(){\r\n    if(!this.isLineChart){//！！！如果父组件不是lineChart才触发\r\n      this.getLineChartData();\r\n    }\r\n  },\r\n  mounted(){//父组件为lineChart，预先画一下图,不然作图区域为空白的\r\n    if(this.isLineChart){\r\n      this.drawChart();\r\n    }\r\n  },\r\n  watch:{\r\n    'isShow':function(){\r\n      if(this.isShow){\r\n        this.getLineChartData();\r\n        if(this.myChart){\r\n          this.myChart.resize();//关闭弹框后窗口大小改变又再次打开弹框，视图还要做一次resize\r\n          window.addEventListener(\"resize\", () => {//弹框打开，监视浏览器窗口大小改变，视图resize\r\n            this.myChart.resize();\r\n          });\r\n        }\r\n      }else{\r\n        if(this.myChart){\r\n          this.myChart.clear();//关闭视图时清空视图，解决前一次数据闪现问题\r\n        }\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    getLineChartData(){\r\n      const _this=this;\r\n      _this.chartLoadingShow = true;\r\n      const url = SERVER_API_URL+\"dp/es/datachart/process\"; \r\n      console.log(_this.itemParams)\r\n      axios.post(url,{\r\n        chartType:'lineChart',\r\n        description:\"\",\r\n        params:_this.itemParams,\r\n        title:'lineChart'\r\n      }).then(res=>{\r\n        console.log(res);\r\n        if(res.data.responseCode==0){\r\n          let buckets = res.data.data.aggregations[2].buckets;\r\n          let xAxisArray=[];\r\n          let yAxisArray=[];\r\n          let legendValues=[];//legend\r\n\r\n          let yAxisObj={};//用来存放代表y轴折线的数组，有多个数组代表多条折线\r\n          let countArr=[];//用来存放count的数据，当Y-Axis内选有count时，要显示count的数据\r\n          \r\n          const lineChartYAxisArr = _this.itemParams.y;//取出来做遍历，以便获取legend\r\n          var countFlag=false; //做标记 如果Y-Axis内选有count时， 有count时在最后得到的legend里push'count'、yAxisArray里push包含count数据的对象\r\n          lineChartYAxisArr.forEach((ele,i)=>{\r\n            if(ele.agg=='count'){\r\n              countFlag=true;\r\n            }else{\r\n              legendValues.push(ele.field+'('+ ele.agg +')');\r\n            }\r\n          })\r\n\r\n          buckets.forEach(element=>{\r\n            countArr.push(element.doc_count);\r\n\r\n            //x轴\r\n            var xAxisVal= _this.transformMyDate(element.key);\r\n            if(xAxisArray.indexOf(xAxisVal)==-1){\r\n              xAxisArray.push(xAxisVal);\r\n            }\r\n\r\n            //把每一条折线放入对象yAxisObj\r\n            Object.keys(element).forEach(item=>{\r\n              if(!isNaN(item)){//如果是数字键，（同一个数字键对应的元素组成的数组代表一条坐标轴上的线,Y轴的值会由图表根据线对应的值自动感应出一个值的范围，有多条折线就代表有多个对应的Y轴值范围）\r\n                if(yAxisObj[item]){\r\n                  yAxisObj[item].push(element[item].value);\r\n                }else{\r\n                  yAxisObj[item]=[element[item].value];  //{3:[],4:[],5:[]....} \r\n                }\r\n              }\r\n            })\r\n          })\r\n          \r\n          legendValues.forEach((val,index)=>{\r\n            yAxisArray.push({\r\n              name:val,\r\n              type:'line',\r\n              data:yAxisObj[index+3]//对应上yAxisObj的键\r\n            })\r\n          })\r\n          console.log(yAxisObj)\r\n          console.log(legendValues)\r\n\r\n          if(countFlag){//如果Y-Axis内选有count时，多家一条count的折线，对应的legend也要多加一个元素‘count’\r\n            yAxisArray.push({  \r\n              name:'count',\r\n              type:'line',\r\n              data:countArr\r\n            });\r\n            legendValues.push('count');\r\n          }\r\n          \r\n          _this.xAxisData=xAxisArray;\r\n          _this.yAxisData=yAxisArray;\r\n          _this.legendData=legendValues;\r\n          _this.drawChart();\r\n          _this.chartLoadingShow = false;\r\n        }else{\r\n          _this.$message.error(_this.$t('lg.failed')+': '+res.data.data.message);\r\n          _this.chartLoadingShow = false;\r\n        }\r\n      }).catch(err=>{\r\n        console.log(err);\r\n        _this.chartLoadingShow = false;\r\n      })\r\n       _this.$emit('changeFlag',false);//如果lineChart是父组件，在父组件里点击生成视图，要把myChartFlag 的值重新变成false，（以便Watch做监视 isShow变动才能触发getLineChartData）\r\n    },\r\n    drawChart(){\r\n      const _this = this;\r\n      const dom = document.getElementById(\"chartContainer\");\r\n      _this.myChart = echarts.init(dom);\r\n\r\n      let option = {\r\n        title: {\r\n          text: 'Line Chart',\r\n          left:'20',\r\n          textStyle:{\r\n            fontSize:'16',\r\n            fontWeight:'normal',\r\n            color:'#606266'\r\n          }\r\n        },\r\n        tooltip: {\r\n          trigger: 'axis',\r\n          axisPointer: {\r\n            type: 'cross',\r\n            label: {\r\n              backgroundColor: '#6a7985'\r\n            }\r\n          }\r\n        },\r\n        legend: {\r\n          data:_this.legendData//\r\n        },\r\n        grid: {\r\n          left: '3%',\r\n          right: '5%',\r\n          top:'8%',\r\n          bottom:'4%',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          type: 'category',\r\n          boundaryGap: false,\r\n          data: _this.xAxisData//\r\n        },\r\n        yAxis: {\r\n          type: 'value'\r\n        },\r\n        series: _this.yAxisData//\r\n      };\r\n      _this.myChart.clear();\r\n      _this.myChart.setOption(option);\r\n    },\r\n    transformMyDate(d){\r\n      d=new Date(d);\r\n      function pad(n){\r\n        return n<10 ? '0'+n : n\r\n      }\r\n      return d.getFullYear()+\"-\"+pad(parseInt(d.getMonth())+1)+\"-\"+pad(d.getDate())+\" \"+pad(d.getHours())+':' + pad(d.getMinutes())+':' + pad(d.getSeconds());\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.chartContainer{\r\n  width: 100%;\r\n  height: 650px;\r\n}\r\n.nodataTxt{\r\n  position: absolute;\r\n  top: 40%;\r\n  left: 48%;\r\n  color:#888;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/dataVisualization/linePic.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('p',{staticClass:\"nodataTxt\"},[(_vm.chartLoadingShow)?_c('span',[_c('i',{staticClass:\"el-icon-loading\"}),_vm._v(\" \"+_vm._s(_vm.$t('lg.loading2')))]):_vm._e(),(_vm.yAxisData.length==0 && !_vm.chartLoadingShow)?_c('span',[_vm._v(_vm._s(_vm.$t('lg.nodata')))]):_vm._e()]),_vm._v(\" \"),_c('div',{staticClass:\"chartContainer\",attrs:{\"id\":\"chartContainer\"}})])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-371a9d8a\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/dataVisualization/linePic.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-371a9d8a\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./linePic.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./linePic.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./linePic.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-371a9d8a\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./linePic.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-371a9d8a\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/dataVisualization/linePic.vue\n// module id = null\n// module chunks = ","<template>\r\n  <div>\r\n    <p class=\"nodataTxt\"><span v-if=\"chartLoadingShow\"><i class=\"el-icon-loading\"></i> {{$t('lg.loading2')}}</span><span v-if=\"yAxisData.length==0 && !chartLoadingShow\">{{$t('lg.nodata')}}</span></p>\r\n    <div id=\"chartContainer\" class=\"chartContainer\"></div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nimport * as types from '@/store/types';\r\nimport { SERVER_API_URL } from \"@/conf/constvar\";\r\nimport echarts from 'echarts';\r\nexport default {\r\n  props:{\r\n    isShow:{\r\n      type:Boolean\r\n    },\r\n    isAreaChart:{\r\n      type:Boolean\r\n    },\r\n    itemParams:{\r\n      type:Object\r\n    }\r\n  },\r\n  data(){\r\n    return{\r\n      chartLoadingShow:false,\r\n      myChart:null,\r\n      legendData:[],\r\n      xAxisData:[],\r\n      yAxisData:[],\r\n    }\r\n  },\r\n  created(){\r\n    if(!this.isAreaChart){ //！！！如果父组件不是areaChart才触发\r\n      this.getAreaChartData();\r\n    }\r\n  },\r\n  mounted(){//父组件为areaChart，预先画一下图,不然作图区域为空白的\r\n    if(this.isAreaChart){\r\n      this.drawChart();\r\n    }\r\n  },\r\n  watch:{\r\n    'isShow':function(){\r\n      if(this.isShow){\r\n        this.getAreaChartData();\r\n        if(this.myChart){\r\n          this.myChart.resize();//关闭弹框后窗口大小改变又再次打开弹框，视图还要做一次resize\r\n          window.addEventListener(\"resize\", () => {//弹框打开，监视浏览器窗口大小改变，视图resize\r\n            this.myChart.resize();\r\n          });\r\n        }\r\n      }else{\r\n        if(this.myChart){\r\n          this.myChart.clear();//关闭视图时清空视图，解决前一次数据闪现问题\r\n        }\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    getAreaChartData(){\r\n      const _this=this;\r\n      _this.chartLoadingShow = true;\r\n      const url = SERVER_API_URL+\"dp/es/datachart/process\"; \r\n      console.log(_this.itemParams)\r\n      axios.post(url,{\r\n        chartType:'areaChart',\r\n        description:\"\",\r\n        params:_this.itemParams,\r\n        title:'areaChart'\r\n      }).then(res=>{\r\n        console.log(res);\r\n        if(res.data.responseCode==0){\r\n          let buckets = res.data.data.aggregations[2].buckets;\r\n          let xAxisArray=[];\r\n          let yAxisArray=[];\r\n          let legendValues=[];//legend\r\n\r\n          let yAxisObj={};//用来存放代表y轴折线的数组，有多个数组代表多条折线\r\n          let countArr=[];//用来存放count的数据，当Y-Axis内选有count时，要显示count的数据\r\n          \r\n          const areaChartYAxisArr = _this.itemParams.y;//取出来做遍历，以便获取legend\r\n          var countFlag=false; //做标记 如果Y-Axis内选有count时， 有count时在最后得到的legend里push'count'、yAxisArray里push包含count数据的对象\r\n          areaChartYAxisArr.forEach((ele,i)=>{\r\n            if(ele.agg=='count'){\r\n              countFlag=true;\r\n            }else{\r\n              legendValues.push(ele.field+'('+ ele.agg +')');\r\n            }\r\n          })\r\n\r\n          buckets.forEach(element=>{\r\n            countArr.push(element.doc_count);\r\n\r\n            //x轴\r\n            var xAxisVal= _this.transformMyDate(element.key);\r\n            if(xAxisArray.indexOf(xAxisVal)==-1){\r\n              xAxisArray.push(xAxisVal);\r\n            }\r\n\r\n            //把每一条折线放入对象yAxisObj\r\n            Object.keys(element).forEach(item=>{\r\n              if(!isNaN(item)){//如果是数字键，（同一个数字键对应的元素组成的数组代表一条坐标轴上的线,Y轴的值会由图表根据线对应的值自动感应出一个值的范围，有多条折线就代表有多个对应的Y轴值范围）\r\n                if(yAxisObj[item]){\r\n                  yAxisObj[item].push(element[item].value);\r\n                }else{\r\n                  yAxisObj[item]=[element[item].value];\r\n                }\r\n              }\r\n            })\r\n          })\r\n          \r\n          legendValues.forEach((val,index)=>{\r\n            yAxisArray.push({\r\n              name:val,\r\n              type:'line',\r\n              data:yAxisObj[index+3],//对应上yAxisObj的键\r\n              areaStyle: {\r\n                opacity:'1'\r\n              }\r\n            })\r\n          })\r\n\r\n          if(countFlag){//如果Y-Axis内选有count时，多家一条count的折线，对应的legend也要多加一个元素‘count’\r\n            yAxisArray.push({  \r\n              name:'count',\r\n              type:'line',\r\n              data:countArr,\r\n              areaStyle: {\r\n                opacity:'1'\r\n              }\r\n            });\r\n            legendValues.push('count');\r\n          }\r\n\r\n          _this.xAxisData=xAxisArray;\r\n          _this.yAxisData=yAxisArray;\r\n          _this.legendData=legendValues;\r\n          _this.drawChart();\r\n          _this.chartLoadingShow = false;\r\n          \r\n        }else{\r\n          _this.$message.error(_this.$t('lg.failed')+': '+res.data.data.message);\r\n          _this.chartLoadingShow = false;\r\n        }\r\n      }).catch(err=>{\r\n        console.log(err);\r\n        _this.chartLoadingShow = false;\r\n      })\r\n      _this.$emit('changeFlag',false);//如果areaChart是父组件，在父组件里点击生成视图，要把myChartFlag 的值重新变成false，（以便Watch做监视 isShow变动才能触发getAreaChartData）\r\n    },\r\n    drawChart(){\r\n      const _this = this;\r\n      const dom = document.getElementById(\"chartContainer\");\r\n      _this.myChart = echarts.init(dom);\r\n\r\n      let option = {\r\n        title: {\r\n          text: 'Area Chart',\r\n          left:'20',\r\n          textStyle:{\r\n            fontSize:'16',\r\n            fontWeight:'normal',\r\n            color:'#606266'\r\n          }\r\n        },\r\n        tooltip : {\r\n          trigger: 'axis',\r\n            axisPointer: {\r\n            type: 'cross',\r\n            label: {\r\n              backgroundColor: '#6a7985'\r\n            }\r\n          }\r\n        },\r\n        // toolbox: {\r\n        //   show : true,\r\n        //   feature : {\r\n        //     mark : {show: true},\r\n        //     dataView : {show: true, readOnly: false},\r\n        //     magicType: {show: true, type: ['line', 'bar' ,'stack','tiled']},\r\n        //     restore : {show: true},\r\n        //   },\r\n        //   right:'60'\r\n        // },\r\n        legend: {\r\n          data:_this.legendData//\r\n        },\r\n        grid: {\r\n          left: '3%',\r\n          right: '5%',\r\n          top:'8%',\r\n          bottom:'4%',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          type: 'category',\r\n          boundaryGap: false,\r\n          data: _this.xAxisData//\r\n        },\r\n        yAxis: {\r\n          type: 'value'\r\n        },\r\n        series: _this.yAxisData//\r\n      };\r\n      _this.myChart.clear();\r\n      _this.myChart.setOption(option);\r\n    },\r\n    transformMyDate(d){\r\n      d=new Date(d);\r\n      function pad(n){\r\n        return n<10 ? '0'+n : n\r\n      }\r\n      return d.getFullYear()+\"-\"+pad(parseInt(d.getMonth())+1)+\"-\"+pad(d.getDate())+\" \"+pad(d.getHours())+':' + pad(d.getMinutes())+':' + pad(d.getSeconds());\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.chartContainer{\r\n  width: 100%;\r\n  height: 650px;\r\n}\r\n.nodataTxt{\r\n  position: absolute;\r\n  top: 40%;\r\n  left: 48%;\r\n  color:#888;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/dataVisualization/areaPic.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('p',{staticClass:\"nodataTxt\"},[(_vm.chartLoadingShow)?_c('span',[_c('i',{staticClass:\"el-icon-loading\"}),_vm._v(\" \"+_vm._s(_vm.$t('lg.loading2')))]):_vm._e(),(_vm.yAxisData.length==0 && !_vm.chartLoadingShow)?_c('span',[_vm._v(_vm._s(_vm.$t('lg.nodata')))]):_vm._e()]),_vm._v(\" \"),_c('div',{staticClass:\"chartContainer\",attrs:{\"id\":\"chartContainer\"}})])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-78b15d34\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/dataVisualization/areaPic.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-78b15d34\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./areaPic.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./areaPic.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./areaPic.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-78b15d34\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./areaPic.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-78b15d34\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/dataVisualization/areaPic.vue\n// module id = null\n// module chunks = ","<template>\r\n  <div>\r\n    <p class=\"nodataTxt\"><span v-if=\"chartLoadingShow\"><i class=\"el-icon-loading\"></i> {{$t('lg.loading2')}}</span><span v-if=\"yAxisData.length==0 && !chartLoadingShow\">{{$t('lg.nodata')}}</span></p>\r\n    <div id=\"chartContainer\" class=\"chartContainer\"></div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nimport * as types from '@/store/types';\r\nimport { SERVER_API_URL } from \"@/conf/constvar\";\r\nimport echarts from 'echarts';\r\nexport default {\r\n  props:{\r\n    isShow:{\r\n      type:Boolean\r\n    },\r\n    isVerticalBarChart:{\r\n      type:Boolean\r\n    },\r\n    itemParams:{\r\n      type:Object\r\n    }\r\n  },\r\n  data(){\r\n    return{\r\n      chartLoadingShow:false,\r\n      myChart:null,\r\n      legendData:[],\r\n      xAxisData:[],\r\n      yAxisData:[],\r\n    }\r\n  },\r\n  created(){\r\n    if(!this.isVerticalBarChart){//！！！如果父组件不是verticalBarChart才触发\r\n      this.getVerticalBarChartData();\r\n    }\r\n  },\r\n  mounted(){//父组件为verticalBarChart，预先画一下图,不然作图区域为空白的\r\n    if(this.isVerticalBarChart){\r\n      this.drawChart();\r\n    }\r\n  },\r\n  watch:{\r\n    'isShow':function(){\r\n      if(this.isShow){\r\n        this.getVerticalBarChartData();\r\n        if(this.myChart){\r\n          this.myChart.resize();//关闭弹框后窗口大小改变又再次打开弹框，视图还要做一次resize\r\n          window.addEventListener(\"resize\", () => {//弹框打开，监视浏览器窗口大小改变，视图resize\r\n            this.myChart.resize();\r\n          });\r\n        }\r\n      }else{\r\n        if(this.myChart){\r\n          this.myChart.clear();//关闭视图时清空视图，解决前一次数据闪现问题\r\n        }\r\n      }\r\n    },\r\n  },\r\n  methods:{\r\n    getVerticalBarChartData(){\r\n      const _this=this;\r\n      _this.chartLoadingShow = true;\r\n      const url = SERVER_API_URL+\"dp/es/datachart/process\"; \r\n      console.log(_this.itemParams)\r\n      axios.post(url,{\r\n        chartType:'verticalBarChart',\r\n        description:\"\",\r\n        params:_this.itemParams,\r\n        title:'verticalBarChart'\r\n      }).then(res=>{\r\n        console.log(res);\r\n        if(res.data.responseCode==0){\r\n          let buckets = res.data.data.aggregations[2].buckets;\r\n          let xAxisArray=[];\r\n          let yAxisArray=[];\r\n          let legendValues=[];//legend\r\n\r\n          let yAxisObj={};//用来存放代表y轴折线的数组，有多个数组代表多条折线\r\n          let countArr=[];//用来存放count的数据，当Y-Axis内选有count时，要显示count的数据\r\n\r\n          const verticalBarChartYAxisArr = _this.itemParams.y;//取出来做遍历，以便获取legend\r\n          var countFlag=false; //做标记 如果Y-Axis内选有count时， 有count时在最后得到的legend里push'count'、yAxisArray里push包含count数据的对象\r\n          verticalBarChartYAxisArr.forEach((ele,i)=>{\r\n            if(ele.agg=='count'){\r\n              countFlag=true;\r\n            }else{\r\n              legendValues.push(ele.field+'('+ ele.agg +')');\r\n            }\r\n          })\r\n          \r\n          buckets.forEach(element=>{\r\n            countArr.push(element.doc_count);\r\n\r\n            //x轴\r\n            var xAxisVal= _this.transformMyDate(element.key);\r\n            if(xAxisArray.indexOf(xAxisVal)==-1){\r\n              xAxisArray.push(xAxisVal);\r\n            }\r\n\r\n            //把每一条折线放入对象yAxisObj\r\n            Object.keys(element).forEach(item=>{\r\n              if(!isNaN(item)){//如果是数字键，（同一个数字键对应的元素组成的数组代表一条坐标轴上的线,Y轴的值会由图表根据线对应的值自动感应出一个值的范围，有多条折线就代表有多个对应的Y轴值范围）\r\n                if(yAxisObj[item]){\r\n                  yAxisObj[item].push(element[item].value);\r\n                }else{\r\n                  yAxisObj[item]=[element[item].value];\r\n                }\r\n              }\r\n            })\r\n          })\r\n          \r\n          legendValues.forEach((val,index)=>{\r\n            yAxisArray.push({\r\n              name:val,\r\n              type:'bar',\r\n              data:yAxisObj[index+3]//对应上yAxisObj的键\r\n            })\r\n          })\r\n          console.log(yAxisObj)\r\n          console.log(legendValues)\r\n\r\n          if(countFlag){//如果Y-Axis内选有count时，多家一条count的折线，对应的legend也要多加一个元素‘count’\r\n            yAxisArray.push({  \r\n              name:'count',\r\n              type:'bar',\r\n              data:countArr\r\n            });\r\n            legendValues.push('count');\r\n          }\r\n\r\n          _this.xAxisData=xAxisArray;\r\n          _this.yAxisData=yAxisArray;\r\n          _this.legendData=legendValues;\r\n          _this.drawChart();\r\n          _this.chartLoadingShow = false;\r\n        }else{\r\n          _this.$message.error(_this.$t('lg.failed')+': '+res.data.data.message);\r\n          _this.chartLoadingShow = false;\r\n        }\r\n      }).catch(err=>{\r\n        console.log(err);\r\n        _this.chartLoadingShow = false;\r\n      })\r\n      _this.$emit('changeFlag',false);//如果verticalBarChart是父组件，在父组件里点击生成视图，要把myChartFlag 的值重新变成false，（以便Watch做监视 isShow变动才能触发getVerticalBarChartData）\r\n    },\r\n    drawChart(){\r\n      const _this = this;\r\n      const dom = document.getElementById(\"chartContainer\");\r\n      _this.myChart = echarts.init(dom);\r\n\r\n      let  option = {\r\n        title: {\r\n          text: 'Vertical Bar Chart',\r\n          left:'20',\r\n          textStyle:{\r\n            fontSize:'16',\r\n            fontWeight:'normal',\r\n            color:'#606266'\r\n          }\r\n        },\r\n        tooltip : {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n              type: 'cross',\r\n              label: {\r\n                backgroundColor: '#6a7985'\r\n              }\r\n            }\r\n        },\r\n        legend: {\r\n          data:_this.legendData//\r\n        },\r\n        grid: {\r\n          left: '3%',\r\n          right: '5%',\r\n          top:'8%',\r\n          bottom:'4%',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          type: 'category',\r\n          boundaryGap: false,\r\n          data: _this.xAxisData//\r\n        },\r\n        yAxis: {\r\n            type: 'value'\r\n        },\r\n        series: _this.yAxisData//\r\n      };\r\n      _this.myChart.clear();\r\n      _this.myChart.setOption(option);\r\n    },\r\n    transformMyDate(d){\r\n      d=new Date(d);\r\n      function pad(n){\r\n        return n<10 ? '0'+n : n\r\n      }\r\n      return d.getFullYear()+\"-\"+pad(parseInt(d.getMonth())+1)+\"-\"+pad(d.getDate())+\" \"+pad(d.getHours())+':' + pad(d.getMinutes())+':' + pad(d.getSeconds());\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.chartContainer{\r\n  width: 100%;\r\n  height: 650px;\r\n}\r\n.nodataTxt{\r\n  position: absolute;\r\n  top: 40%;\r\n  left: 48%;\r\n  color:#888;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/dataVisualization/verticalBarPic.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('p',{staticClass:\"nodataTxt\"},[(_vm.chartLoadingShow)?_c('span',[_c('i',{staticClass:\"el-icon-loading\"}),_vm._v(\" \"+_vm._s(_vm.$t('lg.loading2')))]):_vm._e(),(_vm.yAxisData.length==0 && !_vm.chartLoadingShow)?_c('span',[_vm._v(_vm._s(_vm.$t('lg.nodata')))]):_vm._e()]),_vm._v(\" \"),_c('div',{staticClass:\"chartContainer\",attrs:{\"id\":\"chartContainer\"}})])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-ca7777dc\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/dataVisualization/verticalBarPic.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-ca7777dc\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./verticalBarPic.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./verticalBarPic.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./verticalBarPic.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-ca7777dc\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./verticalBarPic.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-ca7777dc\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/dataVisualization/verticalBarPic.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}