{"version":3,"sources":["webpack:///src/components/behavior/bwlistpop.vue","webpack:///./src/components/behavior/bwlistpop.vue?db5e","webpack:///./src/components/behavior/bwlistpop.vue","webpack:///src/components/behavior/bwlist.vue","webpack:///./src/components/behavior/bwlist.vue?3377","webpack:///./src/components/behavior/bwlist.vue"],"names":["bwlistpop","__webpack_require__","Base64","Boolean","required","message","trigger","min","max","pattern","resetFields","this","tokenList","push","token","tokenBlacklistList","then","res","bwclose","data","msgList","msgStr","err","loading","behavior_bwlistpop","render","_vm","_h","$createElement","_c","_self","attrs","width","title","$t","visible","isShow","close-on-click-modal","before-close","on","update:visible","$event","ref","model","bwpopform","rules","bwpopformRules","label-width","staticStyle","position","_l","item","index","key","staticClass","directives","name","rawName","value","expression","click","delToken","_v","label","callback","$$v","$set","prop","type","trim","addToken","addBlackTk","_s","isAddTk","staticRenderFns","bwlist","getBwlist","_this2","resData","source","bwpop","normalizeComponent","ssrContext","behavior_bwlist","addBwToken","length","_e","_m","items","change","editBlackTk","href","del","isShowBwpop","editTkItem","bwlist_Component","bwlist_normalizeComponent","__webpack_exports__"],"mappings":"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","file":"static/js/22.7236ba2dfd1ac87de405.js","sourcesContent":["<template><!-- 新增or修改黑名单指纹 -->\r\n  <div>\r\n    <el-dialog width=\"40%\" :title=\"$t('lg.addblacklist')\" :visible.sync=\"isShow\" :close-on-click-modal=\"false\" :before-close=\"bwclose\">\r\n\r\n      <el-form ref=\"bwpopform\" :model=\"bwpopform\" :rules=\"bwpopformRules\" label-width=\"90px\">\r\n\r\n        <div style=\"position: relative;\">\r\n          <div class=\"orderBoxJamb\" v-for=\"(item,index) in bwpopform.tokenList\" :key=\"index\">\r\n            <span class=\"delTk\" @click=\"delToken(index)\" v-show=\"isAddTk\"><i class=\"el-icon-close\"></i></span>\r\n            <el-form-item label=\"是否被覆盖\">\r\n              <el-switch v-model=\"item.keep\"></el-switch>\r\n            </el-form-item>  \r\n            <el-form-item label=\"TOKEN\" :prop=\"'tokenList.' + index + '.token'\" :rules=\"bwpopformRules.token\">\r\n              <el-input type=\"text\" v-model.trim=\"item.token\"></el-input>\r\n            </el-form-item>\r\n          </div>\r\n          <span class=\"addTk\" @click=\"addToken\" :title=\"$t('lg.addmoreinternalbs')\" v-show=\"isAddTk\"><i class=\"el-icon-circle-plus-outline\"></i></span>\r\n        </div>\r\n        \r\n        <!-- <el-form-item label=\"NODES\" prop=\"nodes\">\r\n          <el-select v-model=\"bwpopform.nodes\" multiple :placeholder=\"$t('lg.select')\" @visible-change=\"getNodes($event)\" @change=\"selectAll\" style=\"width:100%\" :loading=\"getNodesLoading\">\r\n            <el-option\r\n              v-for=\"item in nodesdata\"\r\n              :key=\"item.snodeId\"\r\n              :label=\"item.isShadowGroup?item.hostName+'(集群)':item.hostName+'('+item.snodeId+')'\"\r\n              :value=\"item.snodeId\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item> -->\r\n        \r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"addBlackTk('bwpopform')\">{{isAddTk?$t('lg.add'):'确认'}}</el-button>\r\n          <el-button @click=\"bwclose()\">{{$t('lg.cancel')}}</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n      <loading v-show=\"locationLoading\" title=\"数据处理中...\"></loading>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from 'axios'\r\nimport loading from '@/components/loading/loading';\r\nlet Base64 = require('js-base64').Base64;\r\nimport {SERVER_API_URL} from '@/conf/constvar'\r\nexport default{\r\n  props:{\r\n    isShow:{\r\n      type:Boolean\r\n    },\r\n    isAddTk:{\r\n      type:Boolean\r\n    },\r\n    // editTkItem:{\r\n    //   type:Object\r\n    // }\r\n  },\r\n  data(){\r\n    return{\r\n      locationLoading:false,\r\n      bwpopform:{\r\n        tokenList:[\r\n          {\r\n            token:'',\r\n            keep:false,\r\n          }\r\n        ],\r\n        // nodes:[],\r\n      },\r\n      nodesdata:[],\r\n      getNodesLoading:false,\r\n      oldOptions :[{}],\r\n      bwpopformRules:{\r\n        token:[\r\n          {required:true, message:'不能为空', trigger:'blur'},\r\n          {min: 32, max: 32, message: '长度应该为 32 个字符', trigger: 'blur' },\r\n          {pattern:/^([0-9|a-f|A-F]*)$/,message: 'TOKEN格式应为：数字0-9或字母a-f、A-F组成的32位字符', trigger: 'change'},//十六进制0-9，a-f,A-F\r\n        ],\r\n        // nodes:[{required:true, message:'不能为空', trigger:'blur'}]\r\n      },\r\n    }\r\n  },\r\n  // watch:{\r\n  //   'isShow':function(){\r\n  //     if(this.isShow && !this.isAddTk){\r\n  //       this.bwpopform.tokenList=[\r\n  //         {\r\n  //           token:this.editTkItem.token,\r\n  //           keep:this.editTkItem.keep=='Y'?true:false,\r\n  //         }\r\n  //       ]\r\n  //     }\r\n  //   }\r\n  // },\r\n  methods:{\r\n    delToken(index){\r\n      if(this.bwpopform.tokenList.length==1){\r\n        return;\r\n      }\r\n      this.bwpopform.tokenList.splice(index,1);\r\n    },\r\n    addToken(){\r\n      this.bwpopform.tokenList.push({\r\n        token:'',\r\n        keep:false,\r\n      })\r\n    },\r\n   // getNodes(callback){\r\n    //   if(callback){\r\n    //     this.getNodesLoading=true;\r\n    //     var nodesurl=SERVER_API_URL+\"pe/shadow/snode\";// 查询当前所有业务节点\r\n    //     axios.get(nodesurl).then((res)=>{\r\n    //       if(res.data.responseCode==0){\r\n    //         const resArray = res.data.data;\r\n    //         resArray.unshift({\r\n    //           hostName:\"所有选项\",\r\n    //           snodeId:\"allOptions\"\r\n    //         })\r\n    //         this.nodesdata=resArray;\r\n    //       }else{\r\n    //         this.$message.error('操作失败: '+ res.data.data.message);\r\n    //       }\r\n    //       this.getNodesLoading=false;\r\n    //     }).catch((err)=>{\r\n    //       console.log(err)\r\n    //     });\r\n    //   }\r\n   // },\r\n   // selectAll(val){ //选取多个节点功能\r\n    //   // console.log(val)\r\n    //   const _this = this;\r\n    //   let allValues = [];\r\n    //   //保留所有值\r\n    //   for (let item of _this.nodesdata) {\r\n    //     allValues.push(item.snodeId)\r\n    //   }\r\n\r\n    //   // 用来储存上一次的值，可以进行对比\r\n    //   const oldVal = _this.oldOptions.length === 1 ?[]: _this.oldOptions[1];\r\n\r\n    //   // 若是全部选择\r\n    //   if (val.includes('allOptions')){\r\n    //     _this.bwpopform.nodes = allValues;\r\n    //   } \r\n\r\n    //   // 取消全部选中  上次有 当前没有 表示取消全选\r\n    //   if (oldVal.includes('allOptions') && !val.includes('allOptions')) {\r\n    //     _this.bwpopform.nodes = [];\r\n    //   }\r\n\r\n    //   // 点击非全部选中  需要排除全部选中 以及 当前点击的选项 \r\n    //   // 新老数据都有全部选中 \r\n    //   if (oldVal.includes('allOptions') && val.includes('allOptions')) {\r\n    //     const index = val.indexOf('allOptions')\r\n    //     val.splice(index, 1) // 排除全选选项\r\n    //     _this.bwpopform.nodes = val\r\n    //   }\r\n\r\n    //   //全选未选 但是其他选项全部选上 则全选选上 上次和当前 都没有全选\r\n    //   if (!oldVal.includes('allOptions') && !val.includes('allOptions')) {\r\n    //     if (val.length === allValues.length - 1){\r\n    //       _this.bwpopform.nodes = ['allOptions'].concat(val)\r\n    //     } \r\n    //   }\r\n\r\n    //   //储存当前最后的结果 作为下次的老数据 \r\n    //   _this.oldOptions[1] = _this.bwpopform.nodes;\r\n   // },\r\n    bwclose() {\r\n      this.$refs['bwpopform'].resetFields();\r\n      this.bwpopform.tokenList=[{\r\n        token:'',\r\n        keep:false,\r\n      }];\r\n      this.$emit('bwclose',false);\r\n    },\r\n    addBlackTk(formname){//加入黑名单\r\n      var _this=this;\r\n      var url=SERVER_API_URL+\"pe/shadow/token/blacklist\";\r\n      // var tokenArray=[]; // snodeIds=[]\r\n      const tokenArray=_this.bwpopform.tokenList;\r\n      // if(_this.bwpopform.nodes.includes('allOptions')){//去掉 所有选项 \r\n      //   _this.bwpopform.nodes.shift();\r\n      // }\r\n      // _this.bwpopform.nodes.map((item)=>{\r\n      //   snodeIds.push({\r\n      //     snodeId:item\r\n      //   });\r\n      // });\r\n      var tokenBlacklistList=[];\r\n      tokenArray.forEach(ele=>{\r\n        tokenBlacklistList.push(\r\n          {\r\n            token:ele.token,\r\n            \"source\": [\"ui\"],\r\n            keep:ele.keep?'N':'Y'\r\n          }\r\n        )\r\n      })\r\n      // console.log(tokenBlacklistList);\r\n      _this.$refs[formname].validate((valid)=>{\r\n        if(valid){\r\n          _this.locationLoading=true;\r\n          // let requestMethod='post';\r\n          // if(!_this.isAddTk){requestMethod='patch'} //修改\r\n          axios.post(url,{\r\n            tokenBlacklistList:tokenBlacklistList\r\n          }).then((res)=>{\r\n            // console.log(res)\r\n            if(res.data.responseCode==0){\r\n              this.$message({\r\n                type: 'success',\r\n                message: '操作成功'\r\n              });\r\n              _this.$emit(\"getBwlist\");\r\n              _this.bwclose();\r\n            }else{\r\n              const msgList = res.data.data;\r\n              const msgStr = _this.handleMsg(msgList);\r\n              _this.$message.error('操作失败: '+msgStr);\r\n            }\r\n            _this.locationLoading=false;\r\n          }).catch((err)=>{\r\n            console.log(err);\r\n          })\r\n        }\r\n      });\r\n    },\r\n    handleMsg(arr){//处理返回的错误提示信息\r\n      let msgStr='';\r\n      arr.forEach(ele=>{\r\n        for(let key in ele){\r\n          msgStr+=key+':'+ele[key].data.message+';'\r\n        }\r\n      })\r\n      // console.log(msgStr)\r\n      return msgStr\r\n    }\r\n  },\r\n  components:{\r\n    loading\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.addTk{\r\n  display: block;\r\n  position: absolute;\r\n  right: 3px;\r\n  bottom: -25px;\r\n  cursor: pointer;\r\n  z-index: 1;\r\n}\r\n.delTk{\r\n  position: absolute;\r\n  right: 3px;\r\n  top: 2px;\r\n  cursor: pointer;\r\n}\r\n</style>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/behavior/bwlistpop.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-dialog',{attrs:{\"width\":\"40%\",\"title\":_vm.$t('lg.addblacklist'),\"visible\":_vm.isShow,\"close-on-click-modal\":false,\"before-close\":_vm.bwclose},on:{\"update:visible\":function($event){_vm.isShow=$event}}},[_c('el-form',{ref:\"bwpopform\",attrs:{\"model\":_vm.bwpopform,\"rules\":_vm.bwpopformRules,\"label-width\":\"90px\"}},[_c('div',{staticStyle:{\"position\":\"relative\"}},[_vm._l((_vm.bwpopform.tokenList),function(item,index){return _c('div',{key:index,staticClass:\"orderBoxJamb\"},[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isAddTk),expression:\"isAddTk\"}],staticClass:\"delTk\",on:{\"click\":function($event){_vm.delToken(index)}}},[_c('i',{staticClass:\"el-icon-close\"})]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"是否被覆盖\"}},[_c('el-switch',{model:{value:(item.keep),callback:function ($$v) {_vm.$set(item, \"keep\", $$v)},expression:\"item.keep\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"TOKEN\",\"prop\":'tokenList.' + index + '.token',\"rules\":_vm.bwpopformRules.token}},[_c('el-input',{attrs:{\"type\":\"text\"},model:{value:(item.token),callback:function ($$v) {_vm.$set(item, \"token\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"item.token\"}})],1)],1)}),_vm._v(\" \"),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isAddTk),expression:\"isAddTk\"}],staticClass:\"addTk\",attrs:{\"title\":_vm.$t('lg.addmoreinternalbs')},on:{\"click\":_vm.addToken}},[_c('i',{staticClass:\"el-icon-circle-plus-outline\"})])],2),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.addBlackTk('bwpopform')}}},[_vm._v(_vm._s(_vm.isAddTk?_vm.$t('lg.add'):'确认'))]),_vm._v(\" \"),_c('el-button',{on:{\"click\":function($event){_vm.bwclose()}}},[_vm._v(_vm._s(_vm.$t('lg.cancel')))])],1)],1),_vm._v(\" \"),_c('loading',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.locationLoading),expression:\"locationLoading\"}],attrs:{\"title\":\"数据处理中...\"}})],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4b1517b2\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/behavior/bwlistpop.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4b1517b2\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./bwlistpop.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./bwlistpop.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./bwlistpop.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4b1517b2\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./bwlistpop.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4b1517b2\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/behavior/bwlistpop.vue\n// module id = null\n// module chunks = ","<template>\r\n  <div class=\"bwlist-wrapper\">\r\n    <h2 class=\"breadcrumb\">{{$t('lg.zwHeimingdan')}}</h2>\r\n    \r\n    <div class=\"btn-bg\">\r\n      <el-button type=\"primary\" @click=\"addBwToken\">{{$t('lg.add')}}</el-button>\r\n    </div>\r\n    \r\n    <div v-if=\"bwlist.length==0\" class=\"nodata-box\">{{$t('lg.nodata')}}</div>\r\n\r\n    <div class=\"bwlist-table\">\r\n      <table v-if=\"bwlist.length>0\">\r\n        <thead>\r\n          <tr>\r\n            <th>TOKEN</th>\r\n            <!-- <th>SNODEID</th> -->\r\n            <th>来源方式</th>\r\n            <th>TOKEN是否会被覆盖</th>\r\n            <th width=\"100\"></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"item in bwlist\">\r\n            <td>{{item.token}}</td>\r\n            <!-- <td>\r\n              <p v-for=\"items in item.snodeId\" class=\"pArrTxt\">{{items}}</p>\r\n            </td> -->\r\n            <td>\r\n              <p v-for=\"items in item.source\" class=\"pArrTxt\">{{items==='ui'?'手动添加':'被报警任务：'+items+' 扫描发现'}}</p>\r\n            </td>\r\n            <td>\r\n              <!-- {{item.keep}} -->\r\n              <el-switch v-model=\"item.keepSwitch\" @change=\"editBlackTk(item)\"></el-switch>\r\n            </td>\r\n            <td class=\"text-center\">\r\n              <!-- <a href=\"javascript:;\" class=\"edit-del-a\" @click=\"editBWToken(item)\"><i class=\"el-icon-edit-outline\"></i>{{$t('lg.edit')}}</a> -->\r\n              <a href=\"javascript:;\" class=\"edit-del-a\" @click=\"del(item)\"><i class=\"el-icon-close\"></i>{{$t('lg.delete')}}</a>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    <bwpop :isShow=\"isShowBwpop\" :isAddTk=\"isAddTk\" :editTkItem=\"editTkItem\" @bwclose=\"isShowBwpop=false;editTkItem={};\" @getBwlist=\"getBwlist\"></bwpop>\r\n  </div>\r\n</template>\r\n<script>\r\nimport bwpop from '@/components/behavior/bwlistpop';\r\nimport {SERVER_API_URL} from '@/conf/constvar';\r\nimport axios from 'axios';\r\nexport default{\r\n  data(){\r\n    return{\r\n      detailLoading:false,\r\n      bwlist:[],\r\n      isShowBwpop:false,\r\n      isAddTk:true,//为true代表增加，false代表修改\r\n      editTkItem:{},\r\n    }\r\n  },\r\n  created(){\r\n    this.$store.state.contentLoading=true;\r\n    this.getBwlist();\r\n  },\r\n  mounted(){\r\n    this.$on('updateBwlist',()=>{\r\n      this.getBwlist();\r\n    });\r\n  },\r\n  methods:{\r\n    getBwlist(){//查询token黑名单\r\n      var url=SERVER_API_URL+\"pe/shadow/token/blacklist\";\r\n      axios.get(url).then((res)=>{\r\n        // console.log(res)\r\n        if(res.data.responseCode==0){\r\n          const resData=res.data.data;\r\n          resData.forEach((element) =>{\r\n            element.keepSwitch = element.keep=='N'?true:false;\r\n            // if(element.source.includes('ui') && element.source.length>1){\r\n            //   const index= element.source.indexOf('ui')\r\n            //   element.source.splice(index,1)\r\n            // }\r\n          });\r\n          this.bwlist=resData;\r\n        }else{\r\n          this.$message.error('操作失败:'+ res.data.data.message);\r\n        }\r\n        this.$store.state.contentLoading=false;\r\n      }).catch((err)=>{\r\n        console.log(err)\r\n      });\r\n    },\r\n  \r\n    addBwToken(){//增加黑名单指纹\r\n      this.isShowBwpop=true;\r\n      // this.isAddTk=true;\r\n    },\r\n    // editBWToken(item){//编辑黑名单指纹\r\n    //   this.isShowBwpop=true;\r\n    //   this.editTkItem=item;\r\n    //   this.isAddTk=false;\r\n    // },\r\n    editBlackTk(item){//修改黑名单\r\n      // console.log(item)\r\n      var _this=this;\r\n      _this.$store.state.contentLoading=true;\r\n      var url=SERVER_API_URL+\"pe/shadow/token/blacklist\";\r\n      const tokenBlacklistList=[\r\n        {\r\n          token:item.token,\r\n          source: item.source,\r\n          keep:item.keepSwitch?'N':'Y'\r\n        }\r\n      ]\r\n      axios.patch(url,{\r\n        tokenBlacklistList:tokenBlacklistList\r\n      }).then((res)=>{\r\n        if(res.data.responseCode==0){\r\n          _this.$message({\r\n            type: 'success',\r\n            message: '操作成功'\r\n          });\r\n        }else{\r\n          const msgList = res.data.data;\r\n          const msgStr = _this.handleMsg(msgList);\r\n          _this.$message.error('操作失败: '+msgStr);\r\n          // item.keepSwitch=!item.keepSwitch;\r\n        }\r\n        // _this.$store.state.contentLoading=false;\r\n        _this.getBwlist();\r\n      }).catch((err)=>{\r\n        console.log(err);\r\n      })\r\n    },\r\n    del(item){//删除黑名单指纹\r\n      var url=SERVER_API_URL+\"pe/shadow/token/blacklist\";\r\n      this.$store.state.contentLoading=true;\r\n      axios.delete(url,{\r\n        data:{\r\n            tokenBlacklistList:[{\r\n              token:item.token,\r\n            }]\r\n          // snodeIds:[{\"snodeId\":item.snodeId}]\r\n        }\r\n      }).then((res)=>{\r\n        // console.log(res)\r\n        if(res.data.responseCode==0){\r\n          this.$message({\r\n            type: 'success',\r\n            message: '操作成功'\r\n          });\r\n          this.$emit(\"updateBwlist\")\r\n        }else{\r\n          const msgList = res.data.data;\r\n          const msgStr = this.handleMsg(msgList);\r\n          this.$message.error('操作失败: '+msgStr);\r\n        }\r\n        this.$store.state.contentLoading=false;\r\n      }).catch((err)=>{\r\n        console.log(err);\r\n      });\r\n    },\r\n    handleMsg(arr){//处理返回的错误提示信息\r\n      let msgStr='';\r\n      arr.forEach(ele=>{\r\n        for(let key in ele){\r\n          msgStr+=key+':'+ele[key].data.message+';'\r\n        }\r\n      })\r\n      return msgStr\r\n    }\r\n  },\r\n  components:{\r\n    bwpop\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.bwlist-wrapper{\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  padding: 15px;\r\n  box-sizing: border-box;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.pArrTxt{\r\n  line-height: 22px;\r\n}\r\n.bwlist-table{\r\n  flex: 1;\r\n  overflow-y: auto;\r\n}\r\n</style>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/behavior/bwlist.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"bwlist-wrapper\"},[_c('h2',{staticClass:\"breadcrumb\"},[_vm._v(_vm._s(_vm.$t('lg.zwHeimingdan')))]),_vm._v(\" \"),_c('div',{staticClass:\"btn-bg\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.addBwToken}},[_vm._v(_vm._s(_vm.$t('lg.add')))])],1),_vm._v(\" \"),(_vm.bwlist.length==0)?_c('div',{staticClass:\"nodata-box\"},[_vm._v(_vm._s(_vm.$t('lg.nodata')))]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"bwlist-table\"},[(_vm.bwlist.length>0)?_c('table',[_vm._m(0),_vm._v(\" \"),_c('tbody',_vm._l((_vm.bwlist),function(item){return _c('tr',[_c('td',[_vm._v(_vm._s(item.token))]),_vm._v(\" \"),_c('td',_vm._l((item.source),function(items){return _c('p',{staticClass:\"pArrTxt\"},[_vm._v(_vm._s(items==='ui'?'手动添加':'被报警任务：'+items+' 扫描发现'))])})),_vm._v(\" \"),_c('td',[_c('el-switch',{on:{\"change\":function($event){_vm.editBlackTk(item)}},model:{value:(item.keepSwitch),callback:function ($$v) {_vm.$set(item, \"keepSwitch\", $$v)},expression:\"item.keepSwitch\"}})],1),_vm._v(\" \"),_c('td',{staticClass:\"text-center\"},[_c('a',{staticClass:\"edit-del-a\",attrs:{\"href\":\"javascript:;\"},on:{\"click\":function($event){_vm.del(item)}}},[_c('i',{staticClass:\"el-icon-close\"}),_vm._v(_vm._s(_vm.$t('lg.delete')))])])])}))]):_vm._e()]),_vm._v(\" \"),_c('bwpop',{attrs:{\"isShow\":_vm.isShowBwpop,\"isAddTk\":_vm.isAddTk,\"editTkItem\":_vm.editTkItem},on:{\"bwclose\":function($event){_vm.isShowBwpop=false;_vm.editTkItem={};},\"getBwlist\":_vm.getBwlist}})],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('thead',[_c('tr',[_c('th',[_vm._v(\"TOKEN\")]),_vm._v(\" \"),_c('th',[_vm._v(\"来源方式\")]),_vm._v(\" \"),_c('th',[_vm._v(\"TOKEN是否会被覆盖\")]),_vm._v(\" \"),_c('th',{attrs:{\"width\":\"100\"}})])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-c0096ee0\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/behavior/bwlist.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-c0096ee0\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./bwlist.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./bwlist.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./bwlist.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-c0096ee0\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./bwlist.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-c0096ee0\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/behavior/bwlist.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}