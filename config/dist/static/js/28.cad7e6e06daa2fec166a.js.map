{"version":3,"sources":["webpack:///src/components/home/attackChart.vue","webpack:///./src/components/home/attackChart.vue?057e","webpack:///./src/components/home/attackChart.vue"],"names":["attackChart","emitter","pienodata","queryPanel","logRebuild","logTables","_this2","this","getCustomHeadData","resize","handleTime","getAllchart","_this3","isQuery","domainName","urlArr","isFalg","attackSum","drawUrlAtckCtBar","drawAttackTypePie","drawOrgIpLine","drawOrgIpPie","drawDomainLine","drawDomainPie","drawRegionBar","checkDomain","checkUrl","filterObj","starttime","endtime","sttime","edtime","dateTimeLong","Date","fromTime","endTime","fromTimeUTC","endTimeUTC","value","waf","businessDom","then","res","j2","doc_count","dataJV2","key","b","push","valData2","timeinterval","valData","xaxisData2","seriesData","getTime","adTstart","adTend","name","str","topArrays","labelOption","sdata","getOnepieceFromPie","i","result","logDialogTitle","orgIpDom","j","dataJV","legendData","xaxisData","sort","a","domainDom","cityName","latNum","lonNum","filterGeo","requestFullscreen","myChart1Str","replace","myCharArray","myChart8Str","filename","err","pageNum","must","item","pageSize","clientQueryObj","res2","hits","logResArr","requeryObj","obj","n","d","getSeconds","home_attackChart","render","_vm","_h","$createElement","_c","_self","staticClass","directives","rawName","expression","on","getAllQuerychart","_v","attrs","gutter","span","staticStyle","position","element-loading-spinner","element-loading-background","mystyle","_e","id","_s","$t","totalNum","attackSumNum","padding-left","wholeCtMax","wholeCtMin","normalCtMax","normalCtMin","forFastShow","click","forfastloadmore","title","visible","logDialogVisible","width","before-close","logDialogClose","update:visible","$event","tableKeyArr","tableKeyArrWaf","dynamicTag","chartLogsHeadData","refilterColBy","refilterColByWaf","requeryRowBy","requeryRowByWaf","chartLogsTotalNum","ref","tabheadData","tabodyData","chartLogsBodyData","isLogLoding","getChangeLogData","src","alt","fullScreen","downLoadPdf","goBackMap","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/28.cad7e6e06daa2fec166a.js","sourcesContent":["<template>\r\n  <div class=\"attackChart-wrapper\">\r\n    <query-panel @getAllQuerychart=\"getAllchart\" @handleTime=\"handleTime\" v-show=\"isShowQueryPanel\"></query-panel><!-- 查询面板 -->\r\n    <div class=\"attackChartContent\">\r\n      <el-row :gutter=\"10\" class=\"chartRow\">\r\n        <el-col :span=\"14\">\r\n          <div class=\"chart-content\" style=\"position:relative;\"\r\n              v-loading=\"urlAtckCtLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <pienodata mystyle=\"linenodata\" v-if=\"urlAtckCtBarNodata\"></pienodata>\r\n            <div id=\"urlAtckCtContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"10\">\r\n          <div class=\"chart-content numBox txtOverflow\">\r\n            <p class=\"text-center numBoxTitle\">{{$t('lg.totaldatav')}}</p>\r\n            <div class=\"totalBox\">\r\n              <p class='numTitle'>{{$t('lg.totalrquestammount')}}</p>\r\n              <p class=\"totalNum\">{{totalNum}}<span class=\"uTxt\">{{$t('lg.count')}}</span></p>\r\n            </div>\r\n            <div class=\"abnormalBox\">\r\n              <p class='numTitle'>{{$t('lg.totalattack')}}</p>\r\n              <p class=\"abnormalNum\">{{attackSumNum}}<span class=\"uTxt\">{{$t('lg.count')}}</span></p>\r\n            </div>\r\n          </div>\r\n        </el-col>\r\n        <!-- <el-col :span=\"10\">\r\n          <div class=\"chart-content\" \r\n              v-loading=\"attackTypeLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"attackTypeNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>{{$t('lg.nodata')}}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"attackTypeContainer\"></div>\r\n          </div>\r\n        </el-col> -->\r\n      </el-row>\r\n\r\n      <el-row :gutter=\"10\" class=\"chartRow\">\r\n        <el-col :span=\"16\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"orgIpLineLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <pienodata  mystyle=\"linenodata\" v-if=\"orgIpLineNodata\"></pienodata>\r\n            <div id=\"orgIpLineContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"chart-content\" \r\n              v-loading=\"orgIpPieLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"orgIpPieNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>{{$t('lg.nodata')}}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"orgIpPieContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row :gutter=\"10\" class=\"chartRow\">\r\n        <el-col :span=\"16\">\r\n          <div class=\"chart-content\" \r\n              v-loading=\"domainLineLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <pienodata  mystyle=\"linenodata\" v-if=\"domainLineNodata\"></pienodata>\r\n            <div id=\"domainLineContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"chart-content\"\r\n              v-loading=\"domainPieLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"domainPieNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>{{$t('lg.nodata')}}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"domainPieContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row :gutter=\"10\" class=\"chartRow lastChartRow\">\r\n        <el-col :span=\"14\">\r\n          <div class=\"chart-content\" \r\n              v-loading=\"regionBarLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <pienodata mystyle=\"linenodata\" v-if=\"regionBarNodata\"></pienodata>\r\n            <div id=\"regionBarContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n         <el-col :span=\"10\">\r\n          <div class=\"chart-content\" \r\n              v-loading=\"attackTypeLoading\"\r\n              element-loading-spinner=\"el-icon-loading\"\r\n              element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n            <div class=\"adaptive-circle\" v-if=\"attackTypeNodata\">\r\n              <div class=\"layout middle\">\r\n                <div>\r\n                  <p>{{$t('lg.nodata')}}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div id=\"attackTypeContainer\"></div>\r\n          </div>\r\n        </el-col>\r\n        <!-- <el-col :span=\"10\">\r\n          <div class=\"chart-content numBox txtOverflow\">\r\n            <p class=\"text-center numBoxTitle\">{{$t('lg.totaldatav')}}</p>\r\n            <div class=\"totalBox\">\r\n              <p class='numTitle'>{{$t('lg.totalrquestammount')}}</p>\r\n              <p class=\"totalNum\">{{totalNum}}<span class=\"uTxt\">{{$t('lg.count')}}</span></p>\r\n            </div>\r\n            <div class=\"abnormalBox\">\r\n              <p class='numTitle'>{{$t('lg.totalattack')}}</p>\r\n              <p class=\"abnormalNum\">{{attackSumNum}}<span class=\"uTxt\">{{$t('lg.count')}}</span></p>\r\n            </div>\r\n          </div>\r\n        </el-col> -->\r\n      </el-row>\r\n      <el-row :gutter=\"20\" class=\"chartRow chartRowBusi\"  v-if=\"forFastShow\">\r\n        <!-- <el-col :span=\"18\" class=\"busiChartBox\"> -->\r\n          <el-col :span=\"20\" style=\"padding-left:0px\">\r\n            <div  class=\"chart-content\" \r\n                  v-loading=\"businessLineLoading\"\r\n                  element-loading-spinner=\"el-icon-loading\"\r\n                  element-loading-background=\"rgba(0, 0, 0, 0)\">\r\n              <pienodata mystyle=\"linenodata\" v-if=\"businessNodata\"></pienodata>\r\n              <div id=\"businessContainer\"></div>\r\n            </div>\r\n          </el-col>\r\n          <el-col :span=\"4\" class=\"busiNumBox\">\r\n            <ul class=\"totalList\">\r\n              <li class=\"listTitle\">{{$t('lg.totalrequests')}}：</li>\r\n              <li>\r\n                <i class=\"liLable\">MAX:</i>\r\n                <p class=\"liValue\">{{wholeCtMax}}</p>\r\n              </li>\r\n              <li>\r\n                <i class=\"liLable\">MIN:</i>\r\n                <p class=\"liValue\">{{wholeCtMin}}</p>\r\n              </li>\r\n            </ul>\r\n            <ul class=\"someList\">\r\n              <li class=\"listTitle\">{{$t('lg.gongji')}}：</li>\r\n              <li>\r\n                <i class=\"liLable\">MAX:</i>\r\n                <p class=\"liValue\">{{normalCtMax}}</p>\r\n              </li>\r\n              <li>\r\n                <i class=\"liLable\">MIN:</i>\r\n                <p class=\"liValue\">{{normalCtMin}}</p>\r\n              </li>\r\n            </ul>\r\n          </el-col>\r\n        <!-- </el-col> -->\r\n        <!-- <el-col :span=\"6\">\r\n          <div class=\"chart-content numBox txtOverflow\">\r\n            <p class=\"text-center numBoxTitle\">{{$t('lg.totaldatav')}}</p>\r\n            <div class=\"totalBox\">\r\n              <p class='numTitle'>{{$t('lg.totalrquestammount')}}</p>\r\n              <p class=\"totalNum\">{{totalNum}}<span class=\"uTxt\">{{$t('lg.count')}}</span></p>\r\n            </div>\r\n            <div class=\"abnormalBox\">\r\n              <p class='numTitle'>{{$t('lg.totalattack')}}</p>\r\n              <p class=\"abnormalNum\">{{attackSumNum}}<span class=\"uTxt\">{{$t('lg.count')}}</span></p>\r\n            </div>\r\n          </div>\r\n        </el-col> -->\r\n      </el-row>\r\n    </div>\r\n    <p class=\"fastloadmore\" v-if=\"!forFastShow\" @click=\"forfastloadmore\">点击查看更多图表</p>\r\n    <!-- 日志弹框 -->\r\n    <el-dialog :title=\"logDialogTitle\" :visible.sync=\"logDialogVisible\" width=\"80%\" :before-close=\"logDialogClose\">\r\n      <log-rebuild :tableKeyArr='tableKeyArrWaf' :dynamicTag='chartLogsHeadData' @refilterColBy='refilterColByWaf' @requeryRowBy='requeryRowByWaf'></log-rebuild>\r\n      <div v-if=\"chartLogsTotalNum==0\" class=\"nodata-box\">{{$t('lg.nodata')}}</div>\r\n      <div v-if=\"chartLogsTotalNum>0\" class=\"logTableHeight\">\r\n        <log-tables ref=\"log_tables\" :tabheadData=\"chartLogsHeadData\" :tabodyData=\"chartLogsBodyData\" :totalNum=\"chartLogsTotalNum\" @getChangeLogData=\"getChangeLogData\" :isLogLoding=\"false\"></log-tables>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!-- <timing-task-pop  :isShow=\"isShowTimingTask\" :myTaskType=\"'esSearch'\" :myTaskTypeTxt=\"'基于‘恶意攻击源IP’报警'\" :alertmark=\"'maliciousAttack'\"  @setTimingTaskClose=\"isShowTimingTask=false\"></timing-task-pop> -->\r\n    \r\n    <!-- <div :title=\"$t('lg.returnmap')\" class=\"goBackBtn\">\r\n      <router-link tag=\"a\" to=\"/attack\"><i class=\"fa fa-globe font-blue\"></i> {{$t('lg.returnmap')}}</router-link>\r\n    </div> \r\n    <div :title=\"$t('lg.exportchart')\" class=\"downBtn\">\r\n      <a href=\"javascript:;\" @click=\"downLoadPdf\"><i class=\"fa fa-cloud-download font-green\"></i> {{$t('lg.exportchart')}}</a>\r\n    </div>  -->\r\n\r\n    <!-- 右侧操作列表 -->\r\n    <ul class=\"operationBtnUl\"\r\n        v-show=\"isShowGridMenu\">\r\n      <li>\r\n        <img src=\"static/icon/fullScreen.png\"\r\n             alt=\"大屏展示\"\r\n             title=\"大屏展示\"\r\n             @click=\"fullScreen\">\r\n      </li>\r\n      \r\n      <li>\r\n        <img src=\"static/icon/downpdfChart.png\"\r\n             alt=\"导出pdf\"\r\n             title=\"导出pdf\"\r\n             @click=\"downLoadPdf\">\r\n      </li>\r\n      <li>\r\n        <img src=\"static/icon/map.png\"\r\n             alt=\"返回地图\"\r\n             title=\"返回地图\"\r\n             @click=\"goBackMap\">\r\n      </li>\r\n    </ul>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport {SERVER_API_URL} from '@/conf/constvar';\r\nimport echarts from 'echarts';\r\nimport * as types from '@/store/types'\r\nimport client from \"@/components/es/connection\";\r\nimport toSddate from '@/assets/js/tosddate';\r\nimport toISO8601 from '@/assets/js/iso8601';\r\nimport queryPanel from './queryPanel';\r\nimport pienodata from '@/basecomponents/pienodata';\r\nimport {logskeys} from '@/assets/js/logskeys';\r\nimport logRebuild from \"@/components/logs/logRebuild\";\r\nimport logTables from '@/components/logs/logTables';\r\nimport Emitter from 'element-ui/src/mixins/emitter';\r\nimport {handleWaflogData} from '@/assets/js/tool';\r\n// import timingTaskPop from '@/components/alarmTask/timingTaskPop';\r\nexport default {\r\n  mixins: [Emitter],\r\n  components:{\r\n    pienodata,\r\n    queryPanel,\r\n    logRebuild,\r\n    logTables,\r\n  },\r\n  data(){\r\n    return{\r\n      forFastShow:false,\r\n      fromTime:0,\r\n      endTime:0,\r\n      fromTimeUTC:0,\r\n      endTimeUTC:0,\r\n      timeinterval:'',\r\n\r\n      //顶部查询面板\r\n      isFalg:false,//判断是否通过查询面板来查询的阀门\r\n      checkDomain:'',\r\n      checkUrl:'',\r\n      filterObj:{\"match_all\": {}},\r\n\r\n      //max min \r\n      wholeCtMax:0,\r\n      wholeCtMin:0,\r\n      normalCtMax:0,\r\n      normalCtMin:0,\r\n\r\n      businessLineLoading:false,\r\n      urlAtckCtLoading:false,\r\n      attackTypeLoading:false,\r\n      orgIpLineLoading:false,\r\n      orgIpPieLoading:false,\r\n      domainLineLoading:false,\r\n      domainPieLoading:false,\r\n      regionBarLoading:false,\r\n\r\n      businessLineChart:null,\r\n      urlAtckCtBarChart:null,\r\n      attackTypeChart:null,\r\n      orgIpLineChart:null,\r\n      orgIpPieChart:null,\r\n      domainLineChart:null,\r\n      domainPieChart:null,\r\n      regionBarChart:null,\r\n      \r\n      businessNodata:false,\r\n      urlAtckCtBarNodata:false,\r\n      attackTypeNodata:false,\r\n      orgIpLineNodata:false,\r\n      orgIpPieNodata:false,\r\n      domainLineNodata:false,\r\n      domainPieNodata:false,\r\n      regionBarNodata:false,\r\n      \r\n      totalNum:0,\r\n      attackSumNum:0,\r\n\r\n      //日志弹框参数\r\n      popQueryObj:{\"bool\":{\"must\":[{\"term\":{\"log.file.path\":\"/usr/local/shadow/logs/shadow_waf.log\"}}]}},\r\n      logDialogVisible:false,\r\n      logDialogTitle:'',\r\n      tableKeyArrWaf:[...logskeys.waf],//waf.log总共（默认）显示的字段\r\n      chartLogsHeadData:[],//waf.log用户自定义显示的字段\r\n      chartLogsBodyData:[],//传入logTables.vue子组件的表体数据\r\n      chartLogsTotalNum:0,\r\n      fromPage:0,\r\n      pageSize:10,\r\n      requeryObj:null,//日志弹框里面的requery子组件的查询条件\r\n      \r\n      // 报警任务\r\n      // isShowTimingTask:false,\r\n\r\n      // isAlertingShow:false,\r\n      // alertMark:'',\r\n      // alertTitle:'',\r\n      // alertData:{},\r\n      // alertLine:false,\r\n\r\n      //大屏展示\r\n      isShowQueryPanel:true,//上方查询面板大屏展示时要隐藏\r\n      isShowGridMenu:true,//右下角菜单大屏展示时要隐藏\r\n\r\n    }\r\n  },\r\n  created(){\r\n    // this.$store.state.isShowTimerate = true;//采样频率选择\r\n    // this.$store.state.mydatedata.interval = '5m';\r\n    // this.$store.state.timerateValue='采样频率';\r\n\r\n    this.getCustomHeadData();\r\n    \r\n    window.addEventListener(\"resize\", () => {\r\n      this.urlAtckCtBarChart.resize();//slow\r\n      this.attackTypeChart.resize();\r\n      this.orgIpLineChart.resize();\r\n      this.orgIpPieChart.resize();\r\n      this.domainLineChart.resize();\r\n      this.domainPieChart.resize();\r\n      this.businessLineChart.resize();///slow\r\n      this.regionBarChart.resize();//slow\r\n    });\r\n  },\r\n  watch:{\r\n    '$store.state.mydatedata.timestampnow':function(){\r\n      this.handleTime();\r\n      this.getAllchart();\r\n    },\r\n    '$store.state.isMenuShow':function(){\r\n      this.urlAtckCtBarChart.resize();\r\n      this.attackTypeChart.resize();\r\n      this.orgIpLineChart.resize();\r\n      this.orgIpPieChart.resize();\r\n      this.domainLineChart.resize();\r\n      this.domainPieChart.resize();\r\n      if(this.forFastShow){\r\n        this.businessLineChart.resize();\r\n      }\r\n      this.regionBarChart.resize();\r\n    }\r\n  },\r\n  mounted(){\r\n    if(!this.$route.query.timeInterval){\r\n      this.handleTime();\r\n      this.getAllchart();\r\n    }\r\n\r\n    // this.$refs.domainlinebox.oncontextmenu=()=>{\r\n    //   var _this=this;\r\n    //   this.alertTitle=\"恶意攻击域名Top5\";\r\n    //   this.alertMark=\"attackDomainTop5\"\r\n    //   this.alertData=_this.cloneObj(_this.isDomainAlertData);\r\n    //   this.alertLine=this.isDomainAlertLine;\r\n    //   this.isAlertingShow=true;\r\n    //   return false;\r\n    // }\r\n  },\r\n  methods:{\r\n    //创建即执行\r\n    forfastloadmore(){\r\n      this.forFastShow=true;\r\n      this.$nextTick(()=>{\r\n           this.drawBusinessLine();//slow\r\n        });\r\n    },\r\n    getAllchart(querOobj){\r\n      if(querOobj){//通过查询面板查询\r\n        this.isFalg=querOobj.isQuery;\r\n        this.checkDomain=querOobj.domainName;\r\n        this.checkUrl=querOobj.urlArr;\r\n\r\n        this.filterObj=this.getFilterObjWAF(this.isFalg);\r\n      }\r\n      if(this.forFastShow){\r\n         this.drawBusinessLine();//slow\r\n      }\r\n      this.getRequestNum(this.isFalg);\r\n      this.attackSum();\r\n      this.drawUrlAtckCtBar();\r\n      this.drawAttackTypePie();\r\n      this.drawOrgIpLine();\r\n      this.drawOrgIpPie();\r\n      this.drawDomainLine();\r\n      this.drawDomainPie();\r\n      this.drawRegionBar();\r\n    },\r\n    getFilterObjWAF(flag,typeAccess){//输入条件后手动查询，不输入查询条件则查询所有数据\r\n      var _this=this;\r\n      var filterObj ={\"match_all\": {}};\r\n\r\n      var queryStr1 = \"shadow.waf.host:\",queryStr2=\"shadow.waf.uri:\";\r\n      if(typeAccess){\r\n        queryStr1=\"shadow.access.domain:\";\r\n        queryStr2=\"shadow.access.org_url:\"\r\n      }\r\n\r\n      if(flag){\r\n        var domainVariable = _this.checkDomain;\r\n        var urlVariable = _this.checkUrl;\r\n        filterObj = {\r\n          \"bool\": {\r\n              \"must\":[\r\n                {\"query_string\": {\r\n                  \"query\": queryStr1+'\\\"'+domainVariable+'\\\"'\r\n                }}\r\n              ]\r\n            }\r\n          }\r\n          if(urlVariable){\r\n            var regxpUrl=/(\\/)+/g;\r\n            var regUrlVariable =urlVariable.replace(regxpUrl,'\\\\$1');\r\n            filterObj.bool.must.push({\"query_string\": {\r\n              \"query\": queryStr2+'\\\"'+regUrlVariable+'\\\"'\r\n            }})\r\n          }\r\n      }else{\r\n        filterObj ={\"match_all\": {}};\r\n      }\r\n      return filterObj;\r\n    },\r\n    handleTime(){\r\n      var _this=this;\r\n      var sttime=_this.$store.state.mydatedata.starttime,\r\n          edtime=_this.$store.state.mydatedata.endtime;\r\n      var fromTime2=toSddate(sttime),\r\n          endTime2=toSddate(edtime);\r\n      var fromTime=fromTime2 || toSddate(new Date(Date.now()-_this.$store.state.dateTimeLong)),\r\n          endTime=endTime2 || toSddate(new Date()); \r\n      _this.fromTime=fromTime;\r\n      _this.endTime=endTime;\r\n\r\n      var fromTime3=toISO8601(sttime),//access.log -8小时\r\n          endTime3=toISO8601(edtime);\r\n      var fromTimeUTC=fromTime3 || toISO8601(new Date(Date.now()-_this.$store.state.dateTimeLong)),\r\n          endTimeUTC=endTime3 || toISO8601(new Date());\r\n      _this.fromTimeUTC=fromTimeUTC;\r\n      _this.endTimeUTC=endTimeUTC;\r\n\r\n      _this.timeinterval=_this.$store.state.mydatedata.interval || '5m';\r\n    },\r\n    getCustomHeadData(){ // 获取恶意访问日志弹框waf.log表头（用户自定义的表头）\r\n      var url = SERVER_API_URL + '/pe/shadow/kv/attackChartWaf';\r\n      axios.get(url).then(res =>{\r\n        if(!res.data.data){\r\n          this.chartLogsHeadData = [...logskeys.waf]\r\n        }else{\r\n          this.chartLogsHeadData = res.data.data.value;\r\n        }\r\n      })\r\n    },\r\n\r\n    //图表\r\n    drawBusinessLine(){\r\n      var _this=this;\r\n      _this.businessLineLoading=true;\r\n      var businessDom=document.getElementById('businessContainer');\r\n      _this.businessLineChart = echarts.init(businessDom);\r\n\r\n      _this.businessLineChart.off('brushSelected');//一定要清除brush事件\r\n      var brushFalg = false;//设置一个阀值，鼠标弹起时才触发\r\n      businessDom.addEventListener(\"mousedown\", () => {\r\n        brushFalg=false;\r\n      });\r\n      businessDom.addEventListener(\"mouseup\", () => {\r\n        brushFalg=true;\r\n      });\r\n\r\n      var options = {\r\n          color:['#27727b','#d95850'],\r\n          title: {\r\n            text: _this.$t('lg.attackbusinessprotect'),\r\n            x:'left',\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip : {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n              type: 'shadow',\r\n              label: {\r\n                show: true\r\n              }\r\n            }\r\n          },\r\n          legend: {\r\n            top:'20px',\r\n            data:[_this.$t('lg.totalrequests'),_this.$t('lg.gongji')],\r\n            itemGap: 5\r\n          },\r\n          grid: {\r\n            left: '5%',\r\n            right: '3%',\r\n            bottom:'4%',\r\n            top:'20%',\r\n            containLabel: true\r\n          },\r\n          brush: {\r\n            toolbox: ['lineX'],\r\n            xAxisIndex: \"all\",\r\n            transformable:false,\r\n            throttleType:'debounce',\r\n            throttleDelay: 1000,\r\n            brushStyle:{\r\n              borderWidth: 0,\r\n            }\r\n          },\r\n          toolbox: {\r\n            right:'20',\r\n            top:'10',\r\n          },\r\n          xAxis: {\r\n            show:false,\r\n            data : []\r\n          },\r\n          yAxis: {\r\n            show:false,\r\n            name:_this.$t('lg.counts'),\r\n          },\r\n          series : []\r\n        };\r\n      function lineTimerFn(){\r\n        // lineTimer().then((nodes)=>{\r\n        //   var nodeArr=[];\r\n        //   for(var n=0;n<nodes.aggregations.langs.buckets.length;n++){\r\n        //     nodeArr.push(\r\n        //       nodes.aggregations.langs.buckets[n].key\r\n        //     )\r\n        //   }\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body:  {\r\n            \"size\":0,\r\n            \"query\": {\r\n            \"bool\": {\r\n              \"filter\": _this.filterObj,\r\n              \"must\": [{\r\n                \"term\": {\r\n                  \"log.file.path\": \"/usr/local/shadow/logs/access.log\"\r\n                }\r\n              }, {\r\n              \"exists\": {\r\n                \"field\": \"shadow.access.method\"\r\n              }\r\n            }, {\r\n                \"range\": {\r\n                  \"@timestamp\": {\r\n                    \"from\": _this.fromTimeUTC,\r\n                    \"to\": _this.endTimeUTC,\r\n                    \"include_lower\": true,\r\n                    \"include_upper\": true\r\n                  }\r\n                }\r\n              }]\r\n            }\r\n          },\r\n          \"aggs\":{\"time_histo\":{\"date_histogram\":{\"field\":\"@timestamp\",\"interval\":_this.timeinterval,\"extended_bounds\":{\"min\":_this.fromTimeUTC,\"max\":_this.endTimeUTC}}}}//时间轴\r\n          }\r\n        }).then((res)=>{\r\n          var tarResult2=res.aggregations?res.aggregations.time_histo.buckets:[];\r\n          var valData2=[],xaxisData2=[];\r\n          var legendData=[],seriesData=[];\r\n          var wholeCtArr=[];\r\n          \r\n          for(var j2=0;j2<tarResult2.length;j2++){\r\n            var dataJ2=tarResult2[j2];\r\n            var dataJV2=dataJ2.doc_count;\r\n\r\n            if(dataJV2!=0){\r\n              wholeCtArr.push(dataJV2);\r\n            }\r\n\r\n            if(!dataJV2){\r\n              dataJV2=0\r\n            }\r\n            valData2.push(dataJV2);\r\n            xaxisData2.push(_this.transformMyDate(dataJ2.key));\r\n          }\r\n          \r\n          wholeCtArr.sort(function(a,b){//min max\r\n            return a-b;\r\n          });\r\n          _this.wholeCtMin=wholeCtArr[0]||0;\r\n          _this.wholeCtMax=wholeCtArr[wholeCtArr.length-1]||0;\r\n\r\n          seriesData.push(\r\n            {\r\n              name:_this.$t('lg.totalrequests'),\r\n              type:'bar',\r\n              data:valData2,\r\n              barMaxWidth: 10,\r\n              large: true\r\n            }\r\n          );\r\n\r\n          client.search({////////2\r\n          index: \"shadow-filebeat-*\",\r\n          body:  {\r\n            \"size\":0,\r\n            \"query\": {\r\n            \"bool\": {\r\n              \"filter\": _this.filterObj,\r\n              \"must_not\": {\r\n                  \"exists\": {\r\n                    \"field\": \"error\"\r\n                  }\r\n                },\r\n              \"must\": [{\r\n                \"term\": {\r\n                  \"log.file.path\": \"/usr/local/shadow/logs/shadow_waf.log\"\r\n                }\r\n              },{\r\n                \"range\": {\r\n                  \"@timestamp\": {\r\n                    \"from\": _this.fromTime,\r\n                    \"to\": _this.endTime,\r\n                    \"include_lower\": true,\r\n                    \"include_upper\": true\r\n                  }\r\n                }\r\n              }]\r\n            }\r\n          },\r\n          \"aggs\":{\r\n            \"time_histo\":{\r\n              \"date_histogram\":{\r\n                \"field\":\"@timestamp\",\r\n                \"interval\":_this.timeinterval,\r\n                \"extended_bounds\":{\r\n                  \"min\":_this.fromTime,\r\n                  \"max\":_this.endTime\r\n                }\r\n              }}}\r\n            }\r\n          }).then((res)=>{\r\n            //  console.log(res);\r\n            var tarResult=res.aggregations?res.aggregations.time_histo.buckets:[];\r\n            var valData=[],normalCtArr=[];\r\n\r\n            if(tarResult.length==0){\r\n              options.xAxis.show=false;\r\n              options.yAxis.show=false;\r\n              _this.businessNodata=true;\r\n            }else{\r\n              options.xAxis.show=true;\r\n              options.yAxis.show=true;\r\n              _this.businessNodata=false;\r\n            }\r\n\r\n            for(var j2=0;j2<tarResult.length;j2++){\r\n              var dataJ2=tarResult[j2];\r\n              var dataJV2=dataJ2.doc_count;\r\n\r\n              if(dataJV2!=0){\r\n                normalCtArr.push(dataJV2);\r\n              }\r\n\r\n              if(!dataJV2){\r\n                dataJV2=0\r\n              }\r\n              valData.push(dataJV2);\r\n            }\r\n\r\n            normalCtArr.sort(function(a,b){//最小值\r\n              return a-b;\r\n            });\r\n            _this.normalCtMin=normalCtArr[0]||0;\r\n            _this.normalCtMax=normalCtArr[normalCtArr.length-1]||0;\r\n\r\n            seriesData.push(\r\n              {\r\n                name:_this.$t('lg.gongji'),\r\n                type:'bar',\r\n                data:valData,\r\n                barMaxWidth: 10,\r\n                large: true\r\n              }\r\n            );\r\n\r\n            // console.log(seriesData);\r\n            options.xAxis.data=xaxisData2;\r\n            options.series=seriesData;\r\n            \r\n            _this.businessLineChart.setOption(options,true);\r\n            _this.businessLineLoading=false;\r\n\r\n            //brush 操作\r\n            _this.businessLineChart.on('brushSelected', function (params) {\r\n              // console.log(params)\r\n              if(brushFalg){\r\n                if(params.batch && params.batch[0].areas[0]){\r\n                  // console.log(params.batch[0])\r\n                  var startIndex=params.batch[0].areas[0].coordRange[0]=='-0'||params.batch[0].areas[0].coordRange[0]<0?0:params.batch[0].areas[0].coordRange[0];\r\n                  var endIndex=params.batch[0].areas[0].coordRange[1];\r\n                  var tstart=xaxisData2[startIndex],tend=xaxisData2[endIndex]?xaxisData2[endIndex]:xaxisData2[endIndex-1];\r\n\r\n                  if(tstart==tend){ //采样频率稍大时（为'5m'时很容易出现这个问题）,如果用户选定的范围只在一个采样点内（只拉动一个阴影格），会导致起始查询时间和截止查询时间一致，这时在这个时间点上可能没有数据（但看起来应该有数据，采样频率导致的），因此遇到这种情况就把起始时间的范围以及截止时间的范围都各自扩大一个采样点，这样保证了用户只选取一个阴影格的时候也会有数据。\r\n                    // console.log(tstart,tend,'相等');\r\n                    var adTstart=new Date(tstart).getTime(),adTend=new Date(tend).getTime();\r\n                    if(_this.$store.state.mydatedata.interval=='5m'){//此时interval=='1d' 或者 '1h'的可能性很小，因此没写了\r\n                      adTstart-=5*60*1000;\r\n                      adTend+=5*60*1000;\r\n                    }else if(_this.$store.state.mydatedata.interval=='10s'){\r\n                      adTstart-=10*1000;\r\n                      adTend+=10*1000;\r\n                    }else if(_this.$store.state.mydatedata.interval=='1s'){ //interval=='1s' 采样频率精确到1s，在往下拉也会一直有数据，因此也没写了\r\n                      // adTstart-=1*1000\r\n                      // adTend+=1*1000\r\n                    }\r\n                    tstart = _this.transformMyDate(adTstart);\r\n                    tend = _this.transformMyDate(adTend);\r\n                  }\r\n                  // console.log(tstart,tend);\r\n\r\n                  _this.$store.state.nowTimeVal=[new Date(tstart),new Date(tend)];//改变右上角时间（跟拉到的时间保持一致）\r\n                  clearTimeout(_this.$store.state.refreshTimeout)//图表轮询定时器 清除按时刷新数据的定时器\r\n                  _this.$store.state.refreshAble=true;//禁用自动刷新\r\n                  setTimeout(()=>{\r\n                    _this.$store.commit(types.MYDATEPICKER);\r\n                  },0)\r\n                }\r\n              }\r\n            });\r\n            })\r\n          });\r\n        // })\r\n      }\r\n      lineTimerFn();\r\n    },\r\n    getRequestNum(flag){//请求总量 slow\r\n      var _this=this;\r\n      var filterObj=_this.getFilterObjWAF(flag,true);\r\n      client.search({\r\n        index:\"shadow-filebeat-*\",\r\n        body:{\r\n         // \"size\": 0,\r\n          \"track_total_hits\": true,\r\n          \"sort\": {\r\n            \"@timestamp\": \"desc\"\r\n          },\r\n          \"query\": {\r\n            \"bool\": {\r\n              \"filter\": filterObj,\r\n              \"must\": [{\r\n                \"term\": {\r\n                  \"log.file.path\": \"/usr/local/shadow/logs/access.log\"\r\n                }\r\n              },{\r\n              \"exists\": {\r\n                \"field\": \"shadow.access.method\"\r\n              }\r\n            },  {\r\n                \"range\": {\r\n                  \"@timestamp\": {\r\n                    \"from\": _this.fromTimeUTC,\r\n                    \"to\": _this.endTimeUTC,\r\n                    \"include_lower\": true,\r\n                    \"include_upper\": true\r\n                  }\r\n                }\r\n              }]\r\n            }\r\n          }\r\n        }\r\n      }).then((res)=>{\r\n        _this.totalNum=res.hits.total.value;\r\n      })\r\n    },\r\n    attackSum(){\r\n      var _this=this;\r\n      client.search({\r\n        index:\"shadow-filebeat-*\",\r\n        body:{\r\n         // \"size\": 0,\r\n          \"track_total_hits\": true,\r\n          \"query\": {\r\n            \"bool\": {\r\n              \"filter\": _this.filterObj,\r\n              \"must_not\": {\r\n                  \"exists\": {\r\n                    \"field\": \"error\"\r\n                  }\r\n                },\r\n              \"must\": [{\r\n                \"term\": {\r\n                  \"log.file.path\": \"/usr/local/shadow/logs/shadow_waf.log\"\r\n                }\r\n              },{\r\n                \"range\": {\r\n                  \"@timestamp\": {\r\n                    \"from\": _this.fromTime,\r\n                    \"to\": _this.endTime,\r\n                    \"include_lower\": true,\r\n                    \"include_upper\": true\r\n                  }\r\n                }\r\n              }]\r\n            }\r\n          }\r\n        }\r\n      }).then((res)=>{\r\n        _this.attackSumNum=res.hits.total.value;\r\n      })\r\n    },\r\n    drawUrlAtckCtBar(){\r\n      var _this=this;\r\n      _this.urlAtckCtLoading=true;\r\n      _this.urlAtckCtBarChart = echarts.init(document.getElementById('urlAtckCtContainer'));\r\n    \r\n      //设置‘基于错误码统计的恶意攻击次数/Top10’图的显示文字\r\n      var labelOption = {\r\n        normal: {\r\n          show: true,\r\n          rotate: 0,\r\n          align: 'left',\r\n          verticalAlign: 'middle',\r\n          position: 'insideLeft',\r\n          distance: 10,\r\n          // color:'#000',\r\n          formatter:function(params){\r\n            // console.log(params)\r\n            const str = params.data.name;               \r\n            return str;\r\n          },\r\n          fontSize: 12,\r\n        }\r\n      };\r\n      var option = {\r\n        color:['#c1232b'],\r\n        title: {\r\n          text: _this.$t('lg.numattacktop10'),\r\n          x:'center',\r\n          textStyle: {\r\n            fontSize: '16',\r\n            fontWeight: 'normal'\r\n          }\r\n        },\r\n        tooltip: {\r\n          show:false,\r\n          trigger: 'axis',\r\n          confine:true,\r\n          axisPointer: {\r\n            type: 'shadow'\r\n          },\r\n          extraCssText:'white-space:normal;word-break: break-all',\r\n          formatter:function(params, ticket, callback){\r\n            var str = '';\r\n            params.forEach(item=>{\r\n              str = item.data.name+_this.$t('lg.numattackis')+':'+item.data.value+_this.$t('lg.count')\r\n            })\r\n            return str;\r\n          }\r\n        },\r\n        // legend: {\r\n        //   data: [],\r\n        //   top:'30px',\r\n        // },\r\n        grid: {\r\n          top:'12%',\r\n          left: '0',\r\n          right: '50',\r\n          bottom: '2%',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          show:false,\r\n          type: 'value',\r\n          name:_this.$t('lg.counts'),\r\n          boundaryGap: [0,0.01],\r\n          position:'top',\r\n          splitLine:{\r\n            show:false\r\n          },\r\n          minInterval: 1//保持x轴刻度只为整数\r\n        },\r\n        yAxis: { \r\n          show:false,\r\n          type: 'category',\r\n          data: [],\r\n          inverse: true,//是否是反向坐标轴 （这里反向后数据降序排列）\r\n        },\r\n        series: []\r\n      };\r\n      function getUrlAtckCtData(){\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body: {\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must_not\": {\r\n                  \"exists\": {\r\n                    \"field\": \"error\"\r\n                  }\r\n                },\r\n                \"must\": [\r\n                  {\r\n                    \"term\": {\r\n                      \"log.file.path\": \"/usr/local/shadow/logs/shadow_waf.log\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"range\": {\r\n                      \"@timestamp\": {\r\n                        \"gte\": _this.fromTime,\r\n                        \"lte\": _this.endTime,\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"url\": {\r\n                \"terms\": {\r\n                  \"field\": \"shadow.waf.uri\",\r\n                  \"size\": 10\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }).then((res)=>{\r\n          // console.log(res);\r\n          var resResult=res.aggregations?res.aggregations.url.buckets:[];\r\n          // resResult=[\r\n          //   {key: \"/search.aspx\", doc_count: 10},\r\n          //   {key: \"/ch.aspx\", doc_count: 8},\r\n          // ]\r\n\r\n          let topArrays=[];              //存 ['top5','top4','top3','top2','top1']\r\n          let topArray=resResult.length;               //取前面10位  top10\r\n          for(var i=0;i<topArray;i++){   //遍历出top 数组\r\n            topArrays.push(`top${i+1}`);\r\n          } \r\n          // topArrays.reverse();//反序\r\n          option.yAxis.data=topArrays;\r\n\r\n          var sdata=[];\r\n          for(var i=0; i<topArrays.length;i++){\r\n            if(resResult[i]){\r\n              sdata.push({\r\n                value:resResult[i].doc_count,\r\n                name:resResult[i].key,\r\n              });\r\n            }else{\r\n              sdata.push({\r\n                name:\"-\",\r\n                value:\"-\"\r\n              });\r\n            }\r\n          }\r\n          // sdata.sort(function(a,b){return b.value-a.value});\r\n          // sdata.reverse();//反序\r\n          option.series=[{          \r\n            type: 'bar',\r\n            label: labelOption,\r\n            data:sdata,\r\n            barMaxWidth:30,\r\n          }]\r\n          // console.log(option.series)\r\n          if(resResult.length==0){\r\n            option.xAxis.show=false;\r\n            option.yAxis.show=false;\r\n            option.tooltip.show=false;\r\n            _this.urlAtckCtBarNodata=true;\r\n          }else{\r\n            option.xAxis.show=true;\r\n            option.yAxis.show=true;\r\n            option.tooltip.show=true;\r\n            _this.urlAtckCtBarNodata=false;\r\n          }\r\n          _this.urlAtckCtBarChart.setOption(option,true);\r\n          _this.urlAtckCtLoading=false;\r\n\r\n           _this.urlAtckCtBarChart.off(\"click\");\r\n          _this.urlAtckCtBarChart.on(\"click\",(params)=>{\r\n            // console.log(params)\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                  \"query\":\"shadow.waf.uri:\"+_this.logDialogTitle.replace(/\\//g,'\\\\/')\r\n                } \r\n              });\r\n            _this.getOnepieceFromPie();\r\n        });\r\n\r\n        });\r\n      }\r\n      getUrlAtckCtData();\r\n    },\r\n    drawAttackTypePie(){\r\n      var _this=this;\r\n      _this.attackTypeLoading=true;\r\n      _this.attackTypeChart = echarts.init(document.getElementById('attackTypeContainer'));\r\n      var options = {\r\n        color:['#e87c25','#b5c334','#fe8463','#9bca63','#f3a43b','#60c0dd','#d7504b','#f0805a','#26c0c0'],\r\n        title : {\r\n          text: _this.$t('lg.numattacktypetop10'),\r\n          x:'center',\r\n          textStyle: {\r\n            fontSize: '16',\r\n            fontWeight: 'normal'\r\n          }\r\n        },\r\n        tooltip: {\r\n          trigger: 'item',\r\n          formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n        },\r\n        // legend: {\r\n        //   orient: 'horizontal',\r\n        //   bottom:'0px',\r\n        //   data:[]\r\n        // },\r\n        series: [\r\n          {\r\n            name:_this.$t('lg.attacktype'),\r\n            type:'pie',\r\n            radius:['25%','35%'],\r\n            // radius: '40%',\r\n            // center: ['50%', '50%'],\r\n            data:[].sort(function (a, b) { return a.value - b.value; }),\r\n            // roseType: 'radius',//area radius\r\n            label: {\r\n              position:'outside',\r\n              normal: {\r\n                textStyle: {\r\n                  fontSize: '12',  \r\n                },\r\n                formatter: \"{b}: {c}\"\r\n              },\r\n              emphasis: {\r\n                show: true,\r\n                textStyle: {\r\n                  fontSize: '14',\r\n                  fontWeight: 'normal'\r\n                }\r\n              }\r\n            },\r\n            labelLine: {\r\n              normal: {\r\n                smooth: 0,\r\n                length: 10,\r\n                length2: 20,\r\n              },\r\n            },\r\n            animationType: 'scale',\r\n            animationEasing: 'elasticOut',\r\n            animationDelay: function (idx) {\r\n              return Math.random() * 200;\r\n            }\r\n          }\r\n        ]\r\n      };\r\n      function getAttackTypePieData(){\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body: {\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": [\r\n                  {\r\n                    \"term\": {\r\n                      \"log.file.path\": \"/usr/local/shadow/logs/shadow_waf.log\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"range\": {\r\n                      \"@timestamp\": {\r\n                        \"gte\": _this.fromTime,\r\n                        \"lte\": _this.endTime\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"attacktype\": {\r\n                \"terms\": {\r\n                  \"field\": \"shadow.waf.attacktype\",\r\n                  \"size\": 10\r\n                }\r\n              }\r\n            }\r\n\r\n          }\r\n        }).then((res)=>{\r\n          // console.log(res);\r\n          var tarResult=res.aggregations?res.aggregations.attacktype.buckets:[];\r\n          var result=[],\r\n              legendRlt=[];\r\n          for(var i=0;i<tarResult.length;i++){\r\n            var dataI=tarResult[i];\r\n            result.push(\r\n              {\r\n                value:dataI[\"doc_count\"],\r\n                name:dataI[\"key\"]\r\n              }\r\n            );\r\n            legendRlt.push(dataI[\"key\"])\r\n          }\r\n          options.series[0].data=result;\r\n          // options.legend.data=legendRlt;\r\n          if(result.length==0){\r\n            _this.attackTypeNodata=true;\r\n          }else{\r\n            _this.attackTypeNodata=false;\r\n          }\r\n          _this.attackTypeChart.setOption(options,true);\r\n          _this.attackTypeLoading=false;\r\n\r\n           _this.attackTypeChart.off(\"click\");\r\n            _this.attackTypeChart.on(\"click\",(params)=>{\r\n              // console.log(params);\r\n              _this.logDialogVisible=true;\r\n              _this.logDialogTitle=params.name;\r\n              _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n              _this.popQueryObj.bool.must.push({\r\n                    \"query_string\": {\r\n                        \"query\":\"shadow.waf.attacktype:\"+_this.logDialogTitle\r\n                      }\r\n                });\r\n              _this.getOnepieceFromPie();\r\n            });\r\n        });\r\n      }\r\n      getAttackTypePieData();\r\n    },\r\n    drawOrgIpLine(){\r\n      var _this=this;\r\n      _this.orgIpLineLoading=true;\r\n      var orgIpDom=document.getElementById('orgIpLineContainer');\r\n      _this.orgIpLineChart = echarts.init(orgIpDom);\r\n\r\n      _this.orgIpLineChart.off('brushSelected');//一定要清除brush事件\r\n      var brushFalg = false;//设置一个阀值，鼠标弹起时才触发\r\n      orgIpDom.addEventListener(\"mousedown\", () => {\r\n        brushFalg=false;\r\n      });\r\n      orgIpDom.addEventListener(\"mouseup\", () => {\r\n        brushFalg=true;\r\n      });\r\n      \r\n      var options = {\r\n          color:['#4ea397','#22c3aa','#7bd9a5','#d0648a','#f58db2'],\r\n          title: {\r\n            text: _this.$t('lg.numattacksiptop5'),\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip: {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n              type: 'shadow',\r\n              label: {\r\n                show: true\r\n              }\r\n            }\r\n          },\r\n          legend: {\r\n            top:'20px',\r\n            data:[],\r\n          },\r\n          grid: {\r\n            left: '5%',\r\n            right: '3%',\r\n            bottom:'4%',\r\n            top:'25%',\r\n            containLabel: true\r\n          },\r\n          brush: {\r\n            toolbox: ['lineX'],\r\n            xAxisIndex: \"all\",\r\n            transformable:false,\r\n            throttleType:'debounce',\r\n            throttleDelay: 1000,\r\n            brushStyle:{\r\n              borderWidth: 0,\r\n            }\r\n          },\r\n          toolbox: {\r\n            show:false,\r\n            right:'10',\r\n            top:'10',\r\n          },\r\n          xAxis: {\r\n            show:false,\r\n            type: 'category',\r\n            data: [],\r\n          },\r\n          yAxis: {\r\n            show:false,\r\n            type: 'value',\r\n            name:_this.$t('lg.counts'),\r\n            minInterval: 1//保持y轴刻度只为整数\r\n          },\r\n          series: [\r\n            // {\r\n            //     name:'Step Start',\r\n            //     type:'line',\r\n            //     step: 'start',\r\n            //     data:[120, 132, 101, 134, 90, 230, 210]\r\n            // },\r\n            // {\r\n            //     name:'Step Middle',\r\n            //     type:'line',\r\n            //     step: 'middle',\r\n            //     data:[220, 282, 201, 234, 290, 430, 410]\r\n            // },\r\n          ]\r\n      };\r\n\r\n      client.search({\r\n      index: \"shadow-filebeat-*\",\r\n        body: {\r\n        \"size\": 0,\r\n        \"query\": {\r\n          \"bool\": {\r\n            \"filter\": _this.filterObj,\r\n            \"must\": [\r\n              {\r\n                \"term\": {\r\n                  \"log.file.path\": \"/usr/local/shadow/logs/shadow_waf.log\"\r\n                }\r\n              },\r\n              {\r\n                \"range\": {\r\n                  \"@timestamp\": {\r\n                    \"gte\": _this.fromTime,\r\n                    \"lte\": _this.endTime\r\n                  }\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"aggs\": {\r\n          \"ip\": {\r\n            \"terms\": {\r\n              \"field\": \"shadow.waf.clientip\",\r\n              \"size\": 5\r\n            },\r\n              \"aggs\": {\r\n                \"time_histo\": {                  \r\n                  \"date_histogram\": {\r\n                    \"field\": \"@timestamp\",\r\n                    \"interval\": _this.timeinterval,\r\n                    \"extended_bounds\": {\r\n                      \"min\": _this.fromTime,\r\n                      \"max\": _this.endTime\r\n                    }\r\n                  }\r\n                }        \r\n            }\r\n          }\r\n        }\r\n      }\r\n      }).then((res)=>{\r\n        // console.log(res);\r\n        var tarResult=res.aggregations?res.aggregations.ip.buckets:[];\r\n        var legendData=[],\r\n            seriesData=[];\r\n        if(tarResult.length==0){\r\n          options.xAxis.show=false;\r\n          options.yAxis.show=false;\r\n          options.toolbox.show=false;\r\n          _this.orgIpLineNodata=true;\r\n        }else{\r\n          options.xAxis.show=true;\r\n          options.yAxis.show=true;\r\n          options.toolbox.show=true;\r\n          _this.orgIpLineNodata=false;\r\n        }\r\n        for(var i=0;i<tarResult.length;i++){\r\n          var xaxisData=[],valData=[];\r\n          var dataI=tarResult[i];\r\n          legendData.push(dataI.key);\r\n          for(var j=0;j<dataI.time_histo.buckets.length;j++){\r\n            var dataJ=dataI.time_histo.buckets[j];\r\n            var dataJV=dataJ.doc_count;\r\n            if(!dataJV){\r\n              dataJV=0\r\n            }\r\n            xaxisData.push(_this.transformMyDate2(dataJ.key));\r\n            valData.push(dataJV);\r\n          }\r\n          seriesData.push(\r\n            {\r\n              name:dataI.key,\r\n              type:'line',\r\n              data:valData\r\n            }\r\n          );\r\n        }\r\n\r\n        // if(hasline.attackiptopline){\r\n        //     seriesData=seriesData.map((item)=>{\r\n        //       item.markLine= {\r\n        //             symbol:\"none\",\r\n        //             silent: true,\r\n        //             lineStyle:{\r\n        //                 type:'dashed',\r\n        //                 color:'#893448'\r\n        //             },\r\n        //             data: [{\r\n        //                 yAxis: _this.ipConditionData\r\n        //             }]\r\n        //         }\r\n        //       return item;\r\n        //     })\r\n        //   }\r\n\r\n        options.legend.data=legendData;\r\n        options.xAxis.data=xaxisData;\r\n        options.series=seriesData;\r\n        _this.orgIpLineChart.setOption(options,true);\r\n        _this.orgIpLineLoading=false;\r\n\r\n        //brush 操作\r\n        _this.orgIpLineChart.on('brushSelected', function (params) {\r\n          // console.log(params)\r\n          if(brushFalg){\r\n            if(params.batch && params.batch[0].areas[0]){\r\n              // console.log(params.batch[0])\r\n              var startIndex=params.batch[0].areas[0].coordRange[0]=='-0'||params.batch[0].areas[0].coordRange[0]<0?0:params.batch[0].areas[0].coordRange[0];\r\n              var endIndex=params.batch[0].areas[0].coordRange[1];\r\n              var tstart=xaxisData[startIndex],tend=xaxisData[endIndex]?xaxisData[endIndex]:xaxisData[endIndex-1];\r\n\r\n              if(tstart==tend){ //采样频率稍大时（为'5m'时很容易出现这个问题）,如果用户选定的范围只在一个采样点内（只拉动一个阴影格），会导致起始查询时间和截止查询时间一致，这时在这个时间点上可能没有数据（但看起来应该有数据，采样频率导致的），因此遇到这种情况就把起始时间的范围以及截止时间的范围都各自扩大一个采样点，这样保证了用户只选取一个阴影格的时候也会有数据。\r\n                // console.log(tstart,tend,'相等');\r\n                var adTstart=new Date(tstart).getTime(),adTend=new Date(tend).getTime();\r\n                if(_this.$store.state.mydatedata.interval=='5m'){//此时interval=='1d' 或者 '1h'的可能性很小，因此没写了\r\n                  adTstart-=5*60*1000;\r\n                  adTend+=5*60*1000;\r\n                }else if(_this.$store.state.mydatedata.interval=='10s'){\r\n                  adTstart-=10*1000;\r\n                  adTend+=10*1000;\r\n                }else if(_this.$store.state.mydatedata.interval=='1s'){ //interval=='1s' 采样频率精确到1s，在往下拉也会一直有数据，因此也没写了\r\n                  // adTstart-=1*1000\r\n                  // adTend+=1*1000\r\n                }\r\n                tstart = _this.transformMyDate(adTstart);\r\n                tend = _this.transformMyDate(adTend);\r\n              }\r\n              // console.log(tstart,tend);\r\n\r\n              _this.$store.state.nowTimeVal=[new Date(tstart),new Date(tend)];//改变右上角时间（跟拉到的时间保持一致）\r\n              clearTimeout(_this.$store.state.refreshTimeout)//图表轮询定时器 清除按时刷新数据的定时器\r\n              _this.$store.state.refreshAble=true;//禁用自动刷新\r\n              setTimeout(()=>{\r\n                _this.$store.commit(types.MYDATEPICKER);\r\n              },0)\r\n            }\r\n          }\r\n        });\r\n      });\r\n    },\r\n    drawOrgIpPie(){\r\n      var _this=this;\r\n      _this.orgIpPieLoading=true;\r\n      _this.orgIpPieChart = echarts.init(document.getElementById('orgIpPieContainer'));\r\n      var options = {\r\n            color:['#516b91','#59c4e6','#edafda','#93b7e3','#a5e7f0','#4ea397','#22c3aa','#7bd9a5','#d0648a','#f58db2'],\r\n            title : {\r\n              text: _this.$t('lg.numattacksopcountstop10'),\r\n              x:'center',\r\n              textStyle: {\r\n                fontSize: '16',\r\n                fontWeight: 'normal'\r\n              }\r\n            },\r\n            tooltip: {\r\n              trigger: 'item',\r\n              formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n            },\r\n            // legend: {\r\n            //   orient: 'horizontal',\r\n            //   bottom:'0px',\r\n            //   data:[]\r\n            // },\r\n            series: [\r\n              {\r\n                name:_this.$t('lg.accesssource'),\r\n                type:'pie',\r\n                radius:['25%','35%'],\r\n                // radius: '40%',\r\n                // center: ['50%', '50%'],\r\n                data:[\r\n                  // {value:335, name:'直接访问'},\r\n                  // {value:310, name:'邮件营销'},\r\n                ].sort(function (a, b) { return a.value - b.value; }),\r\n                // roseType: 'radius',//area radius\r\n                label: {\r\n                  position:'outside',\r\n                  normal: {\r\n                    textStyle: {\r\n                      fontSize: '12',  \r\n                    },\r\n                    formatter: \"{b}: {c}\"\r\n                  },\r\n                  emphasis: {\r\n                    show: true,\r\n                    textStyle: {\r\n                      fontSize: '14',\r\n                      fontWeight: 'normal',\r\n                    },\r\n                  }\r\n                },\r\n                labelLine: {\r\n                  normal: {\r\n                    smooth: 0,\r\n                    length: 10,\r\n                    length2: 20,\r\n                  },\r\n                },\r\n                animationType: 'scale',\r\n                animationEasing: 'elasticOut',\r\n                animationDelay: function (idx) {\r\n                  return Math.random() * 200;\r\n                }\r\n              }\r\n            ]\r\n          };\r\n      function getOrgIpPieData(){// 绘制图表\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body: {\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": [\r\n                  {\r\n                    \"term\": {\r\n                      \"log.file.path\": \"/usr/local/shadow/logs/shadow_waf.log\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"range\": {\r\n                      \"@timestamp\": {\r\n                        \"gte\": _this.fromTime,\r\n                        \"lte\": _this.endTime\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"ip\": {\r\n                \"terms\": {\r\n                  \"field\": \"shadow.waf.clientip\",\r\n                  \"size\": 10\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }).then((res)=>{\r\n          // console.log(res);\r\n          var tarResult=res.aggregations?res.aggregations.ip.buckets:[];\r\n          var result=[],legendRlt=[];\r\n          for(var i=0;i<tarResult.length;i++){\r\n            var dataI=tarResult[i];\r\n            result.push(\r\n              {\r\n                value:dataI[\"doc_count\"],\r\n                name:dataI[\"key\"]\r\n              }\r\n            );\r\n            legendRlt.push(dataI[\"key\"])\r\n          }\r\n          options.series[0].data=result;\r\n          // options.legend.data=legendRlt;\r\n          if(result.length==0){\r\n            _this.orgIpPieNodata=true;\r\n          }else{\r\n            _this.orgIpPieNodata=false;\r\n          }\r\n          _this.orgIpPieChart.setOption(options,true);\r\n          _this.orgIpPieLoading=false;\r\n\r\n          _this.orgIpPieChart.off(\"click\");\r\n          _this.orgIpPieChart.on(\"click\",(params)=>{\r\n            // console.log(params);\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n            _this.popQueryObj.bool.must.push({\r\n              \"query_string\": {\r\n                \"query\":\"shadow.waf.clientip:\"+'\\\"'+_this.logDialogTitle+'\\\"'\r\n              }\r\n            });\r\n            _this.getOnepieceFromPie();\r\n          });\r\n        });\r\n      }\r\n      getOrgIpPieData();\r\n    },\r\n    drawDomainLine(){\r\n      var _this=this;\r\n      _this.domainLineLoading=true;\r\n      var domainDom=document.getElementById('domainLineContainer');\r\n      _this.domainLineChart = echarts.init(domainDom);\r\n\r\n      _this.domainLineChart.off('brushSelected');//一定要清除brush事件\r\n      var brushFalg = false;//设置一个阀值，鼠标弹起时才触发\r\n      domainDom.addEventListener(\"mousedown\", () => {\r\n        brushFalg=false;\r\n      });\r\n      domainDom.addEventListener(\"mouseup\", () => {\r\n        brushFalg=true;\r\n      });\r\n\r\n      var options = {\r\n          color:['#c1232b','#27727b','#fcce10','#e87c25','#b5c334'],\r\n          title: {\r\n            text: _this.$t('lg.numattackdomaintop5'),\r\n            textStyle: {\r\n              fontSize: '16',\r\n              fontWeight: 'normal'\r\n            }\r\n          },\r\n          tooltip: {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n              type: 'shadow',\r\n              label: {\r\n                show: true\r\n              }\r\n            }\r\n          },\r\n          legend: {\r\n            top:'20px',\r\n            data:[],\r\n          },\r\n          grid: {\r\n            left: '5%',\r\n            right: '3%',\r\n            bottom:'4%',\r\n            top:'25%',\r\n            containLabel: true\r\n          },\r\n          brush: {\r\n            toolbox: ['lineX'],\r\n            xAxisIndex: \"all\",\r\n            transformable:false,\r\n            throttleType:'debounce',\r\n            throttleDelay: 1000,\r\n            brushStyle:{\r\n              borderWidth: 0,\r\n            }\r\n          },\r\n          toolbox: {\r\n            show:false,\r\n            right:'10',\r\n            top:'10',\r\n          },\r\n          xAxis: {\r\n            show:true,\r\n            type: 'category',\r\n            data: [],\r\n          },\r\n          yAxis: {\r\n            show:false,\r\n            type: 'value',\r\n            name:_this.$t('lg.counts'),\r\n            minInterval: 1//保持y轴刻度只为整数\r\n          },\r\n          series: [\r\n            // {\r\n            //     name:'Step Start',\r\n            //     type:'line',\r\n            //     step: 'start',\r\n            //     data:[120, 132, 101, 134, 90, 230, 210]\r\n            // },\r\n            // {\r\n            //     name:'Step Middle',\r\n            //     type:'line',\r\n            //     step: 'middle',\r\n            //     data:[220, 282, 201, 234, 290, 430, 410]\r\n            // },\r\n          ]\r\n      };\r\n      client.search({\r\n      index: \"shadow-filebeat-*\",\r\n        body:  {\r\n        \"size\": 0,\r\n        \"query\": {\r\n          \"bool\": {\r\n            \"filter\": _this.filterObj,\r\n            \"must\": [\r\n              {\r\n                \"term\": {\r\n                  \"log.file.path\": \"/usr/local/shadow/logs/shadow_waf.log\"\r\n                }\r\n              },\r\n              {\r\n                \"range\": {\r\n                  \"@timestamp\": {\r\n                    \"gte\": _this.fromTime,\r\n                    \"lte\": _this.endTime\r\n                  }\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"aggs\": {\r\n          \"host\": {\r\n            \"terms\": {\r\n              \"field\": \"shadow.waf.host\",\r\n              \"size\": 5\r\n            },\r\n              \"aggs\": {\r\n                \"time_histo\": {                  \r\n                  \"date_histogram\": {\r\n                    \"field\": \"@timestamp\",\r\n                    \"interval\": _this.timeinterval,\r\n                    \"extended_bounds\": {\r\n                      \"min\": _this.fromTime,\r\n                      \"max\": _this.endTime\r\n                    }\r\n                  }\r\n                }        \r\n            }\r\n          }\r\n        }\r\n      }\r\n      }).then((res)=>{\r\n        // console.log(res)\r\n        var tarResult=res.aggregations?res.aggregations.host.buckets:[];\r\n        var legendData=[],seriesData=[];\r\n        if(tarResult.length==0){\r\n          options.xAxis.show=false;\r\n          options.yAxis.show=false;\r\n          options.toolbox.show=false;\r\n          _this.domainLineNodata=true;\r\n        }else{\r\n          options.xAxis.show=true;\r\n          options.yAxis.show=true;\r\n          options.toolbox.show=true;\r\n          _this.domainLineNodata=false;\r\n        }\r\n        for(var i=0;i<tarResult.length;i++){\r\n          var xaxisData=[],valData=[];\r\n          var dataI=tarResult[i];\r\n          legendData.push(dataI.key);\r\n          for(var j=0;j<dataI.time_histo.buckets.length;j++){\r\n            var dataJ=dataI.time_histo.buckets[j];\r\n            var dataJV=dataJ.doc_count;\r\n            if(!dataJV){\r\n              dataJV=0\r\n            }\r\n            xaxisData.push(_this.transformMyDate2(dataJ.key));\r\n            valData.push(dataJV);\r\n          }\r\n          seriesData.push(\r\n            {\r\n              name:dataI.key,\r\n              type:'line',\r\n              data:valData\r\n            }\r\n          );\r\n        }\r\n\r\n        // if(hasline.attackdomaintopline){\r\n        //     seriesData=seriesData.map((item)=>{\r\n        //       item.markLine= {\r\n        //             symbol:\"none\",\r\n        //             silent: true,\r\n        //             lineStyle:{\r\n        //                 type:'dashed',\r\n        //                 color:'#893448'\r\n        //             },\r\n        //             data: [{\r\n        //                 yAxis: _this.domainConditionData\r\n        //             }]\r\n        //         }\r\n        //       return item;\r\n        //     })\r\n        //   }\r\n\r\n        options.legend.data=legendData;\r\n        options.xAxis.data=xaxisData;\r\n        options.series=seriesData;\r\n        _this.domainLineChart.setOption(options,true);\r\n        _this.domainLineLoading=false;\r\n\r\n        //brush 操作\r\n        _this.domainLineChart.on('brushSelected', function (params) {\r\n          // console.log(params)\r\n          if(brushFalg){\r\n            if(params.batch && params.batch[0].areas[0]){\r\n              // console.log(params.batch[0])\r\n              var startIndex=params.batch[0].areas[0].coordRange[0]=='-0'||params.batch[0].areas[0].coordRange[0]<0?0:params.batch[0].areas[0].coordRange[0];\r\n              var endIndex=params.batch[0].areas[0].coordRange[1];\r\n              var tstart=xaxisData[startIndex],tend=xaxisData[endIndex]?xaxisData[endIndex]:xaxisData[endIndex-1];\r\n\r\n              if(tstart==tend){ //采样频率稍大时（为'5m'时很容易出现这个问题）,如果用户选定的范围只在一个采样点内（只拉动一个阴影格），会导致起始查询时间和截止查询时间一致，这时在这个时间点上可能没有数据（但看起来应该有数据，采样频率导致的），因此遇到这种情况就把起始时间的范围以及截止时间的范围都各自扩大一个采样点，这样保证了用户只选取一个阴影格的时候也会有数据。\r\n                // console.log(tstart,tend,'相等');\r\n                var adTstart=new Date(tstart).getTime(),adTend=new Date(tend).getTime();\r\n                if(_this.$store.state.mydatedata.interval=='5m'){//此时interval=='1d' 或者 '1h'的可能性很小，因此没写了\r\n                  adTstart-=5*60*1000;\r\n                  adTend+=5*60*1000;\r\n                }else if(_this.$store.state.mydatedata.interval=='10s'){\r\n                  adTstart-=10*1000;\r\n                  adTend+=10*1000;\r\n                }else if(_this.$store.state.mydatedata.interval=='1s'){ //interval=='1s' 采样频率精确到1s，在往下拉也会一直有数据，因此也没写了\r\n                  // adTstart-=1*1000\r\n                  // adTend+=1*1000\r\n                }\r\n                tstart = _this.transformMyDate(adTstart);\r\n                tend = _this.transformMyDate(adTend);\r\n              }\r\n              // console.log(tstart,tend);\r\n\r\n              _this.$store.state.nowTimeVal=[new Date(tstart),new Date(tend)];//改变右上角时间（跟拉到的时间保持一致）\r\n              clearTimeout(_this.$store.state.refreshTimeout)//图表轮询定时器 清除按时刷新数据的定时器\r\n              _this.$store.state.refreshAble=true;//禁用自动刷新\r\n              setTimeout(()=>{\r\n                _this.$store.commit(types.MYDATEPICKER);\r\n              },0)\r\n            }\r\n          }\r\n        });\r\n      });\r\n    },\r\n    drawDomainPie(){\r\n      var _this=this;\r\n      _this.domainPieLoading=true;\r\n      _this.domainPieChart = echarts.init(document.getElementById('domainPieContainer'));\r\n      var options = {\r\n            color:['#27727b','#fcce10','#e87c25','#b5c334','#60c0dd','#d7504b','#c6e579','#f0805a','#26c0c0','#c1232b'],\r\n            title : {\r\n              text: _this.$t('lg.attackdomaintop10'),\r\n              // subtext: 'TOP10',\r\n              // top:'20px',\r\n              x:'center',\r\n              textStyle: {\r\n                fontSize: '16',\r\n                fontWeight: 'normal'\r\n              }\r\n            },\r\n            tooltip: {\r\n              trigger: 'item',\r\n              formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n            },\r\n            // legend: {\r\n            //   orient: 'horizontal',\r\n            //   bottom:'0px',\r\n            //   data:[]\r\n            // },\r\n            series: [\r\n              {\r\n                name:_this.$t('lg.accesssource'),\r\n                type:'pie',\r\n                radius:['25%','35%'],\r\n                // radius: '40%',\r\n                // center: ['50%', '50%'],\r\n                data:[].sort(function (a, b) { return a.value - b.value; }),\r\n                // roseType: 'radius',//area radius\r\n                label: {\r\n                  position:'outside',\r\n                  normal: {\r\n                    textStyle: {\r\n                      fontSize: '12',  \r\n                    },\r\n                    formatter: \"{b}: {c}\"\r\n                  },\r\n                  emphasis: {\r\n                    show: true,\r\n                    textStyle: {\r\n                      fontSize: '14',\r\n                      fontWeight: 'normal'\r\n                    }\r\n                  }\r\n                },\r\n                labelLine: {\r\n                  normal: {\r\n                    smooth: 0,\r\n                    length: 10,\r\n                    length2: 20,\r\n                  },\r\n                },\r\n                animationType: 'scale',\r\n                animationEasing: 'elasticOut',\r\n                animationDelay: function (idx) {\r\n                  return Math.random() * 200;\r\n                }\r\n              }\r\n            ]\r\n          };\r\n      function getDomainPieData(flag){\r\n        client.search({\r\n          index: \"shadow-filebeat-*\",\r\n          body: {\r\n            \"size\": 0,\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"filter\": _this.filterObj,\r\n                \"must\": [\r\n                  {\r\n                    \"term\": {\r\n                      \"log.file.path\": \"/usr/local/shadow/logs/shadow_waf.log\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"range\": {\r\n                      \"@timestamp\": {\r\n                        \"gte\": _this.fromTime,\r\n                        \"lte\": _this.endTime\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            },\r\n            \"aggs\": {\r\n              \"host\": {\r\n                \"terms\": {\r\n                  \"field\": \"shadow.waf.host\",\r\n                  \"size\": 10\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }).then((res)=>{\r\n          // console.log(res);\r\n          var tarResult=res.aggregations?res.aggregations.host.buckets:[];\r\n          var result=[],legendRlt=[];\r\n          for(var i=0;i<tarResult.length;i++){\r\n            var dataI=tarResult[i];\r\n            result.push(\r\n              {\r\n                value:dataI[\"doc_count\"],\r\n                name:dataI[\"key\"]\r\n              }\r\n            );\r\n            legendRlt.push(dataI[\"key\"])\r\n          }\r\n          options.series[0].data=result;\r\n          // options.legend.data=legendRlt;\r\n          if(result.length==0){\r\n            _this.domainPieNodata=true;\r\n          }else{\r\n            _this.domainPieNodata=false;\r\n          }\r\n          _this.domainPieChart.setOption(options,true);\r\n          _this.domainPieLoading=false;\r\n\r\n          _this.domainPieChart.off(\"click\");\r\n          _this.domainPieChart.on(\"click\",(params)=>{\r\n            // console.log(params);\r\n            _this.logDialogVisible=true;\r\n            _this.logDialogTitle=params.name;\r\n            _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n            _this.popQueryObj.bool.must.push({\r\n                  \"query_string\": {\r\n                      \"query\":\"shadow.waf.host:\"+_this.logDialogTitle.replace(/:/g,'\\\\:')\r\n                    }\r\n              });\r\n            _this.getOnepieceFromPie();\r\n          });\r\n        });\r\n      }\r\n      getDomainPieData();\r\n    },\r\n    drawRegionBar(){\r\n      var _this=this;\r\n      _this.regionBarLoading=true;\r\n      _this.regionBarChart = echarts.init(document.getElementById('regionBarContainer'));\r\n\r\n      //设置‘基于错误码统计的恶意攻击次数/Top10’图的显示文字\r\n      var labelOption = {\r\n            normal: {\r\n              show: true,\r\n              rotate: 0,\r\n              align: 'left',\r\n              verticalAlign: 'middle',\r\n              position: 'insideLeft',\r\n              distance: 10,\r\n              // color:'#000',\r\n              formatter:function(params){\r\n                // console.log(params)\r\n                const str = params.data.name;               \r\n                return str;\r\n              },\r\n              fontSize: 12,\r\n            }\r\n          };\r\n      var option = {\r\n            color:['#d95850'],\r\n            title: {\r\n              text: '地域信息/Top10',\r\n              x:'center',\r\n              textStyle: {\r\n                fontSize: '16',\r\n                fontWeight: 'normal'\r\n              }\r\n            },\r\n            tooltip: {\r\n              show:false,\r\n              trigger: 'axis',\r\n              confine:true,\r\n              axisPointer: {\r\n                type: 'shadow'\r\n              },\r\n              extraCssText:'white-space:normal;word-break: break-all',\r\n              formatter:function(params, ticket, callback){\r\n                var str = '';\r\n                params.forEach(item=>{\r\n                  str = item.data.name+'发起恶意攻击的次数为:'+item.data.value+_this.$t('lg.count')\r\n                })\r\n                return str;\r\n              }\r\n            },\r\n            // legend: {\r\n            //   data: [],\r\n            //   top:'30px',\r\n            // },\r\n            grid: {\r\n              top:'12%',\r\n              left: '0',\r\n              right: '50',\r\n              bottom: '2%',\r\n              containLabel: true\r\n            },\r\n            xAxis: {\r\n              show:false,\r\n              type: 'value',\r\n              name:_this.$t('lg.counts'),\r\n              boundaryGap: [0,0.01],\r\n              position:'top',\r\n              splitLine:{\r\n                show:false\r\n              },\r\n              minInterval: 1//保持x轴刻度只为整数\r\n            },\r\n            yAxis: { \r\n              show:false,\r\n              type: 'category',\r\n              data: [],//['top5','top4','top3','top2','top1']\r\n              inverse: true,//是否是反向坐标轴 （这里反向后数据降序排列）\r\n            },\r\n            series: []\r\n          };\r\n          function getRegionData(){\r\n            client.search({\r\n              index: \"shadow-filebeat-*\",\r\n              body: {\r\n                \"size\": 0,\r\n                \"query\": {\r\n                  \"bool\": {\r\n                    \"filter\": _this.filterObj,\r\n                    \"must\": [\r\n                      {\r\n                      \"term\": {\r\n                        \"log.file.path\": \"/usr/local/shadow/logs/shadow_waf.log\"\r\n                      }\r\n                    }, {\r\n                      \"range\": {\r\n                        \"@timestamp\": {\r\n                          \"gte\": _this.fromTime,\r\n                          \"lte\": _this.endTime,\r\n                        }\r\n                      }\r\n                    }]\r\n                  }\r\n                },\r\n                \"aggs\": {\r\n                  \"GroupByGeo\": {\r\n                    \"terms\": {\r\n                      \"script\": {\r\n                        \"inline\": 'params._source.shadow.waf.geoip',\r\n                        \"lang\": \"painless\"\r\n                      },\r\n                      \"size\": 10\r\n                    },\r\n                    \"aggs\": {\r\n                      \"total_count\": {\r\n                        \"scripted_metric\": {\r\n                          \"init_script\": \"params._agg.count = []\",\r\n                          \"map_script\": \"Map cnt = new HashMap();cnt.put('loc',params['_source']['shadow']['access']['geoip']);params._agg.count.add(cnt)\",\r\n                          \"combine_script\": \"return params._agg.count.get(0)\",\r\n                          \"reduce_script\": \"return params._aggs.get(0)\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }).then((res)=>{\r\n              // console.log(res);\r\n              var resResult=res.aggregations?res.aggregations.GroupByGeo.buckets:[];\r\n\r\n              let topArrays=[]              //存 ['top5','top4','top3','top2','top1']\r\n              let topArray=resResult.length;               //取前面10位  top10\r\n              for(var i=0;i<topArray;i++){   //遍历出top 数组\r\n                topArrays.push(`top${i+1}`);\r\n              } \r\n              option.yAxis.data=topArrays;\r\n\r\n              var sdata=[];\r\n              for(var i=0; i<topArrays.length;i++){\r\n                if(resResult[i]){\r\n                  const cityName = resResult[i].total_count.value.loc.city_name?resResult[i].total_count.value.loc.city_name:'['+resResult[i].total_count.value.loc.location.lon+','+resResult[i].total_count.value.loc.location.lat+']';\r\n                  sdata.push({\r\n                    value:resResult[i].doc_count,\r\n                    name:cityName,\r\n                  });\r\n                }\r\n              }\r\n              option.series=[{          \r\n                type: 'bar',\r\n                label: labelOption,\r\n                data:sdata,\r\n                barMaxWidth:30,\r\n              }]\r\n              // console.log(option.series)\r\n              if(resResult.length==0){\r\n                option.xAxis.show=false;\r\n                option.yAxis.show=false;\r\n                option.tooltip.show=false;\r\n                _this.regionBarNodata=true;\r\n              }else{\r\n                option.xAxis.show=true;\r\n                option.yAxis.show=true;\r\n                option.tooltip.show=true;\r\n                _this.regionBarNodata=false;\r\n              }\r\n              _this.regionBarChart.setOption(option,true);\r\n              _this.regionBarLoading=false;\r\n\r\n              _this.regionBarChart.off(\"click\");\r\n              _this.regionBarChart.on(\"click\",(params)=>{\r\n                // console.log(params)\r\n                _this.logDialogVisible=true;\r\n                _this.logDialogTitle=params.name;\r\n                _this.popQueryObj.bool.filter=_this.filterObj;//把查询面板的域名等过滤条件带入日志查询\r\n                \r\n                // console.log(_this.logDialogTitle)\r\n                if(/^\\[.+\\]$/.test(params.name)){//没有city_name 就用经纬度查\r\n                  var locationArr = JSON.parse(params.name)\r\n                  var lonNum = locationArr[0],latNum = locationArr[1];\r\n                  var mapScriptStr = \"shadow.waf.geoip.location\";\r\n\r\n                  var filterGeo ={};\r\n                  filterGeo.distance=\"1mm\";\r\n                  filterGeo[mapScriptStr]={\r\n                    \"lat\" : latNum,\r\n                    \"lon\" : lonNum\r\n                  }\r\n\r\n                  if(!_this.popQueryObj.bool.filter.bool){//如果没有查询面板的过滤条件\r\n                    _this.popQueryObj.bool.filter={\"bool\":{\"must\":[]}}\r\n                    _this.popQueryObj.bool.filter.bool.must.push({\r\n                      \"geo_distance\" : filterGeo\r\n                    });\r\n                  }else{\r\n                    _this.popQueryObj.bool.filter.bool.must.push({\r\n                      \"geo_distance\" : filterGeo\r\n                    });\r\n                  }\r\n                }else{\r\n                  _this.popQueryObj.bool.must.push({//有city_name 就用city_name查\r\n                  \"query_string\": {\r\n                      \"query\":\"shadow.waf.geoip.city_name:\"+_this.logDialogTitle.replace(/:/g,'\\\\:')\r\n                    }\r\n                  });\r\n                }\r\n\r\n                _this.getOnepieceFromPie();\r\n              });\r\n            });\r\n          }\r\n      getRegionData();\r\n    },\r\n\r\n    fullScreen(){//大屏展示\r\n      var chartGridDom = document.getElementsByClassName('attackChart-wrapper');\r\n      chartGridDom[0].requestFullscreen();\r\n\r\n      window.addEventListener(\"fullscreenchange\", (e) => {\r\n        if (document.fullscreenElement) {\r\n          // console.log('进入全屏')\r\n          this.isShowQueryPanel = false;\r\n          this.isShowGridMenu = false;\r\n        } else {\r\n          // console.log('退出全屏')\r\n          this.isShowQueryPanel = true;\r\n          this.isShowGridMenu = true;\r\n        }\r\n      })\r\n    },\r\n    downLoadPdf(){//导出数据图为pdf文件\r\n      var _this=this;\r\n      if(this.attackSumNum!=0){\r\n        let myChart1Str;\r\n        if(this.forFastShow){\r\n         myChart1Str = this.businessLineChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");         \r\n        }\r\n        const myChart2Str = this.urlAtckCtBarChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart3Str = this.attackTypeChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart4Str = this.orgIpLineChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart5Str = this.orgIpPieChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart6Str = this.domainLineChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart7Str = this.domainPieChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        const myChart8Str = this.regionBarChart.getDataURL({\r\n          type:'jpeg',\r\n          pixelRatio: 2,\r\n          backgroundColor: '#fff',\r\n        }).replace(\"data:image/jpeg;base64,\",\"\");\r\n        \r\n        let myCharArray;\r\n        if(myChart1Str){\r\n          myCharArray = [myChart1Str,myChart2Str,myChart3Str,myChart4Str,myChart5Str,myChart6Str,myChart7Str,myChart8Str]; \r\n        }else{\r\n          myCharArray = [myChart2Str,myChart3Str,myChart4Str,myChart5Str,myChart6Str,myChart7Str,myChart8Str]; \r\n        }\r\n        const url = SERVER_API_URL + 'pe/download/conversion/jpg2pdf';\r\n        axios.post(url,{\r\n          base64StringList:myCharArray\r\n        },{\r\n          responseType:'blob'\r\n        }).then((res)=>{\r\n          //  console.log(res)\r\n          if(res.status==200){\r\n            var filename = _this.$t('lg.attackdatachart')+'.pdf';\r\n            this.$store.commit(types.MAKEPDF,{'pdfdata':res.data,'pdfname':filename});\r\n          }\r\n        }).catch((err)=>{\r\n          console.log(err);\r\n        });\r\n      }else{\r\n        this.$message.error(_this.$t('lg.nodata'));\r\n      }\r\n    },\r\n    goBackMap(){//返回地图\r\n      this.$router.push('/attack')\r\n    },\r\n\r\n    //日志弹框\r\n    getChangeLogData(pageObj){   //改变分页返回数据\r\n      this.fromPage = pageObj.curPage-1;\r\n      this.pageSize= pageObj.pageNum;\r\n      this.requeryObj?this.getOnepieceFromPie(this.requeryObj):this.getOnepieceFromPie();\r\n    },\r\n    getOnepieceFromPie(requeryObj){\r\n      var _this=this;\r\n\r\n      let clientQueryObj = JSON.parse(JSON.stringify(_this.popQueryObj));//清空（清空方法本身加的查询条件，但同时保存了外部查询条件）\r\n      clientQueryObj.bool.must.push(\r\n        {\r\n          \"range\": {\r\n            \"@timestamp\": {\r\n              \"gte\": _this.fromTime,\r\n              \"lte\": _this.endTime\r\n            }\r\n          }\r\n        }\r\n      );\r\n      if(requeryObj){//双重过滤（顶部查询面板以及日志弹框里面的requery子组件查询。要把这两者的查询语句融汇在一起）\r\n        // console.log(requeryObj);\r\n        const requeryArr = requeryObj.bool.must;\r\n        // _this.popQueryObj.bool.filter={..._this.popQueryObj.bool.filter,...requeryObj}\r\n\r\n        if(clientQueryObj.bool.filter.bool){\r\n          requeryArr.forEach((item)=>{\r\n            clientQueryObj.bool.filter.bool.must.push(item);\r\n          })\r\n        }else{\r\n          clientQueryObj.bool.filter={\"bool\":{\"must\":[]}}\r\n          requeryArr.forEach((item)=>{\r\n            clientQueryObj.bool.filter.bool.must.push(item);\r\n          })\r\n        }\r\n      }\r\n      // console.log(clientQueryObj)\r\n      client.search({\r\n        index:\"shadow-filebeat*\",\r\n        body:{\r\n          \"from\":_this.fromPage*_this.pageSize,\r\n          \"size\": _this.pageSize,\r\n          \"sort\": {\r\n            \"@timestamp\": \"desc\"\r\n          },\r\n          \"query\": clientQueryObj\r\n        }\r\n      }).then((res2)=>{\r\n        _this.chartLogsTotalNum=res2.hits.total.value;\r\n        let logResArr = res2.hits.hits;\r\n\r\n        // 获取waf.log表体数据\r\n        _this.chartLogsBodyData = handleWaflogData(logResArr);\r\n      })\r\n    },\r\n    requeryRowByWaf(obj){ //用户通过requery孙组件筛选waf.log显示的行\r\n      this.requeryObj=obj.requeryObj;\r\n      this.fromPage=0;\r\n      this.getOnepieceFromPie(this.requeryObj);\r\n      if(this.$refs.log_tables) this.$refs.log_tables.tabCurPage=1;//当用户点击查询后，查询结果的页码要回到第一页\r\n    },\r\n    refilterColByWaf(obj){ //用户通过refilter孙组件筛选waf.log显示的列，删除或者增加字段显示的时候变化头部，发送用户增删请求\r\n      var url = SERVER_API_URL + '/pe/shadow/kv';\r\n      axios.post(url,{attackChartWaf:obj}).then(res=>{\r\n        if(Object.keys(res.data.data.Failure)){\r\n          axios.patch(url,{attackChartWaf:obj}).then(res=>{\r\n          })\r\n        }\r\n      })\r\n      this.chartLogsHeadData = obj;\r\n    },\r\n    logDialogClose(){\r\n      this.logDialogVisible=false;\r\n      this.logDialogTitle='';\r\n      this.fromPage=0;\r\n      this.chartLogsTotalNum=0;\r\n      this.popQueryObj={\"bool\":{\"must\":[{\"term\":{\"log.file.path\":\"/usr/local/shadow/logs/shadow_waf.log\"}}]}};\r\n      this.broadcast('logRequery',\"clearData\");//清空孙组件里logRequry的查询条件输入框里的内容，要引入Emitter\r\n      this.requeryObj=null;//清空孙组件里logRequry的被带入日志查询语句的查询条件\r\n    },\r\n\r\n    //数据加工函数\r\n    transformMyDate(d){\r\n      d=new Date(d);\r\n      function pad(n){\r\n        return n<10 ? '0'+n : n\r\n      }\r\n      return pad(d.getFullYear())+\"-\"+pad(parseInt(d.getMonth())+1)+\"-\"+pad(d.getDate())+\" \"+pad(d.getHours())+':' + pad(d.getMinutes())+':' + pad(d.getSeconds());\r\n    },\r\n    transformMyDate2(d){\r\n      d=new Date(d-8*60*60*1000);\r\n      function pad(n){\r\n        return n<10 ? '0'+n : n\r\n      }\r\n      return pad(d.getFullYear())+\"-\"+pad(parseInt(d.getMonth())+1)+\"-\"+pad(d.getDate())+\" \"+pad(d.getHours())+':' + pad(d.getMinutes())+':' + pad(d.getSeconds());\r\n    },\r\n\r\n  },\r\n  beforeDestroy(){\r\n    window.removeEventListener('resize',function(){});\r\n  }\r\n}\r\n</script>\r\n<style>\r\n.fastloadmore{text-align:center; background-color:#f5f5f5; padding:10px; cursor:pointer}\r\n.attackChart-wrapper{\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  padding: 15px;\r\n  box-sizing: border-box;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.attackChartContent{\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n  padding-right: 10px;\r\n}\r\n\r\n/*图表*/\r\n.chartRow{\r\n  margin-bottom: 10px;\r\n}\r\n.chartRowBusi{\r\n  margin-left: 0px!important;\r\n}\r\n\r\n#urlAtckCtContainer,#attackTypeContainer,#orgIpLineContainer,#domainLineContainer,#orgIpPieContainer,#domainPieContainer,#regionBarContainer{\r\n  width: 100%;\r\n  height: 310px;\r\n  padding: 10px;\r\n  box-sizing: border-box;\r\n}\r\n/*业务表 max min*/\r\n.busiChartBox{\r\n  padding: 10px;\r\n  box-sizing: border-box;\r\n  background: #f7f7f7;\r\n}\r\n#businessContainer{\r\n  width: 100%;\r\n  height: 290px;\r\n}\r\n.busiNumBox{\r\n  background: #fff;\r\n  height: 290px;\r\n  padding: 30px 10px !important;\r\n  box-sizing: border-box;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n.totalList{\r\n  margin-bottom: 20px;\r\n}\r\n.totalList li{\r\n  color: #27727b;\r\n  margin-bottom: 10px;\r\n  line-height: 15px;\r\n}\r\n.someList li{\r\n  color: #d95850;\r\n  margin-bottom: 10px;\r\n  line-height: 15px;\r\n}\r\n.totalList .listTitle,.someList .listTitle{\r\n  color: #606266;\r\n  margin-bottom: 15px;\r\n  padding-left: 0px;\r\n}\r\n.liLable{\r\n  font-size: 12px;\r\n  font-style:italic;\r\n  padding-left: 10px;\r\n}\r\n.liValue{\r\n  text-align: center;\r\n  font-size: 1.2vw;\r\n}\r\n/*次数显示&业务表*/\r\n.numBox{\r\n  width: 100%;\r\n  height: 310px;\r\n  padding: 10px;\r\n  box-sizing: border-box;\r\n  /* box-shadow: 2px 2px 5px #ccc; */\r\n}\r\n.numBoxTitle{\r\n  color: #333;\r\n  font-size: 16px;\r\n}\r\n.totalBox {\r\n  margin-top: 20px;\r\n  height: 80px;\r\n}\r\n.abnormalBox{\r\n  margin-top: 30px;\r\n  height: 100px;\r\n}\r\n.numTitle{\r\n  padding-left: 10px;\r\n  color: #606266; \r\n}\r\n.totalNum{\r\n  margin-left: 20%;\r\n  font-size: 2.5vw;\r\n  color: #516b91;\r\n  line-height: 60px;\r\n}\r\n.abnormalNum{\r\n  text-align: center;\r\n  font-size: 4vw;\r\n  color: #c1232b;\r\n  line-height: 90px;\r\n}\r\n.uTxt{\r\n  font-size: 14px;\r\n  color: #606266;\r\n}\r\n\r\n/*pei图暂无数据*/\r\n.adaptive-circle {\r\n  margin: 50px auto 0;\r\n  width: 22%;\r\n  height: 0;\r\n  padding-top: 22%;\r\n  border-radius: 100%;\r\n  box-sizing: border-box;\r\n  background:#fff;\r\n  position:absolute;\r\n  top:12%;\r\n  left:40%;\r\n}\r\n.adaptive-circle .layout {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  text-align: center;\r\n}\r\n.adaptive-circle .layout.middle:before {\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n  content: '';\r\n  height: 100%;\r\n  width: 0;\r\n  overflow: hidden;\r\n}\r\n.adaptive-circle .layout.middle div:first-child {\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n}\r\n\r\n/*导出数据图表*/\r\n/* .downBtn{\r\n  position: fixed;\r\n  bottom: 20px;\r\n  right: 50px;\r\n  padding: 5px;\r\n}\r\n.goBackBtn{\r\n  position: fixed;\r\n  bottom: 50px;\r\n  right: 50px;\r\n  padding: 5px;\r\n}\r\n.downBtn a,.goBackBtn a{\r\n  font-size: 15px;\r\n} */\r\n\r\n/* loading 主要针对‘自定义图表’的loading */\r\n.attackChart-wrapper .el-loading-spinner{\r\n  padding: 3px;\r\n  box-sizing: border-box;\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  text-align: right;\r\n  margin-top: 0;\r\n}\r\n.attackChart-wrapper .el-loading-spinner i{\r\n  color: #242222;\r\n  font-size: 18px;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/home/attackChart.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"attackChart-wrapper\"},[_c('query-panel',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowQueryPanel),expression:\"isShowQueryPanel\"}],on:{\"getAllQuerychart\":_vm.getAllchart,\"handleTime\":_vm.handleTime}}),_vm._v(\" \"),_c('div',{staticClass:\"attackChartContent\"},[_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":14}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.urlAtckCtLoading),expression:\"urlAtckCtLoading\"}],staticClass:\"chart-content\",staticStyle:{\"position\":\"relative\"},attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.urlAtckCtBarNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"urlAtckCtContainer\"}})],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":10}},[_c('div',{staticClass:\"chart-content numBox txtOverflow\"},[_c('p',{staticClass:\"text-center numBoxTitle\"},[_vm._v(_vm._s(_vm.$t('lg.totaldatav')))]),_vm._v(\" \"),_c('div',{staticClass:\"totalBox\"},[_c('p',{staticClass:\"numTitle\"},[_vm._v(_vm._s(_vm.$t('lg.totalrquestammount')))]),_vm._v(\" \"),_c('p',{staticClass:\"totalNum\"},[_vm._v(_vm._s(_vm.totalNum)),_c('span',{staticClass:\"uTxt\"},[_vm._v(_vm._s(_vm.$t('lg.count')))])])]),_vm._v(\" \"),_c('div',{staticClass:\"abnormalBox\"},[_c('p',{staticClass:\"numTitle\"},[_vm._v(_vm._s(_vm.$t('lg.totalattack')))]),_vm._v(\" \"),_c('p',{staticClass:\"abnormalNum\"},[_vm._v(_vm._s(_vm.attackSumNum)),_c('span',{staticClass:\"uTxt\"},[_vm._v(_vm._s(_vm.$t('lg.count')))])])])])])],1),_vm._v(\" \"),_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":16}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.orgIpLineLoading),expression:\"orgIpLineLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.orgIpLineNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"orgIpLineContainer\"}})],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":8}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.orgIpPieLoading),expression:\"orgIpPieLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.orgIpPieNodata)?_c('div',{staticClass:\"adaptive-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(_vm._s(_vm.$t('lg.nodata')))])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"orgIpPieContainer\"}})])])],1),_vm._v(\" \"),_c('el-row',{staticClass:\"chartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":16}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.domainLineLoading),expression:\"domainLineLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.domainLineNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"domainLineContainer\"}})],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":8}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.domainPieLoading),expression:\"domainPieLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.domainPieNodata)?_c('div',{staticClass:\"adaptive-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(_vm._s(_vm.$t('lg.nodata')))])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"domainPieContainer\"}})])])],1),_vm._v(\" \"),_c('el-row',{staticClass:\"chartRow lastChartRow\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":14}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.regionBarLoading),expression:\"regionBarLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.regionBarNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"regionBarContainer\"}})],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":10}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.attackTypeLoading),expression:\"attackTypeLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.attackTypeNodata)?_c('div',{staticClass:\"adaptive-circle\"},[_c('div',{staticClass:\"layout middle\"},[_c('div',[_c('p',[_vm._v(_vm._s(_vm.$t('lg.nodata')))])])])]):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"attackTypeContainer\"}})])])],1),_vm._v(\" \"),(_vm.forFastShow)?_c('el-row',{staticClass:\"chartRow chartRowBusi\",attrs:{\"gutter\":20}},[_c('el-col',{staticStyle:{\"padding-left\":\"0px\"},attrs:{\"span\":20}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.businessLineLoading),expression:\"businessLineLoading\"}],staticClass:\"chart-content\",attrs:{\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[(_vm.businessNodata)?_c('pienodata',{attrs:{\"mystyle\":\"linenodata\"}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"businessContainer\"}})],1)]),_vm._v(\" \"),_c('el-col',{staticClass:\"busiNumBox\",attrs:{\"span\":4}},[_c('ul',{staticClass:\"totalList\"},[_c('li',{staticClass:\"listTitle\"},[_vm._v(_vm._s(_vm.$t('lg.totalrequests'))+\"：\")]),_vm._v(\" \"),_c('li',[_c('i',{staticClass:\"liLable\"},[_vm._v(\"MAX:\")]),_vm._v(\" \"),_c('p',{staticClass:\"liValue\"},[_vm._v(_vm._s(_vm.wholeCtMax))])]),_vm._v(\" \"),_c('li',[_c('i',{staticClass:\"liLable\"},[_vm._v(\"MIN:\")]),_vm._v(\" \"),_c('p',{staticClass:\"liValue\"},[_vm._v(_vm._s(_vm.wholeCtMin))])])]),_vm._v(\" \"),_c('ul',{staticClass:\"someList\"},[_c('li',{staticClass:\"listTitle\"},[_vm._v(_vm._s(_vm.$t('lg.gongji'))+\"：\")]),_vm._v(\" \"),_c('li',[_c('i',{staticClass:\"liLable\"},[_vm._v(\"MAX:\")]),_vm._v(\" \"),_c('p',{staticClass:\"liValue\"},[_vm._v(_vm._s(_vm.normalCtMax))])]),_vm._v(\" \"),_c('li',[_c('i',{staticClass:\"liLable\"},[_vm._v(\"MIN:\")]),_vm._v(\" \"),_c('p',{staticClass:\"liValue\"},[_vm._v(_vm._s(_vm.normalCtMin))])])])])],1):_vm._e()],1),_vm._v(\" \"),(!_vm.forFastShow)?_c('p',{staticClass:\"fastloadmore\",on:{\"click\":_vm.forfastloadmore}},[_vm._v(\"点击查看更多图表\")]):_vm._e(),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":_vm.logDialogTitle,\"visible\":_vm.logDialogVisible,\"width\":\"80%\",\"before-close\":_vm.logDialogClose},on:{\"update:visible\":function($event){_vm.logDialogVisible=$event}}},[_c('log-rebuild',{attrs:{\"tableKeyArr\":_vm.tableKeyArrWaf,\"dynamicTag\":_vm.chartLogsHeadData},on:{\"refilterColBy\":_vm.refilterColByWaf,\"requeryRowBy\":_vm.requeryRowByWaf}}),_vm._v(\" \"),(_vm.chartLogsTotalNum==0)?_c('div',{staticClass:\"nodata-box\"},[_vm._v(_vm._s(_vm.$t('lg.nodata')))]):_vm._e(),_vm._v(\" \"),(_vm.chartLogsTotalNum>0)?_c('div',{staticClass:\"logTableHeight\"},[_c('log-tables',{ref:\"log_tables\",attrs:{\"tabheadData\":_vm.chartLogsHeadData,\"tabodyData\":_vm.chartLogsBodyData,\"totalNum\":_vm.chartLogsTotalNum,\"isLogLoding\":false},on:{\"getChangeLogData\":_vm.getChangeLogData}})],1):_vm._e()],1),_vm._v(\" \"),_c('ul',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowGridMenu),expression:\"isShowGridMenu\"}],staticClass:\"operationBtnUl\"},[_c('li',[_c('img',{attrs:{\"src\":\"static/icon/fullScreen.png\",\"alt\":\"大屏展示\",\"title\":\"大屏展示\"},on:{\"click\":_vm.fullScreen}})]),_vm._v(\" \"),_c('li',[_c('img',{attrs:{\"src\":\"static/icon/downpdfChart.png\",\"alt\":\"导出pdf\",\"title\":\"导出pdf\"},on:{\"click\":_vm.downLoadPdf}})]),_vm._v(\" \"),_c('li',[_c('img',{attrs:{\"src\":\"static/icon/map.png\",\"alt\":\"返回地图\",\"title\":\"返回地图\"},on:{\"click\":_vm.goBackMap}})])])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-af8533fe\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/home/attackChart.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-af8533fe\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./attackChart.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./attackChart.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./attackChart.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-af8533fe\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./attackChart.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/home/attackChart.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}