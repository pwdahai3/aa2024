{"version":3,"sources":["webpack:///src/components/behavior/customQuery.vue","webpack:///./src/components/behavior/customQuery.vue?94ed","webpack:///./src/components/behavior/customQuery.vue","webpack:///src/components/behavior/logagg.vue","webpack:///./src/components/behavior/logagg.vue?9371","webpack:///./src/components/behavior/logagg.vue"],"names":["customQuery","myQuery","logRebuild","logTables","logagg","timingTaskPop","tableKeyArrCustom","cstQryLogsHeadData","cstQryLogsBodyData","type","tableRes","cstQryTotalNum","isaggs","piedata","linechartdata","queryjson","queryform","params","requeryObj","constvar","obj","behavior_customQuery","render","_vm","this","_h","$createElement","_c","_self","staticClass","on","click","hideSDURLMenu","_v","_s","$t","ref","attrs","isCustomQuery","clearQueryData","getMultiQueryResult","restoreQinterval","getTimeTaskResult","queryLoadingStart","queryLoadingStop","logtype","tableKeyArr","dynamicTag","refilterColBy","refilterColByCustom","requeryRowBy","requeryRowByCustom","_e","cstQryDataRes","length","logType","tabheadData","tabodyData","totalNum","isLogLoding","queryLoading","showSDURLMenu","getChangeLogData","customQueryMultiQuery","data","getChangeLogInterval","isShow","isQueryPopShow","myTaskType","myTaskTypeTxt","querydata","qJsondata","qJson","setTimingTaskClose","$event","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","echarts","Array","Object","seriesdata","resize","qinterval","legend","xData","seriesData","behavior_logagg","placeholder","change","intervalChange","model","value","callback","$$v","expression","_l","item","index","key","label","name","staticStyle","margin-right","_m","doc_count","width","height","id","margin-top"],"mappings":"8PA8BAA,qBAEA,eAEAC,UAAA,EACAC,aAAA,EACAC,YAAA,EACAC,SAAA,EAEAC,gBAAA,kHAGA,0CAKA,UACA,4GAQA,UACA,8CAKA,uFAQAC,4CACAC,6CACAC,kCACAC,+FAIA,kDAGA,kDAGAA,0BACAC,kCACAJ,4CACAC,6CACAC,yCACAG,6BACAC,sBACAC,6BACAC,iCACA,mIAOAC,2BACAC,+BACA,mEAGAC,kEAGAC,4DACA,sHAIA,8BACA,OACAC,EAAA,0KAOAC,sCACA,GACAD,EAAA,gLAQAC,2FAMA,0DAGA,0FAIA,OC7IAC,GADiBC,OAFjB,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,sBAAAC,IAAsCC,MAAAR,EAAAS,iBAA2BL,EAAA,MAAWE,YAAA,eAAyBN,EAAAU,GAAAV,EAAAW,GAAAX,EAAAY,GAAA,mBAAAZ,EAAAU,GAAA,KAAAN,EAAA,YAAqES,IAAA,UAAAC,OAAqBC,eAAA,GAAqBR,IAAKS,eAAAhB,EAAAgB,eAAAC,oBAAAjB,EAAAiB,oBAAAC,iBAAAlB,EAAAkB,iBAAAC,kBAAAnB,EAAAmB,kBAAAC,kBAAApB,EAAAoB,kBAAAC,iBAAArB,EAAAqB,oBAAuPrB,EAAAU,GAAA,MAAAT,KAAAZ,QAAA,WAAAY,KAAAqB,UAAArB,KAAAZ,QAAA,cAAAY,KAAAqB,QAAAlB,EAAA,eAA6HU,OAAOS,YAAAvB,EAAAjB,kBAAAyC,WAAAxB,EAAAhB,oBAAwEuB,IAAKkB,cAAAzB,EAAA0B,oBAAAC,aAAA3B,EAAA4B,sBAA+E5B,EAAA6B,KAAA7B,EAAAU,GAAA,KAAAV,EAAA,aAAAI,EAAA,OAAoDE,YAAA,eAAyBF,EAAA,KAAUE,YAAA,oBAA8BN,EAAAU,GAAA,IAAAV,EAAAW,GAAAX,EAAAY,GAAA,kBAAAZ,EAAA6B,KAAA7B,EAAAU,GAAA,QAAAV,EAAA8B,cAAAC,OAAA3B,EAAA,OAA0GE,YAAA,eAAyBN,EAAAU,GAAAV,EAAAW,GAAAX,EAAAY,GAAA,iBAAAZ,EAAA6B,KAAA7B,EAAAU,GAAA,KAAAV,EAAA8B,cAAAC,OAAA,EAAA3B,EAAA,OAAoGE,YAAA,mBAA6BN,EAAAX,OAA0SW,EAAA6B,KAA1SzB,EAAA,cAAiCS,IAAA,aAAAC,OAAwBkB,QAAAhC,EAAAsB,QAAAW,YAAAjC,EAAAhB,mBAAAkD,WAAAlC,EAAAf,mBAAAkD,SAAAnC,EAAAZ,eAAAgD,YAAApC,EAAAqC,aAAAC,cAAAtC,EAAAsC,eAA8L/B,IAAKgC,iBAAAvC,EAAAwC,yBAA8CxC,EAAAU,GAAA,KAAAV,EAAA,OAAAI,EAAA,UAAiDS,IAAA,UAAAC,OAAqB2B,KAAAzC,EAAA8B,cAAAxC,QAAAU,EAAAV,QAAAC,cAAAS,EAAAT,eAAiFgB,IAAKmC,qBAAA1C,EAAAwC,yBAAkDxC,EAAA6B,MAAA,GAAA7B,EAAA6B,KAAA7B,EAAAU,GAAA,KAAAN,EAAA,mBAA0DU,OAAO6B,OAAA3C,EAAA4C,eAAAC,WAAA,WAAAC,cAAA9C,EAAAY,GAAA,qBAAAmC,UAAA/C,EAAAP,UAAAuD,UAAAhD,EAAAiD,OAAgJ1C,IAAK2C,mBAAA,SAAAC,GAAsCnD,EAAA4C,gBAAA,OAA2B,IAEj9DQ,oBCCjB,IAcAC,EAdAC,EAAA,OAcAC,CACA9E,EACAqB,GATA,EAVA,SAAA0D,GACAF,EAAA,SAaA,kBAEA,MAUAG,EAAA,QAAAJ,EAAA,gECcA,IAAAK,EAAAJ,EAAA,QACAA,EAAA,QACAA,EAAA,QACAA,EAAA,QACAA,EAAA,QACAA,EAAA,QACA,IAAAzE,qBAKA8E,qBAGAC,4BAIAA,sDAGA,CACA3D,+CACAwC,MADAxC,yFAEA4D,iEAIAC,wBACAA,oCAIA7D,6DAEAwC,mFACAoB,oEAGAC,qBACAA,qDAOA,UACA,cAEA,WACA,eAEA,UACA,cAEA,UACA,cAEA,UACA,aAEA,UACA,aAEA,UAGA,kBACA,cACA,eAEA,iFAIAC,gFAGA,qCAGA,iBAEA,2CAEA,aACA,YAGAC,iBAGA,UACA,oBACA,qBACA,0BACA,uBAGA,WAEA,0BAEA,sBAEA,gBAIA,mCAKA,SAOAvB,gCAEA,4EAGA,+CAOA,qBAIAuB,cAEA,WACA,YACA,mBAEA,eAEA,gBAIAC,eAGA,gBAUAC,+BACA,kFCzMAC,GADiBpE,OAFjB,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAF,EAAAyC,KAAAV,OAAA,EAAA3B,EAAA,OAAAA,EAAA,OAAAA,EAAA,QAAAJ,EAAAU,GAAAV,EAAAW,GAAAX,EAAAY,GAAA,wBAAAZ,EAAAU,GAAA,KAAAN,EAAA,aAAmIU,OAAOsD,YAAApE,EAAAY,GAAA,iBAAqCL,IAAK8D,OAAArE,EAAAsE,gBAA4BC,OAAQC,MAAAxE,EAAA,UAAAyE,SAAA,SAAAC,GAA+C1E,EAAA+D,UAAAW,GAAkBC,WAAA,cAAyB3E,EAAA4E,GAAA5E,EAAA,mBAAA6E,EAAAC,GAA6C,OAAA1E,EAAA,aAAuB2E,IAAAD,EAAAhE,OAAiBkE,MAAAH,EAAAI,KAAAT,MAAAK,EAAAL,aAAwC,GAAAxE,EAAAU,GAAA,KAAAN,EAAA,OAA6BE,YAAA,0BAAoCF,EAAA,OAAYE,YAAA,gBAAA4E,aAAyCC,eAAA,UAAuB/E,EAAA,SAAAJ,EAAAoF,GAAA,GAAApF,EAAAU,GAAA,KAAAN,EAAA,QAAAJ,EAAA4E,GAAA5E,EAAA,cAAA6E,GAAgF,OAAAzE,EAAA,MAAAA,EAAA,MAAAJ,EAAAU,GAAAV,EAAAW,GAAAkE,EAAAE,QAAA/E,EAAAU,GAAA,KAAAN,EAAA,MAAAJ,EAAAU,GAAAV,EAAAW,GAAAkE,EAAAQ,uBAA4GrF,EAAAU,GAAA,KAAAV,EAAAoF,GAAA,KAAApF,EAAAU,GAAA,KAAAV,EAAAoF,GAAA,KAAApF,EAAA6B,MAEh0BuB,iBADjB,WAAoC,IAAalD,EAAbD,KAAaE,eAA0BC,EAAvCH,KAAuCI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,SAAAA,EAAA,MAAAA,EAAA,MAAqCU,OAAOwE,MAAA,SAA3GrF,KAA0HS,GAAA,SAA1HT,KAA0HS,GAAA,KAAAN,EAAA,MAA1HH,KAA0HS,GAAA,oBAAiE,WAAc,IAAaR,EAAbD,KAAaE,eAA0BC,EAAvCH,KAAuCI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,kBAA4BF,EAAA,OAAY8E,aAAaK,OAAA,QAAAD,MAAA,QAAgCxE,OAAQ0E,GAAA,iBAAqB,WAAc,IAAatF,EAAbD,KAAaE,eAA0BC,EAAvCH,KAAuCI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiB8E,aAAaO,aAAA,UAAqBrF,EAAA,OAAY8E,aAAaK,OAAA,QAAAD,MAAA,QAAgCxE,OAAQ0E,GAAA,oBCEhnB,IAcAnC,EAdAC,EAAA,OAcAC,CACA1E,EACAsF,GATA,EAVA,SAAAX,GACAF,EAAA,SAaA,KAEA,MAUAG,EAAA,EAAAJ,EAAA","file":"static/js/9.97a9acc5f6223520f84e.js","sourcesContent":["<template>\r\n  <div class=\"customQuery-wrapper\" @click=\"hideSDURLMenu\">\r\n    <h2 class=\"breadcrumb\">{{$t('lg.zidingyi')}}</h2>\r\n   \r\n    <!-- 自定义查询字段 -->\r\n    <my-query ref=\"myQuery\" @clearQueryData='clearQueryData' :isCustomQuery='true' @getMultiQueryResult=\"getMultiQueryResult\" @restoreQinterval=\"restoreQinterval\" @getTimeTaskResult=\"getTimeTaskResult\" @queryLoadingStart=\"queryLoadingStart\" @queryLoadingStop=\"queryLoadingStop\"></my-query>\r\n\r\n    <!-- 查询结果数据展示 -->\r\n    <log-rebuild v-if=\"(!this.isaggs && this.logtype=='waf.log') || (!this.isaggs && this.logtype=='access.log') \" :tableKeyArr='tableKeyArrCustom' :dynamicTag='cstQryLogsHeadData' @refilterColBy='refilterColByCustom' @requeryRowBy='requeryRowByCustom'></log-rebuild><!-- 查询结果非聚合时 -->\r\n    <div v-if=\"queryLoading\" class=\"nodata-box\"><i class=\"el-icon-loading\"></i> {{$t('lg.loading2')}}</div>\r\n    <div v-if=\"cstQryDataRes.length==0\" class=\"nodata-box\">{{$t('lg.nodata')}}</div>\r\n    <div v-if=\"cstQryDataRes.length>0\" class=\"logTableHeight\">\r\n      <log-tables ref=\"log_tables\" v-if=\"!isaggs\" :logType=\"logtype\" :tabheadData=\"cstQryLogsHeadData\" :tabodyData=\"cstQryLogsBodyData\" :totalNum=\"cstQryTotalNum\" @getChangeLogData=\"customQueryMultiQuery\" :isLogLoding=\"queryLoading\" :showSDURLMenu='showSDURLMenu'></log-tables>\r\n      <logagg ref=\"log_agg\" v-if=\"isaggs\" :data=\"cstQryDataRes\" :piedata=\"piedata\" :linechartdata=\"linechartdata\" @getChangeLogInterval=\"customQueryMultiQuery\"></logagg>\r\n    </div>\r\n\r\n    <!-- 报警任务 -->\r\n    <timing-task-pop :isShow=\"isQueryPopShow\" :myTaskType=\"'esSearch'\" :myTaskTypeTxt=\"$t('lg.customesqbased')\" :querydata=\"queryform\" :qJsondata=\"qJson\" @setTimingTaskClose=\"isQueryPopShow=false\"></timing-task-pop>\r\n    \r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from 'axios';\r\nimport {SERVER_API_URL} from '@/conf/constvar';\r\nimport myQuery from '@/components/behavior/myQuery';\r\nimport timingTaskPop from '@/components/alarmTask/timingTaskPop';\r\nimport {logskeys} from '@/assets/js/logskeys';\r\nimport logRebuild from \"@/components/logs/logRebuild\";\r\nimport logTables from '@/components/logs/logTables';\r\nimport logagg from '@/components/behavior/logagg';\r\nimport Emitter from 'element-ui/src/mixins/emitter';\r\nexport default {\r\n  mixins: [Emitter],\r\n  components:{\r\n    myQuery,\r\n    logRebuild,\r\n    logTables,\r\n    logagg,\r\n    timingTaskPop\r\n  },\r\n  watch:{\r\n    '$store.state.mydatedata.timestampnow':function(){\r\n      this.$refs['myQuery'].multiQuery({curPage:1,pageNum:10},true);\r\n    }\r\n  },\r\n  data(){\r\n    return{\r\n      queryLoading:false,\r\n      logtype:'',\r\n      data:{},\r\n      cstQryDataRes:[],\r\n      \r\n      tableKeyArrCustom:[],//waf.log总共（默认）显示的字段\r\n      cstQryLogsHeadData:[],\r\n      cstQryLogsBodyData:[],\r\n      cstQryTotalNum:0,\r\n\r\n      isaggs:false,\r\n      piedata:{},\r\n      linechartdata:{},\r\n\r\n      //定时任务\r\n      isQueryPopShow:false,\r\n      qJson:{},\r\n      queryform:{},\r\n\r\n    }\r\n  },\r\n  methods:{\r\n    clearQueryData(data){\r\n      this.tableKeyArrCustom=data.tableKeyArrCustom;\r\n      this.cstQryLogsHeadData=data.cstQryLogsHeadData;\r\n      this.cstQryLogsBodyData=data.cstQryLogsBodyData;\r\n      this.logtype=data.type;\r\n      this.broadcast('logRequery',\"clearData\");//清空孙组件里logRequry的查询条件输入框里的内容，要引入Emitter\r\n    },\r\n    queryLoadingStart(){\r\n      this.queryLoading=true;\r\n    },\r\n    queryLoadingStop(){\r\n      this.queryLoading=false;\r\n    },\r\n    getMultiQueryResult(data){\r\n      this.logtype=data.type;\r\n      this.cstQryDataRes=data.tableRes;\r\n      this.tableKeyArrCustom=data.tableKeyArrCustom;\r\n      this.cstQryLogsHeadData=data.cstQryLogsHeadData;\r\n      this.cstQryLogsBodyData=data.cstQryLogsBodyData;\r\n      this.cstQryTotalNum=data.cstQryTotalNum;\r\n      this.isaggs=data.isaggs;\r\n      this.piedata=data.piedata;\r\n      this.linechartdata=data.linechartdata;\r\n      this.queryLoading=false;\r\n    },\r\n    restoreQinterval(){\r\n      if(this.$refs['log_agg']) this.$refs['log_agg'].qinterval='5m';//改变采样频率后，若换个聚合条件再次查询 则得把子组件logagg 的采样频率显示重新归为 5分钟（只能当其兄弟组件（或当前组件的watch）调用multiQuery方法时才调用这个）\r\n    },\r\n    getTimeTaskResult(data){\r\n      // console.log(data)\r\n      this.qJson=data.queryjson\r\n      this.queryform=data.queryform\r\n      this.isQueryPopShow=true;\r\n    },\r\n    customQueryMultiQuery(params){//改变采样频率，则再次触发查询\r\n      this.$refs['myQuery'].multiQuery(params);\r\n    },\r\n    requeryRowByCustom(obj){ //用户通过requery孙组件筛选waf.log或access.log显示的行\r\n      this.$refs['myQuery'].filterObj=obj.requeryObj;\r\n      this.$refs['myQuery'].multiQuery({curPage:0,pageNum:10});\r\n      if(this.$refs.log_tables) this.$refs.log_tables.tabCurPage=1;//当再次用户点击子组件logRequery的查询后，查询结果的页码要回到第一页\r\n    },\r\n    refilterColByCustom(obj){ //用户通过refilter孙组件筛选waf.log或access.log显示的列，删除或者增加字段显示的时候变化头部，发送用户增删请求\r\n     if(!obj.length) return false\r\n     if(this.logtype ==='waf.log'){\r\n         var url = SERVER_API_URL + `/pe/shadow/kv`;\r\n          axios.post(url,{customQueryWaf:obj}).then(res=>{\r\n          if(Object.keys(res.data.data.Failure)){\r\n            axios.patch(url,{customQueryWaf:obj}).then(res=>{\r\n            })\r\n          }\r\n        })\r\n        this.cstQryLogsHeadData = obj;\r\n      }else if(this.logtype ==='access.log'){\r\n         var url = SERVER_API_URL + `/pe/shadow/kv`;\r\n        axios.post(url,{customQueryAccess:obj}).then(res=>{\r\n        if(Object.keys(res.data.data.Failure)){\r\n          axios.patch(url,{customQueryAccess:obj}).then(res=>{\r\n\r\n          })\r\n        }\r\n      })\r\n      this.cstQryLogsHeadData = obj;\r\n      }\r\n     \r\n    },\r\n    showSDURLMenu(index){\r\n      this.cstQryLogsBodyData.forEach(items=>{\r\n        items.showUMenuList=false;\r\n      })\r\n      // this.cstQryLogsBodyData[index].showUMenuList=true;\r\n      this.$set(this.cstQryLogsBodyData[index],'showUMenuList',true)\r\n    },\r\n    hideSDURLMenu(){\r\n      this.cstQryLogsBodyData.forEach(items=>{\r\n        items.showUMenuList=false;\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.customQuery-wrapper{\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  padding: 15px;\r\n  box-sizing: border-box;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/behavior/customQuery.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"customQuery-wrapper\",on:{\"click\":_vm.hideSDURLMenu}},[_c('h2',{staticClass:\"breadcrumb\"},[_vm._v(_vm._s(_vm.$t('lg.zidingyi')))]),_vm._v(\" \"),_c('my-query',{ref:\"myQuery\",attrs:{\"isCustomQuery\":true},on:{\"clearQueryData\":_vm.clearQueryData,\"getMultiQueryResult\":_vm.getMultiQueryResult,\"restoreQinterval\":_vm.restoreQinterval,\"getTimeTaskResult\":_vm.getTimeTaskResult,\"queryLoadingStart\":_vm.queryLoadingStart,\"queryLoadingStop\":_vm.queryLoadingStop}}),_vm._v(\" \"),((!this.isaggs && this.logtype=='waf.log') || (!this.isaggs && this.logtype=='access.log') )?_c('log-rebuild',{attrs:{\"tableKeyArr\":_vm.tableKeyArrCustom,\"dynamicTag\":_vm.cstQryLogsHeadData},on:{\"refilterColBy\":_vm.refilterColByCustom,\"requeryRowBy\":_vm.requeryRowByCustom}}):_vm._e(),_vm._v(\" \"),(_vm.queryLoading)?_c('div',{staticClass:\"nodata-box\"},[_c('i',{staticClass:\"el-icon-loading\"}),_vm._v(\" \"+_vm._s(_vm.$t('lg.loading2')))]):_vm._e(),_vm._v(\" \"),(_vm.cstQryDataRes.length==0)?_c('div',{staticClass:\"nodata-box\"},[_vm._v(_vm._s(_vm.$t('lg.nodata')))]):_vm._e(),_vm._v(\" \"),(_vm.cstQryDataRes.length>0)?_c('div',{staticClass:\"logTableHeight\"},[(!_vm.isaggs)?_c('log-tables',{ref:\"log_tables\",attrs:{\"logType\":_vm.logtype,\"tabheadData\":_vm.cstQryLogsHeadData,\"tabodyData\":_vm.cstQryLogsBodyData,\"totalNum\":_vm.cstQryTotalNum,\"isLogLoding\":_vm.queryLoading,\"showSDURLMenu\":_vm.showSDURLMenu},on:{\"getChangeLogData\":_vm.customQueryMultiQuery}}):_vm._e(),_vm._v(\" \"),(_vm.isaggs)?_c('logagg',{ref:\"log_agg\",attrs:{\"data\":_vm.cstQryDataRes,\"piedata\":_vm.piedata,\"linechartdata\":_vm.linechartdata},on:{\"getChangeLogInterval\":_vm.customQueryMultiQuery}}):_vm._e()],1):_vm._e(),_vm._v(\" \"),_c('timing-task-pop',{attrs:{\"isShow\":_vm.isQueryPopShow,\"myTaskType\":'esSearch',\"myTaskTypeTxt\":_vm.$t('lg.customesqbased'),\"querydata\":_vm.queryform,\"qJsondata\":_vm.qJson},on:{\"setTimingTaskClose\":function($event){_vm.isQueryPopShow=false}}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-ca59a6bc\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/behavior/customQuery.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-ca59a6bc\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./customQuery.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./customQuery.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./customQuery.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-ca59a6bc\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./customQuery.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-ca59a6bc\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/behavior/customQuery.vue\n// module id = null\n// module chunks = ","<template>\r\n  <div v-if=\"data.length>0\">\r\n    <div>\r\n      <span>{{$t('lg.frequency')}}：</span>\r\n      <el-select v-model=\"qinterval\" :placeholder=\"$t('lg.frequency')\" @change=\"intervalChange\">\r\n        <el-option\r\n          v-for=\"(item,index) in intervals\"\r\n          :key=\"index\"\r\n          :label=\"item.name\"\r\n          :value=\"item.value\">\r\n        </el-option>\r\n      </el-select>\r\n    </div>\r\n    <div class=\"search-result-wrapper\">\r\n      <div class=\"search-result\" style=\"margin-right:20px;\">\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th width=\"80%\">key</th>\r\n              <th>doc_count</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"item in data\">\r\n              <td>{{item.key}}</td>\r\n              <td>{{item.doc_count}}</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n      <div class=\"search-result\">\r\n        <div id=\"piechart\" style=\"height:260px;width: 100%\"></div>\r\n      </div>\r\n    </div>\r\n    <div style=\"margin-top:20px;\">\r\n      <div id=\"linechart\" style=\"height:320px;width: 100%\"></div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n\r\nlet echarts = require('echarts/lib/echarts');\r\nrequire('echarts/lib/chart/pie')\r\nrequire('echarts/lib/chart/line')\r\nrequire('echarts/lib/component/tooltip') // 提示框\r\nrequire('echarts/lib/component/title')\r\nrequire('echarts/lib/component/legend') // 图例\r\nexport default {\r\n  props:{\r\n    data:{\r\n      type:Array\r\n    },\r\n    piedata:{\r\n      type:Object\r\n    },\r\n    linechartdata:{\r\n      type:Object\r\n    }\r\n  },\r\n  watch: {\r\n    'data':function(){\r\n      if(this.data.length>0){\r\n        let _this=this;\r\n        _this.piechart(_this.piedata.legend,_this.piedata.data);\r\n        _this.linechart(_this.linechartdata.legend,_this.linechartdata.xaxisdata,_this.linechartdata.seriesdata);\r\n      }\r\n    },\r\n    '$store.state.isMenuShow':function(){\r\n      this.pieChart.resize();\r\n      this.lineChart.resize();\r\n    }\r\n  },\r\n  mounted() {\r\n    let _this=this;\r\n    if(_this.data.length>0){\r\n      _this.piechart(_this.piedata.legend,_this.piedata.data);\r\n      _this.linechart(_this.linechartdata.legend,_this.linechartdata.xaxisdata,_this.linechartdata.seriesdata);\r\n    }\r\n    window.addEventListener(\"resize\", () => {\r\n      _this.pieChart.resize();\r\n      _this.lineChart.resize();\r\n    });\r\n  },\r\n  data(){\r\n    return{\r\n      intervals:[\r\n        {\r\n          value:\"5m\",\r\n          name:\"5分钟\"\r\n        },{\r\n          value:\"30m\",\r\n          name:\"30分钟\"\r\n        },{\r\n          value:\"1h\",\r\n          name:\"1小时\"\r\n        },{\r\n          value:\"5h\",\r\n          name:\"5小时\"\r\n        },{\r\n          value:\"1d\",\r\n          name:\"1天\"\r\n        },{\r\n          value:\"7d\",\r\n          name:\"7天\"\r\n        },{\r\n          value:\"1M\",\r\n          name:\"1个月\"\r\n        }\r\n      ],\r\n      qinterval:'5m',\r\n      pieChart:null,\r\n      lineChart:null\r\n    }\r\n  },\r\n  methods: {\r\n    intervalChange(){//改变采样频率，则再次触发查询\r\n      this.$emit(\"getChangeLogInterval\",this.qinterval)\r\n    },\r\n    piechart(legend,data){\r\n      this.pieChart=echarts.init(document.getElementById('piechart'));\r\n      let options = {\r\n            tooltip: {\r\n              trigger: 'item',\r\n              formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n            },\r\n            legend: {\r\n              orient: 'vertical',\r\n              x: 'left',\r\n              //data:['直接访问','邮件营销','联盟广告','视频广告','搜索引擎']\r\n              data:legend\r\n            },\r\n            series: [\r\n              {\r\n                name:'占比',\r\n                type:'pie',\r\n                radius: ['45%', '60%'],\r\n                center: ['70%', '35%'],\r\n                avoidLabelOverlap: false,\r\n                label: {\r\n                normal: {\r\n                  show: false,\r\n                  position: 'center'\r\n                },\r\n                emphasis: {\r\n                  show: false,\r\n                  textStyle: {\r\n                    fontSize: '30',\r\n                    fontWeight: 'bold'\r\n                  }\r\n                }\r\n              },\r\n              labelLine: {\r\n                normal: {\r\n                  show: false\r\n                }\r\n              },\r\n              // data:[\r\n              //     {value:335, name:'直接访问'},\r\n              // ]\r\n              data:data\r\n            }\r\n          ]\r\n        };\r\n      //console.log(options)\r\n      this.pieChart.setOption(options,true);\r\n    },\r\n    linechart(legend,xData,seriesData){\r\n      this.lineChart=echarts.init(document.getElementById('linechart'));\r\n      var options = {\r\n            title: {\r\n              // text: '折线图堆叠'\r\n            },\r\n            tooltip: {\r\n              trigger: 'axis'\r\n            },\r\n            legend: {\r\n              //data:['邮件营销','联盟广告','视频广告','直接访问','搜索引擎']\r\n              data:legend\r\n            },\r\n            grid: {\r\n              left: '3%',\r\n              right: '4%',\r\n              bottom: '3%',\r\n              containLabel: true\r\n            },\r\n            xAxis: {\r\n              type: 'category',\r\n              // boundaryGap: false,\r\n              // data: ['周一','周二','周三','周四','周五','周六','周日']\r\n              data:xData\r\n            },\r\n            yAxis: {\r\n              type: 'value'\r\n            },\r\n            // series: [\r\n            //     {\r\n            //         name:'邮件营销',\r\n            //         type:'line',\r\n            //         stack: '总量',\r\n            //         data:[120, 132, 101, 134, 90, 230, 210]\r\n            //     },\r\n            // ]\r\n            series:seriesData\r\n        };\r\n      this.lineChart.setOption(options,true);\r\n    }\r\n  },\r\n  beforeDestroy(){\r\n    window.removeEventListener('resize',function(){});\r\n  }\r\n}\r\n</script>\r\n<style>\r\n.icon-row{line-height: 40px}\r\n.icon-row i{cursor: pointer; margin-right: 8px;}\r\n.search-result-wrapper{display: flex;margin-top: 20px;}\r\n.search-result{flex:1;}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/behavior/logagg.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.data.length>0)?_c('div',[_c('div',[_c('span',[_vm._v(_vm._s(_vm.$t('lg.frequency'))+\"：\")]),_vm._v(\" \"),_c('el-select',{attrs:{\"placeholder\":_vm.$t('lg.frequency')},on:{\"change\":_vm.intervalChange},model:{value:(_vm.qinterval),callback:function ($$v) {_vm.qinterval=$$v},expression:\"qinterval\"}},_vm._l((_vm.intervals),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.name,\"value\":item.value}})}))],1),_vm._v(\" \"),_c('div',{staticClass:\"search-result-wrapper\"},[_c('div',{staticClass:\"search-result\",staticStyle:{\"margin-right\":\"20px\"}},[_c('table',[_vm._m(0),_vm._v(\" \"),_c('tbody',_vm._l((_vm.data),function(item){return _c('tr',[_c('td',[_vm._v(_vm._s(item.key))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(item.doc_count))])])}))])]),_vm._v(\" \"),_vm._m(1)]),_vm._v(\" \"),_vm._m(2)]):_vm._e()}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('thead',[_c('tr',[_c('th',{attrs:{\"width\":\"80%\"}},[_vm._v(\"key\")]),_vm._v(\" \"),_c('th',[_vm._v(\"doc_count\")])])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"search-result\"},[_c('div',{staticStyle:{\"height\":\"260px\",\"width\":\"100%\"},attrs:{\"id\":\"piechart\"}})])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"margin-top\":\"20px\"}},[_c('div',{staticStyle:{\"height\":\"320px\",\"width\":\"100%\"},attrs:{\"id\":\"linechart\"}})])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4c495363\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/behavior/logagg.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4c495363\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./logagg.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./logagg.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./logagg.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4c495363\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./logagg.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/behavior/logagg.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}